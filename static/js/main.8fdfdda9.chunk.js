(this.webpackJsonpworkshop=this.webpackJsonpworkshop||[]).push([[1],[,,,,,,,,,function(e,t,n){"use strict";n.d(t,"j",(function(){return r.c})),n.d(t,"i",(function(){return r.b})),n.d(t,"h",(function(){return r.a})),n.d(t,"l",(function(){return r.e})),n.d(t,"k",(function(){return r.d})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"m",(function(){return w})),n.d(t,"a",(function(){return A})),n.d(t,"d",(function(){return y.a})),n.d(t,"b",(function(){return g})),n.d(t,"g",(function(){return I})),n.d(t,"c",(function(){return C}));var r=n(50),a={_:{required:"required",number:"not valid number",integer:"not valid integer",min:"min value is ${min}",max:"max value is ${max}"},zh:{_:{required:"\u5fc5\u987b\u586b",number:"\u9700\u8981\u6570\u5b57",integer:"\u9700\u8981\u6574\u6570",min:"\u4e0d\u80fd\u5c0f\u4e8e${min}",max:"\u4e0d\u80fd\u5927\u4e8e${max}"}}},i={_:{none:"[none]"},zh:{_:{none:"[\u65e0]"}}},s=n(20),c=n(3),u=n(4),o=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#";Object(c.a)(this,e),this.root=void 0,this._routes=[],this._useHash=void 0,this._hash=void 0,this._paused=void 0,this._destroyed=void 0,this._lastRouteResolved=void 0,this._notFoundHandler=void 0,this._defaultHandler=void 0,this._usePushState=void 0,this._genericHooks=void 0,this._historyUpdateMethod=void 0,this.timout=void 0,this._onLocationChange=function(){console.log("_onLocationChange"),t.resolve()},this.root=null,this._useHash=r,this._hash=a||"#",this._paused=!1,this._destroyed=!1,this._lastRouteResolved=null,this._notFoundHandler=null,this._defaultHandler=null,this._usePushState=!r&&e.isPushStateAvailable(),this._genericHooks=null,this._historyUpdateMethod="pushState",n?this.root=r?n.replace(/\/$/,"/"+this._hash):n.replace(/\/$/,""):r&&(this.root=this._cLoc().split(this._hash)[0].replace(/\/$/,"/"+this._hash)),this._listen(),this.updatePageLinks()}return Object(u.a)(e,[{key:"navigate",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e=e||"",this._usePushState)t=(t=(t=(n?"":this._getRoot()+"/")+e.replace(/^\/+/,"/")).replace(/([^:])(\/{2,})/g,"$1/")).replace("/#test/","/"),this._historyUpdate({},"",t),this.resolve();else if("undefined"!==typeof window){e=e.replace(new RegExp("^"+this._hash),"");var r=window,a=r.location;a.href=a.href.replace(/#$/,"").replace(new RegExp(this._hash+".*$"),"")+this._hash+e}return this}},{key:"on",value:function(){var t=this,n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1];switch(typeof n){case"function":this._defaultHandler={handler:n,hooks:r},this._notFoundHandler||(this._notFoundHandler=this._defaultHandler);break;case"object":var a=Object.keys(n).sort(e.compareUrlDepth);a.forEach((function(e){return t.on(e,n[e])}));break;default:if(arguments.length<2)break;if("/"===n){this._defaultHandler={handler:"object"===typeof r?r.uses:r,hooks:arguments.length<=2?void 0:arguments[2]};break}this._add(n,r,arguments.length<=2?void 0:arguments[2])}return this}},{key:"off",value:function(e){return null!==this._defaultHandler&&e===this._defaultHandler.handler?this._defaultHandler=null:null!==this._notFoundHandler&&e===this._notFoundHandler.handler&&(this._notFoundHandler=null),this._routes=this._routes.reduce((function(t,n){return n.handler!==e&&t.push(n),t}),[]),this}},{key:"notFound",value:function(e,t){return this._notFoundHandler={handler:e,hooks:t},this}},{key:"resolve",value:function(t){var n=this,r=t||this._cLoc(),a=this._getRoot(),i=r.replace(a,"");if(this._useHash){i=i.replace(new RegExp("^\\/"+this._hash),"/")}var c=e.extractGETParameters(t||this._cLoc()),u=e.getOnlyURL(i,this._useHash,this._hash);if(!1===u.startsWith("/")&&(u="/"+u),this._paused)return!1;if(this._lastRouteResolved&&u===this._lastRouteResolved.url&&c===this._lastRouteResolved.query)return this._lastRouteResolved.hooks&&this._lastRouteResolved.hooks.already&&this._lastRouteResolved.hooks.already(this._lastRouteResolved.params),!1;var o=e.match(u,this._routes),l=function(t){e.manageHooks((function(){e.manageHooks((function(){n._callLeave(),n._lastRouteResolved={url:u,query:c,hooks:t.hooks},t.handler(c)}),t.hooks)}),n._genericHooks)};if(!1===o)return this._defaultHandler&&(""===u||"/"===u||u===this._hash||e.isHashedRoot(u,this._useHash,this._hash))?(l(this._defaultHandler),!0):(this._notFoundHandler&&l(this._notFoundHandler),!1);var h=o;if(h){this._callLeave(),this._lastRouteResolved={url:u,query:c,hooks:h.route.hooks,params:h.params,name:h.route.name};var d=h.route.handler;return e.manageHooks((function(){e.manageHooks((function(){h.route.route instanceof RegExp?d.apply(void 0,Object(s.a)(h.match.slice(1,h.match.length))):d(h.params,c)}),h.route.hooks,h.params,n._genericHooks)}),this._genericHooks,h.params),h}}},{key:"destroy",value:function(){this._routes=[],this._destroyed=!0,this._lastRouteResolved=null,this._genericHooks=null,clearTimeout(this.timout),"undefined"!==typeof window&&(window.removeEventListener("popstate",this._onLocationChange),window.removeEventListener("hashchange",this._onLocationChange))}},{key:"updatePageLinks",value:function(){var e=this;"undefined"!==typeof document&&this._findLinks().forEach((function(t){t.hasListenerAttached||(t.addEventListener("click",(function(n){if((n.ctrlKey||n.metaKey)&&"a"===n.currentTarget.tagName.toLowerCase())return!1;var r=e.getLinkPath(t);e._destroyed||(n.preventDefault(),e.navigate(r.replace(/\/+$/,"").replace(/^\/+/,"/")))})),t.hasListenerAttached=!0)}))}},{key:"generate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this._routes.reduce((function(n,r){if(r.name===e)for(var a in n=r.route.toString(),t)n=n.replace(":"+a,t[a]);return n}),"");return this._useHash?this._hash+n:n}},{key:"link",value:function(e){return this._getRoot()+e}},{key:"pause",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._paused=e,this._historyUpdateMethod=e?"replaceState":"pushState"}},{key:"resume",value:function(){this.pause(!1)}},{key:"historyAPIUpdateMethod",value:function(e){return"undefined"===typeof e?this._historyUpdateMethod:(this._historyUpdateMethod=e,e)}},{key:"disableIfAPINotAvailable",value:function(){e.isPushStateAvailable()||this.destroy()}},{key:"lastRouteResolved",value:function(){return this._lastRouteResolved}},{key:"getLinkPath",value:function(e){return e.getAttribute("href")}},{key:"hooks",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){this._genericHooks=e}))},{key:"_add",value:function(e,t,n){return"string"===typeof e&&(e=encodeURI(e)),this._routes.push("object"===typeof t?{route:e,handler:t.uses,name:t.as,hooks:n||t.hooks}:{route:e,handler:t,name:void 0,hooks:n}),this._add}},{key:"_historyUpdate",value:function(e,t,n){switch(this._historyUpdateMethod){default:throw Error("unknow history method "+this._historyUpdateMethod);case"pushState":return void window.history.pushState(e,t,n);case"replaceState":return void window.history.replaceState(e,t,n)}}},{key:"_getRoot",value:function(){if(null===this.root){var t=this._cLoc().split("?")[0];this.root=e.root(t,this._routes)}return this.root.replace("#test","")}},{key:"_listen",value:function(){var t=this;if(this._usePushState)window.addEventListener("popstate",this._onLocationChange);else if(e.isHashChangeAPIAvailable())window.addEventListener("hashchange",this._onLocationChange);else{var n=this._cLoc();!function e(){var r=t._cLoc();n!==r&&(n=r,t.resolve()),t.timout&&clearTimeout(t.timout),t.timout=setTimeout(e,200)}()}}},{key:"_cLoc",value:function(){if("undefined"!==typeof window){var t=window.location.href;return e.cleanUrl(t)}return""}},{key:"_findLinks",value:function(){return[].slice.call(document.querySelectorAll("[data-navigo]"))}},{key:"_callLeave",value:function(){var e=this._lastRouteResolved;if(e){var t=e.params,n=e.hooks;n&&n.leave&&n.leave(t)}}}],[{key:"isPushStateAvailable",value:function(){return!("undefined"===typeof window||!window.history||!window.history.pushState)}},{key:"clean",value:function(t){return t instanceof RegExp?t:e.cleanUrl(t)}},{key:"cleanUrl",value:function(e){return e.replace(/\/+$/,"").replace(/^\/+/,"^/")}},{key:"regExpResultToParams",value:function(e,t){return 0===t.length?null:e?e.slice(1,e.length).reduce((function(e,n,r){return null===e&&(e={}),e[t[r]]=decodeURIComponent(n),e}),null):null}},{key:"replaceDynamicURLParts",value:function(t){var n=[];return{regexp:t instanceof RegExp?t:new RegExp(t.replace(e.PARAMETER_REGEXP,(function(t,r,a){return n.push(a),e.REPLACE_VARIABLE_REGEXP})).replace(e.WILDCARD_REGEXP,e.REPLACE_WILDCARD)+e.FOLLOWED_BY_SLASH_REGEXP,e.MATCH_REGEXP_FLAGS),paramNames:n}}},{key:"getUrlDepth",value:function(e){return e.replace(/\/$/,"").split("/").length}},{key:"compareUrlDepth",value:function(t,n){return e.getUrlDepth(n)-e.getUrlDepth(t)}},{key:"findMatchedRoutes",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return n.map((function(n){var r=e.replaceDynamicURLParts(e.clean(n.route)),a=r.regexp,i=r.paramNames,s=t.replace(/^\/+/,"/").match(a),c=e.regExpResultToParams(s,i);return!!s&&{match:s,route:n,params:c}})).filter((function(e){return e}))}},{key:"match",value:function(t,n){return e.findMatchedRoutes(t,n)[0]||!1}},{key:"root",value:function(t,n){var r=RegExp("\\/:\\D(\\w*)","g"),a=n.map((function(e){var n=e.route;if(""===n||"*"===n)return t;"string"===typeof n&&(n=n.replace(r,"\\/(\\w|%|[\u4e00-\u9fcc])+"));var a=n+"";return t.split(new RegExp(a))[0]})),i=e.cleanUrl(t),s=a.length;if(0===s)return i;var c=a[0];return 1===s?c:a.reduce((function(e,t){return e.length>t.length&&(e=t),e}),c)}},{key:"isHashChangeAPIAvailable",value:function(){return"undefined"!==typeof window&&"onhashchange"in window}},{key:"extractGETParameters",value:function(e){return e.split(/\?(.*)?$/).slice(1).join("")}},{key:"getOnlyURL",value:function(t,n,r){var a,i=function(e){return e.split(/\?(.*)?$/)[0]};return"undefined"===typeof r&&(r="#"),e.isPushStateAvailable()&&!n?i(t).split(r)[0]:(a=t.split(r)).length>1?i(a[1]):i(a[0])}},{key:"manageHooks",value:function(e,t,n,r){if(t&&"object"===typeof t){if(t.before)return void t.before((function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];r&&(e(),t.after&&t.after(n))}),n);if(t.after)return e(),void(t.after&&t.after(n))}e()}},{key:"isHashedRoot",value:function(t,n,r){if(e.isPushStateAvailable()&&!n)return!1;if(!t.match(r))return!1;var a=t.split(r);return a.length<2||""===a[1]}}]),e}();o.PARAMETER_REGEXP=/([:*])(\w+)/g,o.WILDCARD_REGEXP=/\*/g,o.REPLACE_VARIABLE_REGEXP="([^\\/]+)",o.REPLACE_WILDCARD="(?:.*)",o.FOLLOWED_BY_SLASH_REGEXP="(?:\\/$|$)",o.MATCH_REGEXP_FLAGS="";var l=n(10),h=n(14),d=n(17),f=n(16),v=n(5),p=n(6),b=n(2),m=n(1),j=n.n(m);n(32);var y=n(26),O=function(){function e(){Object(c.a)(this,e),this.user=y.a.localDb.child("user"),this.guest=y.a.localDb.child("guest"),this.unit=y.a.localDb.child("unit"),this._user=void 0,this._guest=void 0,this._unit=void 0}return Object(u.a)(e,[{key:"readToMemory",value:function(){this._user=this.user.get(),this._guest=this.guest.get(),this._unit=this.unit.get()}},{key:"saveToLocalStorage",value:function(){this.user.set(this._user),this.guest.set(this._guest),this.unit.set(this._unit)}},{key:"logoutClear",value:function(){[this.user,this.unit].forEach((function(e){return e.remove()}))}}]),e}();var k=26297280;function g(e,t){var n=y.a.timeZone,r=e/Math.pow(2,20)+60*(-n+(null!==t&&void 0!==t?t:n));return new Date(6e4*(r+k))}n(38);"a".charCodeAt(0),"z".charCodeAt(0);"A".charCodeAt(0),"Z".charCodeAt(0);var x,w,I=/^[0-9]*$/,C=/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/,N=[],_=function(){function e(){Object(c.a)(this,e),this.net=void 0,this.testing=void 0,this.testing=!1,this.net=this.createWeb()}return Object(u.a)(e,[{key:"init",value:function(){var e=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.testing=y.a.testing,e.next=3,this.net.host.start(this.testing);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),A=function(e){Object(v.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(c.a)(this,n),(e=t.call(this)).wsHost=void 0,e.local=new O,e.navigo=void 0,e.navSettings=void 0,e.user=null,e.language=void 0,e.culture=void 0,e.resUrl=void 0,e.resetAll=void 0,e.hashParam=void 0,e.arrs=["/test","/test/"],e.forceDevelopment=void 0,e.reloadUser=function(){var t=e.local.user.get(),n=e.user;(t||n)&&(null===t||void 0===t?void 0:t.id)!==(null===n||void 0===n?void 0:n.id)&&(t?e.logined(t):e.logout())},e.notLogined=void 0,e.userPassword=void 0,e.onChangeLogin=void 0,e.reload=Object(b.a)(j.a.mark((function e(){var t,n,r,a,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new Promise((function(e,t){setTimeout(e,100)})),!("serviceWorker"in navigator)){e.next=6;break}return e.next=4,Promise.race([t,navigator.serviceWorker.ready]);case 4:(n=e.sent)&&n.unregister();case 6:window.document.location.reload(),(r=window.plus)&&((a=r.webview)?a.reload&&a.reload(!0):(i=r.webView)&&i.reload&&i.reload(!0));case 9:case"end":return e.stop()}}),e)}))),e.navLogin=function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.showLogin(function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.history.back());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),!1);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.navLogout=function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.showLogout(Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.history.back());case 1:case"end":return e.stop()}}),e)}))));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.navRegister=function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.showRegister();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.navForget=function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.showForget();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.navPageRoutes=void 0,e.doneSysRoutes=!1,e.sysRoutes={"/login":e.navLogin,"/logout":e.navLogout,"/register":e.navRegister,"/forget":e.navForget},e.createLogin=void 0,e.login=void 0,w=Object(h.a)(e);var a=r.c.lang,i=r.c.district;return e.language=a,e.culture=i,e}return Object(u.a)(n,[{key:"guest",get:function(){var e=this.local.guest;if(void 0===e)return 0;var t=e.get();return void 0===t?0:t.guest}},{key:"onReceive",value:function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.net.messageHub.dispatch(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadUnitJson",value:function(){var e=Object(b.a)(j.a.mark((function e(){var t,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.unitJsonPath(),e.next=4,fetch(t,{});case 4:return n=e.sent,e.next=7,n.json();case 7:return r=e.sent,e.abrupt("return",r.unit);case 11:return e.prev=11,e.t0=e.catch(0),this.local.unit.remove(),e.abrupt("return");case 15:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"setSettings",value:function(e){this.navSettings=e;var t=e.htmlTitle;t&&(document.title=t);var n=document.getElementsByTagName("html")[0];if(n)null===n||void 0===n||n.getAttribute("data-version")}},{key:"oem",get:function(){return this.navSettings&&this.navSettings.oem}},{key:"unitJsonPath",value:function(){var e=document.location,t=e.origin,n=e.pathname;n=n.toLowerCase();var r,a=Object(l.a)(this.arrs);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(!0===n.endsWith(i)){n=n.substr(0,n.length-i.length);break}}}catch(s){a.e(s)}finally{a.f()}return!0!==n.endsWith("/")&&!0!==n.endsWith("\\")||(n=n.substr(0,n.length-1)),t+n+"/unit.json"}},{key:"init",value:function(){var e=Object(b.a)(j.a.mark((function e(){var t,r,a,i,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.a)(Object(f.a)(n.prototype),"init",this).call(this);case 2:if(!0===this.forceDevelopment&&(y.a.isDevelopment=!0),t=this.net.host,r=t.url,a=t.ws,i=t.resHost,this.resUrl=this.net.resUrlFromHost(i),this.wsHost=a,this.net.setCenterUrl(r),void 0!==(s=this.local.guest.get())){e.next=12;break}return e.next=11,this.net.guestApi.guest();case 11:s=e.sent;case 12:if(s){e.next=15;break}throw Error("guest can not be undefined");case 15:this.setGuest(s);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"appStart",value:function(){var e=Object(b.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.notLogined=t,this.userPassword=n,e.next=4,this.init();case 4:return e.next=6,this.start();case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=Object(b.a)(j.a.mark((function e(){var t,n,r,a,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.beforeStart(),!0===y.a.isMobile&&(document.onselectstart=function(){return!1},document.oncontextmenu=function(){return!1}),this.nav.clear(),void 0!==(t=this.local.user.get())){e.next=25;break}if(!this.userPassword){e.next=16;break}return e.next=9,this.userPassword();case 9:if(!(n=e.sent)){e.next=16;break}return r=n.user,a=n.password,e.next=14,this.net.userApi.login({user:r,pwd:a,guest:this.guest});case 14:i=e.sent,t=i;case 16:if(void 0!==t){e.next=25;break}if(void 0===this.notLogined){e.next=22;break}return e.next=20,this.notLogined();case 20:e.next=24;break;case 22:return e.next=24,this.showLogin(void 0);case 24:return e.abrupt("return");case 25:return e.next=27,this.logined(t);case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(0),console.error(e.t0);case 33:return e.prev=33,e.finish(33);case 35:case"end":return e.stop()}}),e,this,[[0,29,33,35]])})));return function(){return e.apply(this,arguments)}}()},{key:"resolveRoute",value:function(){void 0!==this.navigo&&this.navigo.resolve()}},{key:"on",value:function(){return void 0===this.navigo&&(this.navigo=new o,!0!==this.nav.isWebNav&&this.navigo.historyAPIUpdateMethod("replaceState")),this.navigo.on(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},{key:"navigateToLogin",value:function(){this.navigate("/login")}},{key:"navigate",value:function(e,t){if(this.navigo)return!0===this.testing&&(e+="#test"),this.navigo.navigate(e,t);alert('Is not in webnav state, cannot navigate to url "'+e+'"')}},{key:"go",value:function(e,t,n){void 0!==this.navigo?this.navigate(t,n):e()}},{key:"setGuest",value:function(e){this.local.guest.set(e),this.net.setNetToken(0,e.token)}},{key:"saveLocalUser",value:function(){this.local.user.set(this.user)}},{key:"setUqRoles",value:function(e,t){this.user.roles||(this.user.roles={}),this.user.roles[e]=t,this.local.user.set(this.user)}},{key:"loadMe",value:function(){var e=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.net.userApi.me();case 2:t=e.sent,this.user.icon=t.icon,this.user.nick=t.nick;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"internalLogined",value:function(){var e=Object(b.a)(j.a.mark((function e(t,n,r){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.net.logoutApis(),this.user=t,this.saveLocalUser(),this.net.setNetToken(t.id,t.token),this.nav.clear(),e.next=7,null===(a=this.onChangeLogin)||void 0===a?void 0:a.call(this,this.user);case 7:if(void 0===n){e.next=12;break}return e.next=10,n(t);case 10:e.next=18;break;case 12:if(!0!==this.nav.isWebNav){e.next=16;break}this.navigate("/index"),e.next=18;break;case 16:return e.next=18,this.showAppView(r);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"logined",value:function(){var e=Object(b.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.internalLogined(t,n,!1);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"userLogined",value:function(){var e=Object(b.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.internalLogined(t,n,!0);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loginTop",value:function(e){return this.navSettings&&this.navSettings.loginTop||e}},{key:"logout",value:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.local.logoutClear(),this.user=void 0,this.net.logoutApis(),r=this.local.guest.get(),this.net.setCenterToken(0,r&&r.token),this.nav.clear(),void 0!==t){e.next=11;break}return e.next=9,this.start();case 9:e.next=13;break;case 11:return e.next=13,t();case 13:null===(n=this.onChangeLogin)||void 0===n||n.call(this,void 0);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"logs",get:function(){return N}},{key:"log",value:function(e){N.push(e)}},{key:"logMark",value:function(){var e=new Date;x=e.getTime(),N.push("log-mark: "+e.toTimeString())}},{key:"logStep",value:function(e){N.push(e+": "+((new Date).getTime()-x))}},{key:"openSysPage",value:function(e){var t=this.sysRoutes[e];return void 0!==t&&(t(void 0),!0)}},{key:"routeFromNavPage",value:function(e){var t=this;return function(n,r){e&&(t.nav.isWebNav&&t.nav.clear(),e(n))}}},{key:"onNavRoute",value:function(e){this.on(this.routeFromNavPage(e))}},{key:"onNavRoutes",value:function(e){!1===this.doneSysRoutes&&(this.doneSysRoutes=!0,this.internalOnNavRoutes(this.sysRoutes)),this.internalOnNavRoutes(e)}},{key:"internalOnNavRoutes",value:function(e){if(e){this.navPageRoutes=Object.assign(this.navPageRoutes,e);var t={};for(var n in e){var r=e[n];t[n]=this.routeFromNavPage(r)}this.on(t)}}},{key:"checkVersion",value:function(){var e=Object(b.a)(j.a.mark((function e(){var t,n,r,a,i,s,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.location.href,t+=(t.indexOf("?")>=0?"&":"?")+"_t_t_="+(new Date).getTime(),e.next=4,fetch(t);case 4:return n=e.sent,e.next=7,n.text();case 7:return r=e.sent,a=new DOMParser,i=a.parseFromString(r,"text/html"),s=i.getElementsByTagName("html"),c=s[0].getAttribute("data-version"),e.abrupt("return",c);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setCreateLogin",value:function(e){this.createLogin=e}},{key:"changePassword",value:function(){var e=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLogin();case 2:e.sent.showChangePassword();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"userQuit",value:function(){var e=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLogin();case 2:e.sent.showUserQuit();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getLogin",value:function(){var e=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.login){e.next=2;break}return e.abrupt("return",this.login);case 2:return e.next=4,this.createLogin(this);case 4:return e.abrupt("return",this.login=e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showLogin",value:function(){var e=Object(b.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLogin();case 2:e.sent.showLogin(t,n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"showLogout",value:function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLogin();case 2:e.sent.showLogout(t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(_)},,,,function(e,t,n){"use strict";n.d(t,"j",(function(){return r.h})),n.d(t,"i",(function(){return r.b})),n.d(t,"b",(function(){return r.a})),n.d(t,"d",(function(){return P})),n.d(t,"a",(function(){return w})),n.d(t,"h",(function(){return L})),n.d(t,"g",(function(){return Tt})),n.d(t,"f",(function(){return pe})),n.d(t,"e",(function(){return Ne})),n.d(t,"k",(function(){return Dt})),n.d(t,"c",(function(){return Pt}));var r=n(15),a=n(3),i=n(4),s=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;Object(a.a)(this,e),this._params=void 0,this.$$user=void 0,this.method="POST",this.waiting=void 0,this._params=t,this.$$user=n,this.waiting=r}return Object(i.a)(e,[{key:"params",get:function(){return this._params}},{key:"buildParams",value:function(){return this.params}},{key:"headers",get:function(){}}]),e}(),c=n(2),u=n(1),o=n.n(u),l=function(){function e(t){Object(a.a)(this,e),this.net=void 0,this.uqTokens={},this.net=t}return Object(i.a)(e,[{key:"logoutUqTokens",value:function(){for(var e in this.uqTokens)this.uqTokens[e]=void 0;this.net.uqTokenApi.clearLocal()}},{key:"buildAppUq",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){var a,i,s,c,u,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.net.props.unit,e.next=3,this.net.uqTokenApi.uq({unit:a,uqOwner:n,uqName:r});case 3:return void 0===(i=e.sent).token&&(i.token=this.net.centerToken),s=i.db,c=i.url,u=i.urlTest,l=this.net.host.getUrlOrTest(s,c,u),console.log("realUrl: %s",l),i.url=l,this.uqTokens[t]=i,e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getUqToken",value:function(e){return this.uqTokens[e]}}]),e}(),h=n(5),d=n(6),f=n(10),v=["POST","PUT"],p=function(){function e(t,n,r){Object(a.a)(this,e),this.timeout=void 0,this.net=void 0,this.hostUrl=void 0,this.apiToken=void 0,this.net=t,this.hostUrl=n,this.apiToken=r,this.timeout=!0===t.isDevelopment?3e4:5e4}return Object(i.a)(e,[{key:"used",value:function(){this.post("",{})}},{key:"xcall",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i,s,c,u,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.buildOptions(),a=n.headers,i=n.path,s=n.method,void 0!==a)for(u in c=r.headers,a)c[u]=encodeURI(a[u]);return r.method=s,l=n.buildParams(),v.indexOf(s)>=0&&void 0!==l&&(r.body=JSON.stringify(l)),e.next=8,this.innerFetch(t+i,r);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"innerFetchResult",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.innerFetch(t,n);case 2:return r=e.sent,e.abrupt("return",r.res);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i,s,c,u,l=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=l.length>1&&void 0!==l[1]?l[1]:void 0)){e.next=25;break}if(!((r=Object.keys(n)).length>0)){e.next=25;break}a="?",i=Object(f.a)(r),e.prev=6,i.s();case 8:if((s=i.n()).done){e.next=17;break}if(c=s.value,void 0!==n[c]){e.next=13;break}return e.abrupt("continue",15);case 13:t+=a+c+"="+n[c],a="&";case 15:e.next=8;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(6),i.e(e.t0);case 22:return e.prev=22,i.f(),e.finish(22);case 25:return(u=this.buildOptions()).method="GET",e.next=29,this.innerFetchResult(t,u);case 29:return e.abrupt("return",e.sent);case 30:case"end":return e.stop()}}),e,this,[[6,19,22,25]])})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=this.buildOptions()).method="POST",r.body=JSON.stringify(n),e.next=5,this.innerFetchResult(t,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=this.buildOptions()).method="PUT",r.body=JSON.stringify(n),e.next=5,this.innerFetchResult(t,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=this.buildOptions()).method="DELETE",r.body=JSON.stringify(n),e.next=5,this.innerFetchResult(t,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetch",value:function(e){function t(t,n,r,a){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(c.a)(o.a.mark((function e(t,n,r,a){var i,s,u,l,h,d,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t,e.prev=1,console.log("%s-%s %s",n.method,i,n.body||""),s=Date.now(),u=setTimeout((function(){throw new Error("webapi timeout: ".concat(Date.now()-s,"ms ").concat(t))}),this.timeout),e.next=7,fetch(encodeURI(i),n);case 7:if(!1!==(l=e.sent).ok){e.next=12;break}throw clearTimeout(u),console.log("call error %s",l.statusText),l.statusText;case 12:if(!((h=l.headers.get("content-type"))&&h.indexOf("json")>=0)){e.next=17;break}return e.abrupt("return",l.json().then(function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(clearTimeout(u),!0!==t.ok){e.next=4;break}return"object"!==typeof t||Array.isArray(t),e.abrupt("return",r(t));case 4:n=t.error,a(void 0===n?"not valid tonwa json":n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 17:return e.next=19,l.text();case 19:d=e.sent,clearTimeout(u),console.log("text endWait"),r(d);case 23:e.next=33;break;case 25:if(e.prev=25,e.t0=e.catch(1),"string"!==typeof e.t0){e.next=32;break}if(!0!==(f=e.t0.toLowerCase()).startsWith("unauthorized")&&!0!==f.startsWith("$roles")){e.next=32;break}return this.net.logout(),e.abrupt("return");case 32:console.error("fecth error (no nav.showError): "+t);case 33:case 34:case"end":return e.stop()}}),e,this,[[1,25]])})));return function(t,n,r,a){return e.apply(this,arguments)}}())},{key:"callFetch",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){var a,i=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=this.buildOptions()).method=n,a.body=r,e.abrupt("return",new Promise(function(){var e=Object(c.a)(o.a.mark((function e(n,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.fetch(t,a,n,r);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"buildOptions",value:function(){return{headers:this.buildHeaders(),method:void 0,body:void 0}}},{key:"buildHeaders",value:function(){var e=this.net,t=e.language,n=e.culture,r={"Content-Type":"application/json;charset=UTF-8"},a=t;return n&&(a+="-"+n),r["Accept-Language"]=a,this.apiToken&&(r.Authorization=this.apiToken),r}}]),e}(),b=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"innerFetch",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.hostUrl+t,e.abrupt("return",new Promise(function(){var e=Object(c.a)(o.a.mark((function e(t,i){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.fetch(r,n,t,i);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(p),m=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"innerFetch",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.hostUrl+t,e.abrupt("return",new Promise(function(){var e=Object(c.a)(o.a.mark((function e(t,i){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.fetch(r,n,t,i);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(p);var j,y=function(){function e(t,n){Object(a.a)(this,e),this.net=void 0,this.token=void 0,this.path=void 0,this.net=t,this.path=n||""}return Object(i.a)(e,[{key:"xcall",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return n=e.sent,e.next=5,n.xcall(this.path,t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return a=e.sent,e.next=5,a.callFetch(t,n,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:void 0,e.next=3,this.getHttpChannel();case 3:return r=e.sent,e.next=6,r.get(this.path+t,n);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return r=e.sent,e.next=5,r.post(this.path+t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return r=e.sent,e.next=5,r.put(this.path+t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return r=e.sent,e.next=5,r.delete(this.path+t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),O=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r,i,s){var c;return Object(a.a)(this,n),(c=t.call(this,e,r)).uqOwner=void 0,c.uqName=void 0,c.uq=void 0,s&&(c.uqOwner=i,c.uqName=s,c.uq=i+"/"+s),c}return Object(i.a)(n,[{key:"init",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.net.uqTokens.buildAppUq(this.uq,this.uqOwner,this.uqName);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHttpChannel",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,n,r,a=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.net.uqChannels,void 0===(n=t[this.uq])){e.next=7;break}if(!1!==Array.isArray(n)){e.next=5;break}return e.abrupt("return",n);case 5:e.next=8;break;case 7:n=t[this.uq]=[];case 8:return r=n,e.abrupt("return",new Promise(function(){var e=Object(c.a)(o.a.mark((function e(i,s){var c,u,l,h,d,v;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.push({resolve:i,reject:s}),1===r.length){e.next=3;break}return e.abrupt("return");case 3:if(c=a.net.uqTokens.getUqToken(a.uq)){e.next=8;break}return e.next=7,a.init();case 7:c=a.net.uqTokens.getUqToken(a.uq);case 8:l=(u=c).url,h=u.token,a.token=h,n=new m(a.net,l,h),t[a.uq]=n,d=Object(f.a)(r);try{for(d.s();!(v=d.n()).done;)v.value.resolve(n)}catch(o){d.e(o)}finally{d.f()}case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadEntities",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("entities");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAdmins",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("get-admins");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setMeAdmin",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("set-me-admin");case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setAdmin",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r,a,i,s){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("set-admin",{user:t,role:n,name:r,nick:a,icon:i,assigned:s});case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,s){return e.apply(this,arguments)}}()},{key:"isAdmin",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("is-admin");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRoles",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,n,r,a,i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("get-roles");case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:n=t.split("|"),r=[],a=Object(f.a)(n),e.prev=8,a.s();case 10:if((i=a.n()).done){e.next=18;break}if(s=(s=i.value).trim()){e.next=15;break}return e.abrupt("continue",16);case 15:r.push(s);case 16:e.next=10;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),a.e(e.t0);case 23:return e.prev=23,a.f(),e.finish(23);case 26:if(0!==r.length){e.next=28;break}return e.abrupt("return",null);case 28:return e.abrupt("return",r);case 29:case"end":return e.stop()}}),e,this,[[8,20,23,26]])})));return function(){return e.apply(this,arguments)}}()},{key:"getAllRoleUsers",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("get-all-role-users");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setUserRoles",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("set-user-roles",{theUser:t,roles:n});case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteUserRoles",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("delete-user-roles",{theUser:t});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"allSchemas",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("all-schemas");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"schema",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("schema/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queueModify",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("queue-modify",{start:t,page:n,entities:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(y),k=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"getHttpChannel",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.net.getCenterChannel());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(y),g=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this,e,r)).localMap=void 0,i.localMap=e.localDb.createLocalMap("uqTokens"),i}return Object(i.a)(n,[{key:"clearLocal",value:function(){this.localMap.removeAll()}},{key:"uq",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i,s,c,u,l,h,d,f,v,p,b,m,j,y;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.uqOwner,r=t.uqName,a=n+"/"+r,i=this.localMap.child(a),e.prev=3,void 0!==(s=i.get())&&(u=(c=s).unit,l=c.user,u===t.unit&&l===this.net.loginedUserId||(i.remove(),s=void 0)),h=Math.floor(Date.now()/1e3),void 0===s){e.next=11;break}if(f=(d=s).tick,!(void 0!==(v=d.value)&&h-f<86400)){e.next=11;break}return e.abrupt("return",Object.assign({},v));case 11:return(p=Object.assign({},t)).testing=this.net.host.testing,e.next=15,this.get("uq-token",p);case 15:if(void 0!==(b=e.sent)){e.next=20;break}throw m=t.unit,j=t.uqOwner,y=t.uqName,"center get app-uq(unit=".concat(m,", '").concat(j,"/").concat(y,"') - not exists or no unit-service");case 20:return s={unit:t.unit,user:this.net.loginedUserId,tick:h,value:b},i.set(s),e.abrupt("return",Object.assign({},b));case 25:throw e.prev=25,e.t0=e.catch(3),i.remove(),e.t0;case 29:case"end":return e.stop()}}),e,this,[[3,25]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(k),x=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"directCall",value:function(e,t,n){return this.call(e,t,n)}}]),n}(k),w=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"appUqs",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/app-uqs",{appOwner:t,appName:n});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"uqs",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("tie/pure-uqs",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unitxUq",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/unitx-uq",{unit:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"changePassword",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("tie/change-password",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"userQuit",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/user-ask-quit",{});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(k),I=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"login",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,a,i,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("user/login",t);case 2:n=e.sent,e.t0=typeof n,e.next="string"===e.t0?7:"object"===e.t0?8:6;break;case 6:return e.abrupt("return");case 7:return e.abrupt("return",Object(r.f)(n));case 8:return a=n.token,i=Object(r.f)(a),s=n.nick,c=n.icon,s&&(i.nick=s),c&&(i.icon=c),e.abrupt("return",i);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("user/register",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendVerify",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("user/set-verify",{account:t,type:n,oem:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"checkVerify",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("user/check-verify",{account:t,verify:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"isExists",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("user/is-exists",{account:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resetPassword",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("user/reset-password",{account:t,password:n,verify:r,type:a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"userSetProp",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("tie/user-set-prop",{prop:t,value:n});case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"me",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/me");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"user",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/user",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fromKey",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/user-from-key",{key:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(k),C=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"userAppUnits",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/user-app-units",{app:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"userFromKey",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/user-from-key",{key:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"userFromId",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("user/user-name-nick-icon-from-id",{userId:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"userFromName",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/user-from-key",{key:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"usersFromEmail",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/users-from-email",{email:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"userFromMobile",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/users-from-mobile",{mobile:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(k),N=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"guest",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("",{});case 2:t=e.sent,e.t0=typeof t,e.next="string"===e.t0?7:"object"===e.t0?8:6;break;case 6:return e.abrupt("return");case 7:return e.abrupt("return",Object(r.e)(t));case 8:return n=Object(r.e)(t.token),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"unitFromName",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return n=e.sent,e.abrupt("return",n&&n.unit);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(k),_=function(){function e(t){Object(a.a)(this,e),this.net=void 0,this.handlerSeed=1,this.anyHandlers={},this.msgHandlers={},this.net=t}return Object(i.a)(e,[{key:"registerReceiveHandler",value:function(){var e,t=this.handlerSeed++,n=arguments.length<=0?void 0:arguments[0];switch(typeof n){case"string":e=arguments.length<=1?void 0:arguments[1],this.msgHandlers[t]={type:n,handler:e};break;case"function":this.anyHandlers[t]=n}return t}},{key:"unregisterReceiveHandler",value:function(e){delete this.anyHandlers[e],delete this.msgHandlers[e]}},{key:"dispatch",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.$type,e.t0=o.a.keys(this.anyHandlers);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,this.anyHandlers[r](t);case 6:e.next=2;break;case 8:e.t2=o.a.keys(this.msgHandlers);case 9:if((e.t3=e.t2()).done){e.next=18;break}if(a=e.t3.value,i=this.msgHandlers[a],s=i.type,c=i.handler,s===n){e.next=14;break}return e.abrupt("continue",9);case 14:return e.next=16,c(t);case 16:e.next=9;break;case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function A(e){void 0!==j&&j.postMessage({type:"ws",msg:e},"*")}var S=function(){function e(t){Object(a.a)(this,e),this.net=void 0,this.net=t}return Object(i.a)(e,[{key:"receive",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.net.messageHub.dispatch(t);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),q=1,T=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).wsBaseId="WsBridge seed "+q++,e}return Object(i.a)(n)}(S),D=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r,i){var s;return Object(a.a)(this,n),(s=t.call(this,e)).wsBaseId="WSChannel seed "+q++,s.wsHost=void 0,s.token=void 0,s.ws=void 0,s.wsHost=r,s.token=i,s}return Object(i.a)(n,[{key:"connect",value:function(){var e=this;if(void 0===this.ws){var t=this;return new Promise((function(r,a){var i=new WebSocket(e.wsHost,e.token||n.centerToken);console.log("connect webSocket %s",e.wsHost),i.onopen=function(n){console.log("webSocket connected %s",e.wsHost),t.ws=i,r()},i.onerror=function(e){a("webSocket can't open!")},i.onmessage=function(){var e=Object(c.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.wsMessage(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.onclose=function(e){t.ws=void 0,console.log("webSocket closed!")}}))}}},{key:"close",value:function(){void 0!==this.ws&&(this.ws.close(),this.ws=void 0)}},{key:"wsMessage",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("websocket message: %s",t.data),A(n=JSON.parse(t.data)),e.next=6,this.receive(n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("ws msg error: ",e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"sendWs",value:function(e){var t=this;this.connect().then((function(){t.ws.send(e)}))}}],[{key:"setCenterToken",value:function(e){n.centerToken=e}}]),n}(S);D.centerToken=void 0;var E=n(48),P=function(){function e(t){Object(a.a)(this,e),this.centerHost=void 0,this.centerToken=void 0,this.loginedUserId=0,this.centerChannel=void 0,this.props=void 0,this.isDevelopment=void 0,this.localDb=void 0,this.uqChannels={},this.centerApi=void 0,this.uqTokens=void 0,this.userApi=void 0,this.uqTokenApi=void 0,this.callCenterapi=void 0,this.guestApi=void 0,this.messageHub=void 0,this.wsBridge=void 0,this.host=void 0,this.language=void 0,this.culture=void 0,this.isBuildingUQ=void 0,this._uqs=void 0,this.user=void 0,this.props=t,this.isDevelopment=!1,this.localDb=this.createLocalDb(),this.centerApi=new C(this,"tv/"),this.uqTokens=new l(this),this.userApi=new I(this,"tv/"),this.uqTokenApi=new g(this,"tv/tie/"),this.callCenterapi=new x(this,""),this.guestApi=new N(this,"tv/guest/"),this.messageHub=new _(this),this.wsBridge=new T(this),this.host=E.a.createHost(this.isDevelopment)}return Object(i.a)(e,[{key:"logout",value:function(){throw new Error("Method not implemented.")}},{key:"logoutApis",value:function(){this.uqTokens.logoutUqTokens()}},{key:"setCenterUrl",value:function(e){console.log("setCenterUrl %s",e),this.centerHost=e,this.centerChannel=void 0}},{key:"setCenterToken",value:function(e,t){this.loginedUserId=e,this.centerToken=t,this.centerChannel=void 0}},{key:"getCenterChannel",value:function(){return void 0!==this.centerChannel?this.centerChannel:this.centerChannel=new b(this,this.centerHost,this.centerToken)}},{key:"setNetToken",value:function(e,t){this.setCenterToken(e,t),D.setCenterToken(t)}},{key:"clearNetToken",value:function(){this.setCenterToken(0,void 0),D.setCenterToken(void 0)}},{key:"resUrlFromHost",value:function(e){return Object(E.b)(e)}}]),e}();n(22),n(21),n(52),n(53);var F,R=function(){function e(t){Object(a.a)(this,e),this.buildContext=void 0,this.tsHeader=void 0,this.buildContext=t,this.tsHeader="//=== UqApp builder created on ".concat(new Date," ===//")}return Object(i.a)(e,[{key:"tsApp",get:function(){return"".concat(this.tsHeader,"\nimport { NavView, start, nav } from 'tonwa-").concat(this.buildContext.uiPlatform,"';\nimport { CApp } from './CApp';\nimport { appConfig } from './appConfig';\n\nexport const App: React.FC = () => {\n    nav.setSettings(appConfig);\n    const onLogined = async (isUserLogin?:boolean) => {\n        await start(CApp, appConfig, isUserLogin);\n    }\n    return <NavView onLogined={onLogined} />;\n}\n\n")}},{key:"tsCApp",get:function(){return"".concat(this.tsHeader,'\nimport { CUqApp } from "./CBase";\nimport { res } from "./res";\nimport { VMain } from "./VMain";\nimport { setUI } from "./uqs";\n\nconst gaps = [10, 3,3,3,3,3,5,5,5,5,5,5,5,5,10,10,10,10,15,15,15,30,30,60];\n\nexport class CApp extends CUqApp {\n    protected async internalStart(isUserLogin: boolean) {\n        this.setRes(res);\n        setUI(this.uqs);\n        \n        this.openVPage(VMain, undefined, this.dispose);\n    }\n\n    private timer:any;\n    protected onDispose() {\n        clearInterval(this.timer);\n        this.timer = undefined;\n    }\n\n    private tick = 0;\n    private gapIndex = 0;\n    private callTick = async () => {\n        try {\n            if (!this.user) return;\n            ++this.tick;\n            if (this.tick<gaps[this.gapIndex]) return;\n            this.tick = 0;\n            if (this.gapIndex < gaps.length - 1) ++this.gapIndex;\n            let ret = await this.uqs.BzHelloTonwa.$poked.query(undefined, false);\n            let v = ret.ret[0];\n            if (v === undefined) return;\n            if (!v.poke) return;\n            this.gapIndex = 1;\n\n            // \u6570\u636e\u670d\u52a1\u5668\u63d0\u9192\u5ba2\u6237\u7aef\u5237\u65b0\uff0c\u4e0b\u9762\u4ee3\u7801\u91cd\u65b0\u8c03\u5165\u7684\u6570\u636e\n            //this.cHome.refresh();\n        }\n        catch {\n        }\n    }\n}\n')}},{key:"tsCBase",get:function(){return"".concat(this.tsHeader,"\nimport { CSub, CBase, CAppBase, IConstructor } from 'tonwa-").concat(this.buildContext.uiPlatform,"';\nimport { UQs } from './uqs';\nimport { CApp } from './CApp';\n\nexport abstract class CUqBase extends CBase<CApp, UQs> {\n    protected async internalStart(param?:any, ...params:any[]):Promise<void> {}\n}\n\nexport abstract class CUqSub<A extends CAppBase<U>, U, T extends CBase<A,U>> extends CSub<A, U, T> {\n}\n\nexport abstract class CUqApp extends CAppBase<UQs> {\n    newC<T extends CUqBase>(type: IConstructor<T>, ...param:any[]): T {\n        let c = new type(this);\n        c.internalInit(...param);\n        return c;\n    }\n}\n")}},{key:"tsIndex",get:function(){return"".concat(this.tsHeader,"\nexport { CUqApp, CUqBase, CUqSub } from './CBase';\nexport { CApp } from './CApp';\nexport * from './uqs';\nexport * from './App';\nexport * from './startApp';\n")}},{key:"tsVMain",get:function(){return"".concat(this.tsHeader,"\nimport { VPage, Page } from 'tonwa-").concat(this.buildContext.uiPlatform,"';\nimport { CApp } from './CApp';\n\nexport class VMain extends VPage<CApp> {\n    header() { return 'TEST'; }\n    content() {\n        return <div className=\"m-3\">\n            <div>{this.renderMe()}</div>\n            <div className=\"mb-5\">\u540c\u82b1\u6837\u4f8b\u4e3b\u9875\u9762</div>\n        </div>;\n    }\n}\n")}}]),e}(),L=Object(i.a)((function e(t,n){Object(a.a)(this,e),this.uqsLoader=void 0,this.uqTsSrcPath=void 0,this.tsTemplate=void 0,this.uqsLoader=t,this.uqTsSrcPath=n,this.tsTemplate=new R(this)})),V=n(19),B=n(14),M=n(17),U=n(16),W="\n",$="\\ntbfvr",K=$.charCodeAt(0),z=$.charCodeAt(1),H=$.charCodeAt(2),X=$.charCodeAt(3),G=$.charCodeAt(4),Q=$.charCodeAt(5),J=$.charCodeAt(6),Y="\n\t\b\f\v\r",Z=Y.charCodeAt(0),ee=Y.charCodeAt(1),te=Y.charCodeAt(2),ne=Y.charCodeAt(3),re=Y.charCodeAt(4),ae=Y.charCodeAt(5),ie=function(){function e(t,n,r){Object(a.a)(this,e),this.jName=void 0,this.schema=void 0,this.ver=0,this.sys=void 0,this.uq=void 0,this.name=void 0,this.typeId=void 0,this.schemaLocal=void 0,this.uqApi=void 0,this.fields=void 0,this.arrFields=void 0,this.returns=void 0,this.face=void 0,this.fieldMaps={},this.uq=t,this.name=n,this.typeId=r,this.sys=this.name.indexOf("$")>=0,this.schemaLocal=this.uq.localMap.item(this.name),this.uqApi=this.uq.uqApi}return Object(i.a)(e,[{key:"sName",get:function(){return this.jName||this.name}},{key:"fieldMap",value:function(e){void 0===e&&(e="$");var t=this.fieldMaps[e];if(void 0===t){var n;if("$"===e)n=this.fields;else if(void 0!==this.arrFields){var r=this.arrFields.find((function(t){return t.name===e}));void 0!==r&&(n=r.fields)}else if(void 0!==this.returns){var a=this.returns.find((function(t){return t.name===e}));void 0!==a&&(n=a.fields)}if(void 0===n)return{};t={};var i,s=Object(f.a)(n);try{for(s.s();!(i=s.n()).done;){var c=i.value;t[c.name]=c}}catch(u){s.e(u)}finally{s.f()}this.fieldMaps[e]=t}return t}},{key:"loadSchema",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.schema){e.next=2;break}return e.abrupt("return");case 2:if(t=this.schemaLocal.get()){e.next=7;break}return e.next=6,this.uq.loadEntitySchema(this.name);case 6:t=e.sent;case 7:return this.buildSchema(t),e.next=10,this.loadValues();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buildSchema",value:function(e){this.setSchema(e),this.buildFieldsTuid()}},{key:"loadValues",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"clearSchema",value:function(){this.schema=void 0}},{key:"setSchema",value:function(e){if(void 0!==e){var t=e.name,n=e.version;this.ver=n||0,this.setJName(t),this.schemaLocal.set(e),this.schema=e,this.buildFieldsTuid()}}},{key:"setJName",value:function(e){e!==this.name&&(this.jName=e)}},{key:"setKeys",value:function(){}},{key:"buildFieldsTuid",value:function(){var e=this.schema,t=e.fields,n=e.arrs,r=e.returns;this.fields=t,this.setKeys(),this.uq.buildFieldTuid(t),this.arrFields=n,this.uq.buildArrFieldsTuid(n,t),this.returns=r,this.uq.buildArrFieldsTuid(r,t)}},{key:"schemaStringify",value:function(){return JSON.stringify(this.schema,(function(e,t){if("_tuid"!==e)return t}),4)}},{key:"tuidFromName",value:function(e,t){if(void 0!==this.schema){var n=this.schema,r=n.fields,a=n.arrs,i=this.uq,s=e.toLowerCase();if(void 0===t)return o(s,r);if(void 0!==a){var c=t.toLowerCase(),u=a.find((function(e){return e.name===c}));if(void 0!==u)return o(s,u.fields)}}function o(e,t){if(void 0!==t){var n=t.find((function(t){return t.name===e}));if(void 0!==n)return i.getTuid(n.tuid)}}}},{key:"buildParams",value:function(e){var t={},n=this.fields;void 0!==n&&this.buildFieldsParams(t,n,e);var r=this.arrFields;if(void 0!==r){var a,i=Object(f.a)(r);try{for(i.s();!(a=i.n()).done;){var s=a.value,c=s.name,u=s.fields;if(void 0!==e[c]){var o=[];t[c]=o;var l,h=Object(f.a)(e);try{for(h.s();!(l=h.n()).done;){var d=l.value,v={};this.buildFieldsParams(v,u,d),o.push(v)}}catch(p){h.e(p)}finally{h.f()}}}}catch(p){i.e(p)}finally{i.f()}}return t}},{key:"buildFieldsParams",value:function(e,t,n){var r,a=Object(f.a)(t);try{for(a.s();!(r=a.n()).done;){var i=r.value,s=i.name,c=i.type,u=n[s],o=void 0;switch(c){case"datetime":o=this.buildDateTimeParam(u);break;case"date":o=u instanceof Date?"".concat(u.getFullYear(),"-").concat(u.getMonth()+1,"-").concat(u.getDate()):u;break;default:switch(typeof u){default:o=u;break;case"object":if(u instanceof Date){o=u;break}var l=i._tuid;o=void 0===l?u.id:l.getIdFromObj(u)}}e[s]=o}}catch(h){a.e(h)}finally{a.f()}}},{key:"buildDateTimeParam",value:function(e){var t;switch(typeof e){default:throw new Error("escape datetime field in pack data error: value="+e);case"undefined":return;case"object":t=e;break;case"string":case"number":t=new Date(e)}return Math.floor(t.getTime()/1e3)}},{key:"buildDateParam",value:function(e){var t;switch(typeof e){default:throw new Error("escape datetime field in pack data error: value="+e);case"undefined":return"";case"string":return e;case"object":t=e;break;case"number":t=new Date(e)}var n=t.toISOString(),r=n.indexOf("T");return r>0?n.substr(0,r):n}},{key:"pack",value:function(e){var t=[],n=this.fields;void 0!==n&&this.packRow(t,n,e);var a=this.arrFields;if(void 0!==a){var i,s=Object(f.a)(a);try{for(s.s();!(i=s.n()).done;){var c=i.value,u=c.name,o=c.fields,l=Object(r.g)(e,u);this.packArr(t,o,l)}}catch(h){s.e(h)}finally{s.f()}}return t.join("")}},{key:"escape",value:function(e,t){var n=e[t.name];if(null===n)return"";if("datetime"===t.type)return this.buildDateTimeParam(n);switch(typeof n){default:return n;case"object":var r=t._tuid;return void 0===r?n.id:r.getIdFromObj(n);case"string":for(var a=n.length,i="",s=0,c=0;c<a;c++){var u=void 0;switch(n.charCodeAt(c)){default:continue;case K:u="\\\\";break;case ee:u="\\t";break;case Z:u="\\n";break;case ne:u="\\f";break;case re:u="\\v";break;case te:u="\\b";break;case ae:u="\\r"}i+=n.substring(s,c)+u,s=c+1}return i+n.substring(s);case"undefined":return""}}},{key:"packRow",value:function(e,t,n){var r=t.length;if(0!==r){var a="";a+=this.escape(n,t[0]);for(var i=1;i<r;i++){var s=t[i];a+="\t"+this.escape(n,s)}e.push(a+W)}else e.push(W)}},{key:"packArr",value:function(e,t,n){if(void 0!==n)if(0===n.length)e.push(W);else{var r,a=Object(f.a)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.packRow(e,t,i)}}catch(s){a.e(s)}finally{a.f()}}else e.push(W);e.push(W)}},{key:"cacheFieldsInValue",value:function(e,t){var n,r=Object(f.a)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value,i=a.name,s=a._tuid;if(void 0!==s){var c=e[i];e[i]=s.boxId(c)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"unpackTuidIdsOfFields",value:function(e,t){if(void 0===t)return e;var n,r=[],a=Object(f.a)(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i)for(var s=i.length,c=0;c<s;){if(10===i.charCodeAt(c)){++c;break}var u={};c=this.unpackRow(u,t,i,c),r.push(u)}}}catch(o){a.e(o)}finally{a.f()}return r}},{key:"unpackSheet",value:function(e){var t={},n=this.fields,r=0;void 0!==n&&(r=this.unpackRow(t,n,e,r));var a=this.arrFields;if(void 0!==a){var i,s=Object(f.a)(a);try{for(s.s();!(i=s.n()).done;){var c=i.value;r=this.unpackArr(t,c,e,r)}}catch(u){s.e(u)}finally{s.f()}}return t}},{key:"unpackReturns",value:function(e,t){var n={},r=0,a=t||this.returns;if(void 0!==a){var i,s=Object(f.a)(a);try{for(s.s();!(i=s.n()).done;){var c=i.value;r=this.unpackArr(n,c,e,r)}}catch(u){s.e(u)}finally{s.f()}}return n}},{key:"unpackRow",value:function(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:9,i=0,s=0,c=r,u=0,o=n.length,l=t.length;r<o;r++)if(i=s,(s=n.charCodeAt(r))===a){var h=t[u],d=h.name;if(8!==i){if(r>c){var f=n.substring(c,r);e[d]=this.to(e,f,h)}}else e[d]=null;if(c=r+1,++u>=l)return(r=n.indexOf("\n",c))>=0?++r:r=o,r}else if(10===s){var v=t[u],p=v.name;if(8!==i){if(r>c){var b=n.substring(c,r);e[p]=this.to(e,b,v)}}else e[p]=null;return++u,++r}var m=t[u],j=m.name;if(8!==i){var y=n.substring(c);e[j]=this.to(e,y,m)}return o}},{key:"to",value:function(e,t,n){switch(n.type){default:return t;case"text":case"char":return this.reverseNT(t);case"datetime":case"timestamp":var r=Number(t);return!0===isNaN(r)?new Date(t):new Date(1e3*r);case"enum":case"tinyint":case"smallint":case"int":case"bigint":case"dec":case"float":case"double":return Number(t);case"id":var a=Number(t),i=n._tuid;return void 0===i?a:i.boxId(a)}}},{key:"reverseNT",value:function(e){if(void 0!==e&&null!==e){for(var t=e.length,n="",r=0,a=0;a<t;a++){if(e.charCodeAt(a)===K){if(a===t-1)break;var i=void 0;switch(e.charCodeAt(a+1)){default:continue;case K:i="\\";break;case z:i="\n";break;case H:i="\t";break;case X:i="\b";break;case G:i="\f";break;case Q:i="\v";break;case J:i="\r"}n+=e.substring(r,a)+i,r=a+2,++a}}return n+=e.substring(r,t)}}},{key:"unpackArr",value:function(e,t,n,r){for(var a=r,i=[],s=n.length,c=t.name,u=t.fields;r<s;){var o=n.charCodeAt(r);if(10===o){if(r===a){if(10!==(o=n.charCodeAt(r)))throw new Error("upackArr: arr\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f10\uff0c\u5219\u5fc5\u987b\u7d27\u8ddf\u4e00\u4e2a10\uff0c\u8868\u793a\u6574\u4e2aarr\u7684\u7ed3\u675f");++r}++r;break}var l={};i.push(l),r=this.unpackRow(l,u,n,r)}return e[c]=i,r}}]),e}(),se=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r){var i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,c=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return Object(a.a)(this,n),(i=t.call(this,r,s,c)).tries=void 0,i._entity=void 0,i.tries=0,i._entity=e,i}return Object(i.a)(n,[{key:"entity",get:function(){return this._entity}},{key:"request",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entity.loadSchema();case 2:return e.next=4,this.innerRequest();case 4:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"innerCall",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entity.uqApi.xcall(this);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"innerRequest",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,n,r,a,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.innerCall();case 2:if(t=e.sent,n=t.$uq,r=t.$modify,a=t.res,this.entity.uq.pullModify(r),void 0!==n){e.next=8;break}return i=this.xresult(a),e.abrupt("return",i);case 8:return e.next=10,this.retry(n);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"xresult",value:function(e){return e}},{key:"headers",get:function(){var e=this.entity,t=e.ver,n=e.uq.uqVersion;return{uq:"".concat(n),en:"".concat(t)}}},{key:"retry",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(++this.tries,!(this.tries>5)){e.next=3;break}throw new Error("".concat(t.entity.name," can not get right uq response schema, 5 tries"));case 3:return this.rebuildSchema(t),e.next=6,this.innerRequest();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rebuildSchema",value:function(e){var t=e.uq,n=e.entity;void 0!==t&&this.entity.uq.buildEntities(t),void 0!==n&&this.entity.setSchema(n)}}]),n}(s),ce=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"entity",get:function(){return this._entity}}]),n}(se),ue=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"entity",get:function(){return this._entity}},{key:"path",get:function(){return"query/".concat(this.entity.name)}},{key:"xresult",value:function(e){return this.entity.unpackReturns(e)}},{key:"buildParams",value:function(){return this.entity.buildParams(this.params)}}]),n}(se),oe=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"params",get:function(){return this._params}},{key:"entity",get:function(){return this._entity}},{key:"path",get:function(){return"query-page/".concat(this.entity.name)}},{key:"buildParams",value:function(){var e,t=this.params,n=t.pageStart,r=t.pageSize,a=t.params;return(e=void 0===a?{key:""}:this.entity.buildParams(a)).$pageStart=n,e.$pageSize=r,e}},{key:"xresult",value:function(e){return this.entity.unpackReturns(e)}}]),n}(se),le=n(20),he=function(){function e(t){Object(a.a)(this,e),this.queue=[],this.cache=void 0,this.localArr=void 0,this.waitingIds=[],this.tuidInner=void 0,this.cache=t.uq.net.createObservableMap(),this.tuidInner=t,this.initLocalArr()}return Object(i.a)(e,[{key:"initLocalArr",value:function(){this.localArr=this.tuidInner.schemaLocal.arr(this.tuidInner.name+".ids")}},{key:"cacheSet",value:function(e,t){this.cache.set(e,t)}},{key:"useId",value:function(e,t){if(e)if("number"===typeof e)if(!0!==this.cache.has(e))if(this.tuidInner.cacheTuids(!0===t?70:20),this.waitingIds.findIndex((function(t){return t===e}))>=0)this.moveToHead(e);else{if(this.queue.length>=1e4){var n=this.queue.shift();if(n===e)return void this.queue.push(n);if(!0===this.cache.has(n))this.cache.delete(n);else{var r=this.waitingIds.findIndex((function(e){return e===n}));this.waitingIds.splice(r,1)}}this.waitingIds.push(e),this.queue.push(e)}else this.moveToHead(e);else console.error("id cache "+e+" is not number")}},{key:"moveToHead",value:function(e){var t=this.queue.findIndex((function(t){return t===e}));this.queue.splice(t,1),this.queue.push(e)}},{key:"getValue",value:function(e){return this.cache.get(e)}},{key:"remove",value:function(e){this.cache.delete(e);var t=this.queue.findIndex((function(t){return t===e}));this.queue.splice(t,1),this.localArr.removeItem(e)}},{key:"valueFromId",value:function(e){var t;switch(typeof e){case"object":t=e.id;break;case"number":t=e;break;default:return}return this.getValue(t)}},{key:"resetCache",value:function(e){this.remove(e),this.useId(e)}},{key:"cacheValue",value:function(e){if(void 0===e)return!1;var t=this.getIdFromObj(e);return void 0!==t&&(this.cacheSet(t,e),!0)}},{key:"getIdFromObj",value:function(e){return this.tuidInner.getIdFromObj(e)}},{key:"cacheIds",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadIds();case 2:t=e.sent,this.cacheIdValues(t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cacheIdValues",value:function(e){if(void 0!==e){var t,n=this.unpackTuidIds(e),r=Object(f.a)(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;!0===this.cacheValue(a)&&this.cacheTuidFieldValues(a)}}catch(i){r.e(i)}finally{r.f()}}}},{key:"modifyIds",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadTuidIdsOrLocal(t);case 2:if(n=e.sent,0!==(r=n.filter((function(e){var t=e.indexOf("\t");t<0&&(t=e.length);var n=Number(e.substr(0,t));return void 0!==a.localArr.getItem(n)}))).length){e.next=6;break}return e.abrupt("return");case 6:this.cacheIdValues(r);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadIds",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.waitingIds.length){e.next=2;break}return e.abrupt("return");case 2:return t=Object(le.a)(this.waitingIds),this.waitingIds=[],e.next=6,this.loadTuidIdsOrLocal(t);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"unpackTuidIds",value:function(e){return this.tuidInner.unpackTuidIds(e)}},{key:"cacheTuidFieldValues",value:function(e){this.tuidInner.cacheTuidFieldValues(e)}},{key:"assureObj",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(n=this.cache.get(t))){e.next=3;break}return e.abrupt("return",n);case 3:return e.next=5,this.loadTuidIdsOrLocal([t]);case 5:r=e.sent,this.cacheIdValues(r);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadValuesFromIds",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidInner.loadValuesFromIds(void 0,t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadTuidIdsOrLocal",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i,s,c,u,l,h,d,v,p=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=[],a=Object(f.a)(t);try{for(a.s();!(i=a.n()).done;)s=i.value,(c=this.localArr.getItem(s))?n.push(c):r.push(s)}catch(o){a.e(o)}finally{a.f()}if(0!==(u=r.length)){e.next=7;break}return e.abrupt("return",n);case 7:return e.next=9,this.loadValuesFromIds(r);case 9:l=e.sent,h=function(e){var t=l[e];if(!t)return"continue";var a=t.indexOf("\t");a<0&&(a=t.length);var i=Number(t.substr(0,a)),s=r.findIndex((function(e){return e===i}));s>=0&&r.splice(s,1),n.push(t),p.localArr.setItem(i,t)},d=0;case 12:if(!(d<u)){e.next=19;break}if("continue"!==h(d)){e.next=16;break}return e.abrupt("continue",16);case 16:d++,e.next=12;break;case 19:for(u=r.length,v=0;v<u;v++)this.localArr.setItem(r[v],"");return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),de=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r){var i;return Object(a.a)(this,n),(i=t.call(this,e)).div=void 0,i.divName=void 0,i.div=r,i.divName=r.name,i.localArr=e.schemaLocal.arr(e.name+".ids."+i.divName),i}return Object(i.a)(n,[{key:"initLocalArr",value:function(){}},{key:"getIdFromObj",value:function(e){return this.div.getIdFromObj(e)}},{key:"unpackTuidIds",value:function(e){return this.div.unpackTuidIds(e)}},{key:"cacheTuidFieldValues",value:function(e){this.div.cacheTuidFieldValues(e)}},{key:"loadValuesFromIds",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidInner.loadValuesFromIds(this.divName,t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(he),fe=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).noCache=void 0,e.typeName="tuid",e.idName=void 0,e.unique=void 0,e.isImport=!1,e}return Object(i.a)(n,[{key:"setSchema",value:function(e){Object(M.a)(Object(U.a)(n.prototype),"setSchema",this).call(this,e);var t=e.id;this.idName=t}},{key:"buildTuidBox",value:function(){return new _e(this)}},{key:"getIdFromObj",value:function(e){return e[this.idName]}},{key:"stopCache",value:function(){this.noCache=!0}},{key:"cacheIds",value:function(){}},{key:"modifyIds",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"idValue",value:function(e){var t=typeof e;switch(t){default:throw new Error("unknown id type: "+t);case"undefined":return;case"object":return e.id;case"number":return e}}},{key:"equ",value:function(e,t){return void 0!==e&&null!==e&&(void 0!==t&&null!==t&&ve.idValue(e)===ve.idValue(t))}}]),n}(ie),ve=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n)}(fe),pe=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r,i){var s;return Object(a.a)(this,n),(s=t.call(this,e,r,i)).divs=void 0,s.cacheFields=void 0,s.idCache=void 0,s.localArr=void 0,s.idCache=new he(Object(B.a)(s)),s.localArr=s.schemaLocal.arr(s.name+".whole"),!0===e.newVersion&&s.localArr.removeAll(),s}return Object(i.a)(n,[{key:"setSchema",value:function(e){Object(M.a)(Object(U.a)(n.prototype),"setSchema",this).call(this,e);var t=e.arrs;if(void 0!==t){this.divs={};var r,a=Object(f.a)(t);try{for(a.s();!(r=a.n()).done;){var i=r.value,s=i.name,c=new Ae(this.uq,this,s);this.divs[s]=c,c.setSchema(i),c.buildFieldsTuid()}}catch(u){a.e(u)}finally{a.f()}}}},{key:"getObj",value:function(e){var t=this.valueFromId(e);return t||(this.useId(e),{id:e})}},{key:"useId",value:function(e,t){!0!==this.noCache&&e&&this.idCache.useId(e,t)}},{key:"boxId",value:function(e){if(e)return"object"===typeof e?e:(this.useId(e),{id:e})}},{key:"valueFromId",value:function(e){return this.idCache.getValue(e)}},{key:"resetCache",value:function(e){"object"===typeof e&&(e=e.id),this.idCache.resetCache(e)}},{key:"assureBox",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return"object"===typeof t&&(t=t.id),e.next=5,this.idCache.assureObj(t);case 5:return e.abrupt("return",this.idCache.getValue(t));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cacheIds",value:function(){if(this.idCache.cacheIds(),void 0!==this.divs)for(var e in this.divs)this.divs[e].cacheIds()}},{key:"modifyIds",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.idCache.modifyIds(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cacheTuids",value:function(e){this.uq.cacheTuids(e)}},{key:"hasDiv",get:function(){return void 0!==this.divs}},{key:"div",value:function(e){return this.divs&&this.divs[e]}},{key:"loadValuesFromIds",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new je(this,{divName:t,ids:n},void 0,!1).request();case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadMain",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"object"===typeof t&&(t=t.id),e.next=3,this.idCache.assureObj(t);case 3:return e.abrupt("return",this.idCache.valueFromId(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i,s,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t&&0!==t){e.next=2;break}return e.abrupt("return");case 2:"object"===typeof t&&(t=t.id),void 0,e.next=8;break;case 8:return e.next=10,new me(this,t).request();case 10:n=e.sent;case 12:if(void 0!==n){e.next=14;break}return e.abrupt("return");case 14:r=Object(f.a)(this.schema.fields),e.prev=15,r.s();case 17:if((a=r.n()).done){e.next=29;break}if(i=a.value,void 0!==(s=i.tuid)){e.next=22;break}return e.abrupt("continue",27);case 22:if(void 0!==(c=this.uq.getTuid(s))){e.next=25;break}return e.abrupt("continue",27);case 25:u=i.name,n[u]=c.boxId(n[u]);case 27:e.next=17;break;case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(15),r.e(e.t0);case 34:return e.prev=34,r.f(),e.finish(34);case 37:return this.idCache.cacheValue(n),this.cacheTuidFieldValues(n),e.abrupt("return",n);case 40:case"end":return e.stop()}}),e,this,[[15,31,34,37]])})));return function(t){return e.apply(this,arguments)}}()},{key:"cacheTuidFieldValues",value:function(e){var t=this.schema,n=t.fields,r=t.arrs;if(this.cacheFieldsInValue(e,n),void 0!==r){var a,i=Object(f.a)(r);try{for(i.s();!(a=i.n()).done;){var s=a.value,c=s.name,u=s.fields,o=e[c];if(void 0!==o){var l,h=this.div(c),d=Object(f.a)(o);try{for(d.s();!(l=d.n()).done;){var v=l.value;h.cacheValue(v),this.cacheFieldsInValue(v,u)}}catch(p){d.e(p)}finally{d.f()}}}}catch(p){i.e(p)}finally{i.f()}}}},{key:"buildFieldsTuid",value:function(){Object(M.a)(Object(U.a)(n.prototype),"buildFieldsTuid",this).call(this);var e=this.schema,t=e.mainFields,r=e.$create,a=e.$update,i=e.stampOnMain;this.cacheFields=t||this.fields,!0===i&&(!0===r&&this.cacheFields.push({name:"$create",type:"timestamp",_tuid:void 0}),!0===a&&this.cacheFields.push({name:"$update",type:"timestamp",_tuid:void 0})),this.uq.buildFieldTuid(this.cacheFields)}},{key:"unpackTuidIds",value:function(e){return this.unpackTuidIdsOfFields(e,this.cacheFields)}},{key:"save",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new ye(this,{id:t,props:n}).request();case 2:return r=e.sent,void 0!==t&&(this.idCache.remove(t),this.localArr.removeItem(t)),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveProp",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new xe(this,{id:t,prop:n,value:r}).request();case 2:return this.idCache.remove(t),e.next=5,this.idCache.assureObj(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"all",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new ke(this,{}).request();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.searchArr(void 0,t,n,r);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"searchArr",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r,a){var i,s,c,u,l,h;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={arr:void 0,owner:t,key:n,pageStart:r,pageSize:a},e.next=3,new Oe(this,i).request();case 3:s=e.sent,c=this.schema.fields,u=Object(f.a)(s);try{for(u.s();!(l=u.n()).done;)h=l.value,this.cacheFieldsInValue(h,c)}catch(o){u.e(o)}finally{u.f()}return e.abrupt("return",s);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"loadArr",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==r&&0!==r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,new ge(this,{arr:t,owner:n,id:r}).request();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"saveArr",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new we(this,{arr:t,owner:n,id:r,props:a}).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"posArr",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Ie(this,{arr:t,owner:n,id:r,order:a}).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"no",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Ce(this,void 0).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ve),be=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"entity",get:function(){return this._entity}}]),n}(se),me=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).method="GET",e}return Object(i.a)(n,[{key:"path",get:function(){return"tuid/".concat(this.entity.name,"/").concat(this.params)}}]),n}(be),je=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){var e=this.params.divName;return"tuidids/".concat(this.entity.name,"/").concat(void 0!==e?e:"$")}},{key:"buildParams",value:function(){return this.params.ids}},{key:"xresult",value:function(e){return e.split("\n")}}]),n}(be),ye=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){return"tuid/".concat(this.entity.name)}},{key:"buildParams",value:function(){var e=this.entity.schema,t=e.fields,n=e.arrs,r=this.params,a=r.id,i=r.props,s={$id:a};if(this.transParams(s,i,t),void 0!==n){var c,u=Object(f.a)(n);try{for(u.s();!(c=u.n()).done;){var o=c.value,l=o.name,h=[],d=o.fields,v=i[l];if(void 0!==v){var p,b=Object(f.a)(v);try{for(b.s();!(p=b.n()).done;){var m=p.value,j={};this.transParams(j,m,d),h.push(j)}}catch(y){b.e(y)}finally{b.f()}}s[l]=h}}catch(y){u.e(y)}finally{u.f()}}return s}},{key:"transParams",value:function(e,t,n){if(void 0!==t){var r,a=Object(f.a)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value,s=i.name,c=i.tuid,u=i.type,o=t[s];if(void 0!==c)"object"===typeof o&&null!==o&&(o=o.id);else switch(u){case"date":o=this.entity.buildDateParam(o);break;case"datetime":o=this.entity.buildDateTimeParam(o)}e[s]=o}}catch(l){a.e(l)}finally{a.f()}}}}]),n}(be),Oe=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){return"tuids/".concat(this.entity.name)}}]),n}(be),ke=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).method="GET",e}return Object(i.a)(n,[{key:"path",get:function(){return"tuid-all/".concat(this.entity.name)}}]),n}(be),ge=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).method="GET",e}return Object(i.a)(n,[{key:"path",get:function(){var e=this.params,t=e.arr,n=e.owner,r=e.id;return"tuid-arr/".concat(this.entity.name,"/").concat(n,"/").concat(t,"/").concat(r)}}]),n}(be),xe=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){return"tuid-prop/".concat(this.entity.name,"/")}}]),n}(be),we=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){var e=this.params,t=e.arr,n=e.owner;return"tuid-arr/".concat(this.entity.name,"/").concat(n,"/").concat(t,"/")}},{key:"buildParams",value:function(){var e=this.params,t=e.id,n=e.props,r=Object.assign({},n);return r.$id=t,r}}]),n}(be),Ie=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){var e=this.params,t=e.arr,n=e.owner;return"tuid-arr-pos/".concat(this.entity.name,"/").concat(n,"/").concat(t,"/")}},{key:"buildParams",value:function(){var e=this.params;return{bid:e.id,$order:e.order}}}]),n}(be),Ce=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){return"tuid-no/".concat(this.entity.name,"/")}},{key:"buildParams",value:function(){var e=new Date;return{year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate()}}}]),n}(be),Ne=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r,i,s){var c;return Object(a.a)(this,n),(c=t.call(this,e,r,i)).tuidLocal=void 0,c.from=void 0,c.isImport=!0,c.from=s,c}return Object(i.a)(n,[{key:"setFrom",value:function(e){this.tuidLocal=e}},{key:"getObj",value:function(e){var t;return null===(t=this.tuidLocal)||void 0===t?void 0:t.getObj(e)}},{key:"useId",value:function(e){var t;null===(t=this.tuidLocal)||void 0===t||t.useId(e)}},{key:"boxId",value:function(e){var t;return this.tuidLocal,null===(t=this.tuidLocal)||void 0===t?void 0:t.boxId(e)}},{key:"valueFromId",value:function(e){var t;return null===(t=this.tuidLocal)||void 0===t?void 0:t.valueFromId(e)}},{key:"resetCache",value:function(e){var t;null===(t=this.tuidLocal)||void 0===t||t.resetCache(e)}},{key:"assureBox",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.assureBox(t);case 2:return e.abrupt("return",this.tuidLocal.valueFromId(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hasDiv",get:function(){var e;return null===(e=this.tuidLocal)||void 0===e?void 0:e.hasDiv}},{key:"div",value:function(e){var t;return null===(t=this.tuidLocal)||void 0===t?void 0:t.div(e)}},{key:"loadMain",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.loadMain(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.load(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.save(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveProp",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.saveProp(t,n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"all",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.all();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.search(t,n,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"searchArr",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.searchArr(t,n,r,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"loadArr",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.loadArr(t,n,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"saveArr",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.saveArr(t,n,r,a);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"posArr",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.posArr(t,n,r,a);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"no",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.no();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ve),_e=function(){function e(t){Object(a.a)(this,e),this.tuid=void 0,this.ownerField=void 0,this.tuid=t}return Object(i.a)(e,[{key:"boxId",value:function(e){return this.tuid.boxId(e)}},{key:"getIdFromObj",value:function(e){return this.tuid.getIdFromObj(e)}},{key:"useId",value:function(e){return this.tuid.useId(e)}},{key:"showInfo",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:alert("showInfo not implemented");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Ae=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r,i){var s;return Object(a.a)(this,n),(s=t.call(this,e,i,0)).typeName="div",s.cacheFields=void 0,s.tuid=void 0,s.idName=void 0,s.idCache=void 0,s.tuid=r,s.idName="id",s.idCache=new de(r,Object(B.a)(s)),s}return Object(i.a)(n,[{key:"owner",get:function(){return this.tuid}},{key:"buildFieldsTuid",value:function(){Object(M.a)(Object(U.a)(n.prototype),"buildFieldsTuid",this).call(this);var e=this.schema.mainFields;this.uq.buildFieldTuid(this.cacheFields=e)}},{key:"buildTuidDivBox",value:function(e){return new Se(this.tuid,this,e)}},{key:"getIdFromObj",value:function(e){return e[this.idName]}},{key:"cacheValue",value:function(e){this.idCache.cacheValue(e)}},{key:"useId",value:function(e,t){!0!==this.noCache&&this.idCache.useId(e,t)}},{key:"valueFromId",value:function(e){return this.idCache.getValue(e)}},{key:"assureBox",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.idCache.assureObj(t);case 2:return e.abrupt("return",this.idCache.getValue(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cacheIds",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.idCache.cacheIds();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cacheTuidFieldValues",value:function(e){var t=this.schema.fields;this.cacheFieldsInValue(e,t)}},{key:"unpackTuidIds",value:function(e){return this.unpackTuidIdsOfFields(e,this.cacheFields)}}]),n}(pe),Se=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r,i){var s;return Object(a.a)(this,n),(s=t.call(this,e)).ownerField=void 0,s.div=void 0,s.div=r,s.ownerField=i,s}return Object(i.a)(n,[{key:"boxId",value:function(e){return this.div.boxId(e)}},{key:"getIdFromObj",value:function(e){return this.div.getIdFromObj(e)}},{key:"useId",value:function(e){return this.div.useId(e)}}]),n}(_e),qe=function(){function e(t){var n=this;Object(a.a)(this,e),this.uq=void 0,this.modifyMax=void 0,this.cacheTimer=void 0,this.loadIds=function(){n.clearCacheTimer();var e=n.uq.tuids;for(var t in e){e[t].cacheIds()}},this.uq=t}return Object(i.a)(e,[{key:"cacheTuids",value:function(e){this.clearCacheTimer(),this.cacheTimer=setTimeout(this.loadIds,e)}},{key:"clearCacheTimer",value:function(){void 0!==this.cacheTimer&&(clearTimeout(this.cacheTimer),this.cacheTimer=void 0)}},{key:"pullModify",value:function(e){if(void 0!==e){var t=Math.floor(Date.now()/1e3);void 0===this.modifyMax&&(this.modifyMax=this.uq.localModifyMax.get(),void 0===this.modifyMax&&(this.modifyMax={max:e,seconds:t},this.uq.localModifyMax.set(this.modifyMax)));var n=this.modifyMax,r=n.max;if(!(t-n.seconds<3600)&&!(e<=r)){var a=[],i=this.uq.tuids;for(var s in i)a.push(s);0!==a.length&&(this.modifyMax.seconds=t,this.innerPullModify(a.join("\t")))}}}},{key:"innerPullModify",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i,s,c,u,l,h,d,v,p,b,m,j,y,O,k,g,x;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.uq,r=n.uqApi,a=n.tuids,i=this.modifyMax.max,e.next=4,r.queueModify(i,30,t);case 4:s=e.sent,c={},u=0,l=Object(f.a)(s.queue),e.prev=8,l.s();case 10:if((h=l.n()).done){e.next=24;break}if(d=h.value,v=d.id,p=d.entity,b=d.key){e.next=15;break}return e.abrupt("continue",22);case 15:if(void 0!==(m=a[p])){e.next=18;break}return e.abrupt("continue",22);case 18:void 0===(j=c[p])&&(j=c[p]={tuid:m,ids:[]}),j.ids.push(b),v>u&&(u=v);case 22:e.next=10;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(8),l.e(e.t0);case 29:return e.prev=29,l.f(),e.finish(29);case 32:e.t1=o.a.keys(c);case 33:if((e.t2=e.t1()).done){e.next=40;break}return y=e.t2.value,O=c[y],k=O.tuid,g=O.ids,e.next=38,k.modifyIds(g);case 38:e.next=33;break;case 40:x=Math.floor(Date.now()/1e3),this.modifyMax={max:u,seconds:x},this.uq.localModifyMax.set(this.modifyMax);case 43:case"end":return e.stop()}}),e,this,[[8,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Te=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"typeName",get:function(){return"action"}},{key:"submit",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:void 0,r=!(s.length>2&&void 0!==s[2])||s[2],a=new Ee(this,t,n,r),e.next=5,a.request();case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitReturns",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:void 0,e.next=3,new Pe(this,t,n).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitConvert",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:void 0,e.next=3,new Fe(this,t,n).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(ie),De=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n)}(Te),Ee=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){return"action/"+this.entity.name}},{key:"buildParams",value:function(){return{$$user:this.$$user,data:this.entity.pack(this.params)}}}]),n}(ce),Pe=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){return"action/"+this.entity.name+"/returns"}},{key:"xresult",value:function(e){for(var t=this.entity.returns,n=t.length,r={},a=0;a<n;a++){r[t[a].name]=e[a]}return r}}]),n}(Ee),Fe=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){return"action-convert/"+this.entity.name}},{key:"buildParams",value:function(){return{$$user:this.$$user,data:this.params}}}]),n}(Ee),Re=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).states=void 0,e.verify=void 0,e}return Object(i.a)(n,[{key:"typeName",get:function(){return"sheet"}},{key:"setSchema",value:function(e){Object(M.a)(Object(U.a)(n.prototype),"setSchema",this).call(this,e),this.states=e.states,this.verify=e.verify}},{key:"build",value:function(e){this.states=[];var t,n=Object(f.a)(e.ops);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.states.push({name:r,actions:void 0})}}catch(a){n.e(a)}finally{n.f()}}},{key:"createSheetState",value:function(e,t){var n={name:e,actions:[]},r=n.actions;for(var a in t){var i={name:a};r.push(i)}return n}},{key:"save",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.uq.id,a={app:r,discription:t,data:n},e.next=4,new Be(this,a).request();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveDebugDirect",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.uq.id,a={app:r,discription:t,data:n},e.next=4,new Me(this,a).request();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"action",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Ue(this,{id:t,flow:n,state:r,action:a}).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"actionDebugDirect",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new We(this,{id:t,flow:n,state:r,action:a}).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"unpack",value:function(e){var t=e[0][0];return{brief:t,data:this.unpackSheet(t.data),flows:e[1]}}},{key:"getSheet",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new $e(this,t).request();case 2:if(0!==(n=e.sent)[0].length){e.next=7;break}return e.next=6,this.getArchive(t);case 6:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",this.unpack(n));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getArchive",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Ke(this,t).request();case 2:return n=e.sent,e.abrupt("return",this.unpack(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getArchives",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={pageStart:t,pageSize:n},e.next=3,new ze(this,r).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getStateSheets",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={state:t,pageStart:n,pageSize:r},e.next=3,new He(this,a).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"stateSheetCount",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Xe(this,void 0).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"userSheets",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r,a){var i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={state:t,user:n,pageStart:r,pageSize:a},e.next=3,new Ge(this,i).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"mySheets",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={state:t,pageStart:n,pageSize:r},e.next=3,new Qe(this,a).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(ie),Le=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n)}(Re),Ve=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).suffix=void 0,e}return Object(i.a)(n,[{key:"entity",get:function(){return this._entity}},{key:"path",get:function(){return"sheet/".concat(this.entity.name,"/").concat(this.suffix)}}]),n}(se),Be=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){return"sheet/".concat(this.entity.name)}},{key:"buildParams",value:function(){var e=this.params,t=e.app,n=e.discription,r=e.data;return{app:t,discription:n,data:this.entity.pack(r)}}},{key:"xresult",value:function(e){var t=this.entity.verify;if(void 0===t)return e;var n=e.verify;if(void 0===n||0===n.length)return e.verify=void 0,e;var r=t.returns;return e.verify=this.entity.unpackReturns(n,r),e}}]),n}(Ve),Me=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){return"sheet/".concat(this.entity.name,"/direct")}}]),n}(Be),Ue=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).method="PUT",e}return Object(i.a)(n,[{key:"path",get:function(){return"sheet/".concat(this.entity.name)}}]),n}(Ve),We=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){return"sheet/".concat(this.entity.name,"/direct")}}]),n}(Ue),$e=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).method="GET",e}return Object(i.a)(n,[{key:"buildParams",value:function(){}},{key:"path",get:function(){return"sheet/".concat(this.entity.name,"/get/").concat(this.params)}}]),n}(Ve),Ke=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).method="GET",e}return Object(i.a)(n,[{key:"buildParams",value:function(){}},{key:"path",get:function(){return"sheet/".concat(this.entity.name,"/archive/").concat(this.params)}}]),n}(Ve),ze=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).suffix="archives",e}return Object(i.a)(n)}(Ve),He=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).suffix="states",e}return Object(i.a)(n)}(Ve),Xe=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).method="GET",e.suffix="statecount",e}return Object(i.a)(n,[{key:"xresult",value:function(e){return this.entity.states.map((function(t){var n=t.name,r=0,a=e.find((function(e){return e.state===n}));return void 0!==a&&(r=a.count),{state:n,count:r}}))}}]),n}(Ve),Ge=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).suffix="user-sheets",e}return Object(i.a)(n,[{key:"xresult",value:function(e){return e}}]),n}(Ve),Qe=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).suffix="my-sheets",e}return Object(i.a)(n,[{key:"xresult",value:function(e){return e}}]),n}(Ve),Je=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).returns=void 0,e.isPaged=void 0,e}return Object(i.a)(n,[{key:"typeName",get:function(){return"query"}},{key:"setSchema",value:function(e){Object(M.a)(Object(U.a)(n.prototype),"setSchema",this).call(this,e);var t=e.returns;this.returns=t,this.isPaged=t&&void 0!==t.find((function(e){return"$page"===e.name}))}},{key:"pageCaller",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new oe(this,e,t,n)}},{key:"page",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){var a,i,s,c,u=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.length>3&&void 0!==u[3]?u[3]:void 0,i=!(u.length>4&&void 0!==u[4])||u[4],s={pageStart:n,pageSize:r,params:t},e.next=5,this.pageCaller(s,a,i).request();case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"queryCaller",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new ue(this,e,t,n)}},{key:"query",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:void 0,r=!(i.length>2&&void 0!==i[2])||i[2],e.next=4,this.queryCaller(t,n,r).request();case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"table",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:void 0,r=!(s.length>2&&void 0!==s[2])||s[2],e.next=4,this.query(t,n,r);case 4:a=e.sent,e.t0=o.a.keys(a);case 6:if((e.t1=e.t0()).done){e.next=11;break}return i=e.t1.value,e.abrupt("return",a[i]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"obj",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:void 0,r=!(i.length>2&&void 0!==i[2])||i[2],e.next=4,this.table(t,n,r);case 4:if(!((a=e.sent).length>0)){e.next=7;break}return e.abrupt("return",a[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"scalar",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:void 0,r=!(s.length>2&&void 0!==s[2])||s[2],e.next=4,this.obj(t,n,r);case 4:a=e.sent,e.t0=o.a.keys(a);case 6:if((e.t1=e.t0()).done){e.next=11;break}return i=e.t1.value,e.abrupt("return",a[i]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(ie),Ye=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n)}(Je),Ze=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).queryApiName="book",e}return Object(i.a)(n,[{key:"typeName",get:function(){return"book"}},{key:"queryCaller",value:function(e){return new tt(this,e)}}]),n}(Je),et=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n)}(Ze),tt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"path",get:function(){return"book/".concat(this.entity.name)}}]),n}(ue),nt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).queryApiName="history",e}return Object(i.a)(n,[{key:"typeName",get:function(){return"history"}}]),n}(Je),rt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n)}(nt),at=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).keys=void 0,e.actions={},e.queries={},e.schemaFrom=void 0,e}return Object(i.a)(n,[{key:"typeName",get:function(){return"map"}},{key:"setSchema",value:function(e){Object(M.a)(Object(U.a)(n.prototype),"setSchema",this).call(this,e),this.schemaFrom=this.schema.from;var t=e.actions,r=e.queries,a=e.keys;for(var i in this.uq.buildFieldTuid(this.keys=a),t){var s=t[i],c=s.name,u=this.uq.newAction(c,void 0);u.setSchema(s),u.buildFieldsTuid(),this.actions[i]=u}for(var o in r){var l=r[o],h=l.name,d=this.uq.newQuery(h,void 0);d.setSchema(l),d.buildFieldsTuid(),this.queries[o]=d}}},{key:"add",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new ct(this,t).request();case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"del",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new ut(this,t).request();case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"all",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new ot(this,void 0).request();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"page",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new lt(this,{pageStart:n,pageSize:r,param:t}).request();case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"query",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ht(this,t),e.next=3,n.request();case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"table",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query(t);case 2:n=e.sent,e.t0=o.a.keys(n);case 4:if((e.t1=e.t0()).done){e.next=9;break}return r=e.t1.value,e.abrupt("return",n[r]);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"obj",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.table(t);case 2:if(!((n=e.sent).length>0)){e.next=5;break}return e.abrupt("return",n[0]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"scalar",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.obj(t);case 2:n=e.sent,e.t0=o.a.keys(n);case 4:if((e.t1=e.t0()).done){e.next=9;break}return r=e.t1.value,e.abrupt("return",n[r]);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(ie),it=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n)}(at),st=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"entity",get:function(){return this._entity}},{key:"path",get:function(){}},{key:"innerCall",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getCaller(this.params),e.next=3,this.entity.uqApi.xcall(t);case 3:return n=e.sent,r=t.xresult(n.res),e.abrupt("return",{res:r});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buildParams",value:function(){return Object(M.a)(Object(U.a)(n.prototype),"buildParams",this).call(this)}}]),n}(se),ct=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"getCaller",value:function(e){return new dt(this.entity,this.entity.actions.add,e)}}]),n}(st),ut=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"getCaller",value:function(e){return new ft(this.entity,this.entity.actions.add,e)}}]),n}(st),ot=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"getCaller",value:function(e){return new vt(this.entity,this.entity.queries.all,e)}}]),n}(st),lt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"getCaller",value:function(e){return new pt(this.entity,this.entity.queries.page,e)}}]),n}(st),ht=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"getCaller",value:function(e){return new bt(this.entity,this.entity.queries.query,e)}}]),n}(st),dt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r,i){var s;return Object(a.a)(this,n),(s=t.call(this,r,i)).map=void 0,s.map=e,s}return Object(i.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/add")}},{key:"headers",get:function(){}}]),n}(Ee),ft=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r,i){var s;return Object(a.a)(this,n),(s=t.call(this,r,i)).map=void 0,s.map=e,s}return Object(i.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/del")}},{key:"headers",get:function(){}}]),n}(Ee),vt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r,i){var s;return Object(a.a)(this,n),(s=t.call(this,r,i)).map=void 0,s.map=e,s}return Object(i.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/all")}},{key:"headers",get:function(){}}]),n}(oe),pt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r,i){var s;return Object(a.a)(this,n),(s=t.call(this,r,i)).map=void 0,s.map=e,s}return Object(i.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/page")}},{key:"headers",get:function(){}}]),n}(oe),bt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r,i){var s;return Object(a.a)(this,n),(s=t.call(this,r,i)).map=void 0,s.map=e,s}return Object(i.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/query")}},{key:"headers",get:function(){}}]),n}(ue),mt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).queryApiName="pending",e}return Object(i.a)(n,[{key:"typeName",get:function(){return"pending"}}]),n}(Je),jt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n)}(mt),yt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"typeName",get:function(){return"enum"}}]),n}(ie),Ot=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).create=void 0,e.update=void 0,e.owner=void 0,e.keys=void 0,e}return Object(i.a)(n,[{key:"typeName",get:function(){return"id"}},{key:"NO",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqApi.post("id-no",{ID:this.name});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setKeys",value:function(){this.keys=this.schema.keys}},{key:"isGlobal",get:function(){return this.schema.global}},{key:"getIdFromObj",value:function(e){return e.id}},{key:"valueFromString",value:function(e){if(e){var t={};return this.unpackRow(t,this.fields,e,0,12),t}}},{key:"cacheTuids",value:function(e){}},{key:"loadValuesFromIds",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uq.QueryID({IDX:[this],id:n});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"cacheTuidFieldValues",value:function(e){}},{key:"unpackTuidIds",value:function(e){}}]),n}(ie),kt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n)}(Ot),gt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"typeName",get:function(){return"idx"}}]),n}(ie),xt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n)}(gt),wt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"typeName",get:function(){return"ix"}}]),n}(ie),It=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n)}(wt),Ct=function(){function e(t){var n=this;Object(a.a)(this,e),this.uqMan=void 0,this.queue=[],this.cache=void 0,this.waitingIds=[],this.timeoutHandler=void 0,this.timeOut=Object(c.a)(o.a.mark((function e(){var t,r,a,i,s,c,u,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.waitingIds,n.waitingIds=[],0!==t.length){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,n.TvIdValues(t);case 6:r=e.sent,a=Object(f.a)(r);try{for(s=function(){var e=i.value,r=e.id;t[0]<0&&(r=-r),n.cache.set(r,e);var a=t.findIndex((function(e){return e===r}));a>=0&&t.splice(a,1)},a.s();!(i=a.n()).done;)s()}catch(o){a.e(o)}finally{a.f()}c=Object(f.a)(t);try{for(c.s();!(u=c.n()).done;)l=u.value,n.cache.set(l,null)}catch(o){c.e(o)}finally{c.f()}case 11:case"end":return e.stop()}}),e)}))),this.uqMan=t,this.cache=t.net.createObservableMap()}return Object(i.a)(e,[{key:"getValue",value:function(e){var t=this.cache.get(e);if(null!==t)if(void 0!==t){if("number"!==typeof t)return t}else this.useId(e)}},{key:"TvIdValues",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqMan.IDTv(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"useId",value:function(e){if(e)if("number"===typeof e)if(!0!==this.cache.has(e))if(clearTimeout(this.timeoutHandler),this.timeoutHandler=setTimeout(this.timeOut,30),this.waitingIds.findIndex((function(t){return t===e}))>=0)this.moveToHead(e);else{if(this.queue.length>=1e3){var t=this.queue.shift();if(t===e)return void this.queue.push(t);if(!0===this.cache.has(t))this.cache.delete(t);else{var n=this.waitingIds.findIndex((function(e){return e===t}));this.waitingIds.splice(n,1)}}this.waitingIds.push(e),this.queue.push(e)}else this.moveToHead(e);else console.error("id cache "+e+" is not number")}},{key:"moveToHead",value:function(e){var t=this.queue.findIndex((function(t){return t===e}));this.queue.splice(t,1),this.queue.push(e)}},{key:"remove",value:function(e){this.cache.delete(e);var t=this.queue.findIndex((function(t){return t===e}));this.queue.splice(t,1)}},{key:"resetCache",value:function(e){this.remove(e),this.useId(e)}}]),e}();!function(e){e[e.data=0]="data",e[e.sql=1]="sql"}(F||(F={}));var Nt=function(){function e(t,n){var r=this;Object(a.a)(this,e),this.entities={},this.entityTypes={},this.enums={},this.actions={},this.queries={},this.ids={},this.idxs={},this.ixs={},this.sheets={},this.books={},this.maps={},this.histories={},this.pendings={},this.tuidsCache=void 0,this.localEntities=void 0,this.idCache=void 0,this.proxy=void 0,this.$proxy=void 0,this.localMap=void 0,this.localModifyMax=void 0,this.tuids={},this.newVersion=void 0,this.uqOwner=void 0,this.uqName=void 0,this.name=void 0,this.uqApi=void 0,this.id=void 0,this.net=void 0,this.uqVersion=void 0,this.config=void 0,this.roles=void 0,this.allRoles=void 0,this.tuidArr=[],this.actionArr=[],this.queryArr=[],this.idArr=[],this.idxArr=[],this.ixArr=[],this.enumArr=[],this.sheetArr=[],this.bookArr=[],this.mapArr=[],this.historyArr=[],this.pendingArr=[],this.Acts=function(){var e=Object(c.a)(o.a.mark((function e(t){var n,a,i,s,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiActs(t,F.data);case 2:for(s in n=e.sent,a=n[0].ret.split("\n"),i=[],t)i.push(s);for(c={},u=0;u<i.length;u++)c[i[u]]=_t(a[u].split("\t"));return e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.AdminGetList=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.uqApi.getAdmins();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),this.AdminSetMe=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.uqApi.setMeAdmin();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),this.AdminSet=function(){var e=Object(c.a)(o.a.mark((function e(t,n,a,i,s,c){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.uqApi.setAdmin(t,n,a,i,s,c);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i,s){return e.apply(this,arguments)}}(),this.AdminIsMe=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.uqApi.isAdmin();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),this.IDValue=function(e,t){if(e){var n=r.ids[e.toLowerCase()];if(void 0!==n)return n.valueFromString(t)}},this.$Acts=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiActs(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.ActIX=function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiActIX(t,F.data);case 2:return n=e.sent,e.abrupt("return",n[0].ret.split("\t").map((function(e){return Number(e)})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$ActIX=function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiActIX(t,F.sql);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.ActIXSort=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiActIxSort(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$ActIXSort=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiActIxSort(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.ActIDProp=function(){var e=Object(c.a)(o.a.mark((function e(t,n,a,i){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.uqApi.post("act-id-prop",{ID:t.name,id:n,name:a,value:i});case 2:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),this.ActDetail=function(){var e=Object(c.a)(o.a.mark((function e(t){var n,a,i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiActDetail(t,F.data);case 2:return n=e.sent,a=n[0].ret,i=a.split("\n"),s=i.map((function(e){return e.split("\t")})),n={main:_t(s[0])[0],detail:_t(s[1]),detail2:_t(s[2]),detail3:_t(s[3])},e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$ActDetail=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiActDetail(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.QueryID=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiQueryID(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$QueryID=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiQueryID(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.IDTv=function(){var e=Object(c.a)(o.a.mark((function e(t){var n,a,i,s,c,u,l,h,d,v,p,b,m,j;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDTv(t,F.data);case 2:n=e.sent,a=[],i=Object(f.a)(n),e.prev=5,i.s();case 7:if((s=i.n()).done){e.next=30;break}if(c=s.value,u=c.$type,l=c.$tv){e.next=12;break}return e.abrupt("continue",28);case 12:if(h=r.ids[u]){e.next=15;break}return e.abrupt("continue",28);case 15:if(d=h.schema){e.next=20;break}return e.next=19,h.loadSchema();case 19:d=h.schema;case 20:if(v=d.nameNoVice){e.next=23;break}return e.abrupt("continue",28);case 23:for(p=l.split("\n"),b=v.length,m=0;m<b;m++)j=v[m],c[j]=p[m];delete c.$tv,a.push(c);case 28:e.next=7;break;case 30:e.next=35;break;case 32:e.prev=32,e.t0=e.catch(5),i.e(e.t0);case 35:return e.prev=35,i.f(),e.finish(35);case 38:return e.abrupt("return",a);case 39:case"end":return e.stop()}}),e,null,[[5,32,35,38]])})));return function(t){return e.apply(this,arguments)}}(),this.$IDTv=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDTv(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.IDNO=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDNO(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.IDEntity=function(e){return r.entityTypes[e]},this.$IDNO=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDNO(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.IDDetailGet=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDDetailGet(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$IDDetailGet=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDDetailGet(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.ID=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiID(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$ID=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiID(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.KeyID=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiKeyID(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$KeyID=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiKeyID(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.IX=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIX(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$IX=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIX(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.IXValues=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIXValues(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.IXr=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIXr(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$IXr=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIXr(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.KeyIX=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiKeyIX(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$KeyIX=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiKeyIX(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.IDLog=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDLog(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$IDLog=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDLog(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.IDSum=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDSum(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$IDSum=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDSum(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.IDinIX=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDinIX(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$IDinIX=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDinIX(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.IDxID=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDxID(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$IDxID=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDxID(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.IDTree=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDTree(t,F.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.$IDTree=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.apiIDTree(t,F.sql);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.net=t;var i=n.id,s=n.uqOwner,u=n.uqName,l=n.newVersion;this.newVersion=l,this.uqOwner=s,this.uqName=u,this.id=i,this.name=s+"/"+u,this.uqVersion=0,this.localMap=t.localDb.createLocalMap(this.name),this.localModifyMax=this.localMap.child("$modifyMax"),this.localEntities=this.localMap.child("$access");this.uqApi=new O(this.net,"tv/",s,u),this.tuidsCache=new qe(this)}return Object(i.a)(e,[{key:"getID",value:function(e){return this.ids[e.toLowerCase()]}},{key:"getIDX",value:function(e){return this.idxs[e.toLowerCase()]}},{key:"getIX",value:function(e){return this.ixs[e.toLowerCase()]}},{key:"getRoles",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.roles){e.next=2;break}return e.abrupt("return",this.roles);case 2:return e.next=4,this.uqApi.getRoles();case 4:return this.roles=e.sent,e.abrupt("return",this.roles);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"tuid",value:function(e){return this.tuids[e.toLowerCase()]}},{key:"tuidDiv",value:function(e,t){var n=this.tuids[e.toLowerCase()];return n&&n.div(t.toLowerCase())}},{key:"action",value:function(e){return this.actions[e.toLowerCase()]}},{key:"sheet",value:function(e){return this.sheets[e.toLowerCase()]}},{key:"query",value:function(e){return this.queries[e.toLowerCase()]}},{key:"book",value:function(e){return this.books[e.toLowerCase()]}},{key:"map",value:function(e){return this.maps[e.toLowerCase()]}},{key:"history",value:function(e){return this.histories[e.toLowerCase()]}},{key:"pending",value:function(e){return this.pendings[e.toLowerCase()]}},{key:"sheetFromTypeId",value:function(e){for(var t in this.sheets){var n=this.sheets[t];if(n.typeId===e)return n}}},{key:"init",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqApi.init();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadEntities",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.localEntities.get()){e.next=6;break}return e.next=5,this.uqApi.loadEntities();case 5:t=e.sent;case 6:if(t){e.next=8;break}return e.abrupt("return");case 8:this.buildEntities(t),e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"buildEntities",value:function(e){this.localEntities.set(e);var t=e.access,n=e.tuids,r=e.role,a=e.version,i=e.ids;this.uqVersion=a,this.allRoles=null===r||void 0===r?void 0:r.names,this.buildTuids(n),this.buildIds(i),this.buildAccess(t)}},{key:"buildTuids",value:function(e){for(var t in e){var n=e[t],r=n.typeId,a=n.from;this.newTuid(t,r,a).sys=!0}for(var i in e){var s=e[i];this.getTuid(i).setSchema(s)}for(var c in this.tuids){this.tuids[c].buildFieldsTuid()}}},{key:"buildIds",value:function(e){for(var t in e){var n=e[t],r=n.typeId;this.newID(t,r).setSchema(n)}}},{key:"loadEntitySchema",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqApi.schema(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadAllSchemas",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqApi.allSchemas();case 2:t=e.sent,[this.actionArr,this.enumArr,this.sheetArr,this.queryArr,this.bookArr,this.mapArr,this.historyArr,this.pendingArr,this.idArr,this.idxArr,this.ixArr].forEach((function(e){e.forEach((function(e){var n=t[e.name.toLowerCase()];if(n){var r=n.call;r&&e.buildSchema(r)}}))}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTuid",value:function(e){return this.tuids[e]}},{key:"buildAccess",value:function(e){for(var t in e){var n=e[t];switch(typeof n){case"string":this.fromType(t,n);break;case"object":this.fromObj(t,n)}}}},{key:"cacheTuids",value:function(e){this.tuidsCache.cacheTuids(e)}},{key:"setEntity",value:function(e,t){this.entities[e]=t,this.entities[e.toLowerCase()]=t,this.entityTypes[t.typeId]=t}},{key:"newEnum",value:function(e,t){var n=this.enums[e];return void 0!==n||(n=this.enums[e]=new yt(this,e,t),this.setEntity(e,n),this.enumArr.push(n)),n}},{key:"newAction",value:function(e,t){var n=this.actions[e];return void 0!==n||(n=this.actions[e]=new De(this,e,t),this.setEntity(e,n),this.actionArr.push(n)),n}},{key:"newTuid",value:function(e,t,n){var r=this.tuids[e];return void 0!==r||(r=void 0!==n?new Ne(this,e,t,n):new pe(this,e,t),this.tuids[e]=r,this.setEntity(e,r),this.tuidArr.push(r)),r}},{key:"newQuery",value:function(e,t){var n=this.queries[e];return void 0!==n||(n=this.queries[e]=new Ye(this,e,t),this.setEntity(e,n),this.queryArr.push(n)),n}},{key:"newBook",value:function(e,t){var n=this.books[e];return void 0!==n||(n=this.books[e]=new et(this,e,t),this.setEntity(e,n),this.bookArr.push(n)),n}},{key:"newMap",value:function(e,t){var n=this.maps[e];return void 0!==n||(n=this.maps[e]=new it(this,e,t),this.setEntity(e,n),this.mapArr.push(n)),n}},{key:"newHistory",value:function(e,t){var n=this.histories[e];if(void 0===n)return n=this.histories[e]=new rt(this,e,t),this.setEntity(e,n),this.historyArr.push(n),n}},{key:"newPending",value:function(e,t){var n=this.pendings[e];if(void 0===n)return n=this.pendings[e]=new jt(this,e,t),this.setEntity(e,n),this.pendingArr.push(n),n}},{key:"newSheet",value:function(e,t){var n=this.sheets[e];return void 0!==n||(n=this.sheets[e]=new Le(this,e,t),this.setEntity(e,n),this.sheetArr.push(n)),n}},{key:"newID",value:function(e,t){var n=e.toLowerCase(),r=this.ids[n];return void 0!==r||(r=this.ids[n]=new kt(this,e,t),this.setEntity(e,r),this.idArr.push(r)),r}},{key:"newIDX",value:function(e,t){var n=e.toLowerCase(),r=this.idxs[n];return void 0!==r||(r=this.idxs[n]=new xt(this,e,t),this.setEntity(e,r),this.idxArr.push(r)),r}},{key:"newIX",value:function(e,t){var n=e.toLowerCase(),r=this.ixs[n];return void 0!==r||(r=this.ixs[n]=new It(this,e,t),this.setEntity(e,r),this.ixArr.push(r)),r}},{key:"fromType",value:function(e,t){var n=t.split("|");t=n[0];var r=Number(n[1]);switch(t){case"tuid":break;case"id":this.newID(e,r);break;case"idx":this.newIDX(e,r);break;case"ix":this.newIX(e,r);break;case"action":this.newAction(e,r);break;case"query":this.newQuery(e,r);break;case"book":this.newBook(e,r);break;case"map":this.newMap(e,r);break;case"history":this.newHistory(e,r);break;case"sheet":this.newSheet(e,r);break;case"pending":this.newPending(e,r);break;case"enum":this.newEnum(e,r)}}},{key:"fromObj",value:function(e,t){if("sheet"===t.$)this.buildSheet(e,t)}},{key:"buildSheet",value:function(e,t){var n=this.sheets[e];void 0===n&&(n=this.newSheet(e,t.id)),n.build(t)}},{key:"buildFieldTuid",value:function(e,t){var n=this;if(void 0!==e){var r,a=Object(f.a)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value,s=i.tuid;if(void 0!==s){var c=this.getTuid(s);void 0!==c&&(i._tuid=c.buildTuidBox())}}}catch(h){a.e(h)}finally{a.f()}var u,o=Object(f.a)(e);try{var l=function(){var r=u.value,a=r.owner;if(void 0===a)return"continue";var i=e.find((function(e){return e.name===a}));if(void 0===i&&(void 0!==t&&(i=t.find((function(e){return e.name===a}))),void 0===i))throw new Error("owner field ".concat(a," is undefined"));var s=r.arr,c=r.tuid,o=n.getTuid(i._tuid.tuid.name);if(void 0===o)return"continue";var l=o.div(s||c);r._tuid=l&&l.buildTuidDivBox(i)};for(o.s();!(u=o.n()).done;)l()}catch(h){o.e(h)}finally{o.f()}}}},{key:"buildArrFieldsTuid",value:function(e,t){if(void 0!==e){var n,r=Object(f.a)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value.fields;void 0!==a&&this.buildFieldTuid(a,t)}}catch(i){r.e(i)}finally{r.f()}}}},{key:"pullModify",value:function(e){this.tuidsCache.pullModify(e)}},{key:"getUqKey",value:function(){return this.uqName.split(/[-._]/).join("").toLowerCase()}},{key:"getUqKeyWithConfig",value:function(){if(this.config){var e=this.uqName.split(/[-._]/).join("").toLowerCase(),t=this.config,n=t.dev,a=t.alias;return e=Object(r.d)(n.alias||n.name)+Object(r.d)(null!==a&&void 0!==a?a:e)}}},{key:"hasEntity",value:function(e){return void 0!==this.entities[e]||void 0!==this.entities[e.toLowerCase()]}},{key:"createProxy",value:function(){var e=this,t=new Proxy(this.entities,{get:function(t,n,r){var a=n.toLowerCase();if("$"===a)return e.$proxy;var i=t[a];if(void 0!==i)return i;var s=e[n];if(void 0!==s)return s;e.errUndefinedEntity(String(n))}});return this.proxy=t,this.$proxy=new Proxy(this.entities,{get:function(t,n,r){var a=t[n.toLowerCase()];if(void 0!==a)return a;var i=e["$"+n];if(void 0!==i)return i;e.errUndefinedEntity(String(n))}}),this.idCache=new Ct(this),t}},{key:"errUndefinedEntity",value:function(e){var t=new Error("entity ".concat(this.name,".").concat(e," not defined"));throw t.name=r.b.undefined_entity,t}},{key:"apiPost",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n===F.sql&&(t="sql-"+t),e.next=3,this.uqApi.post(t,r);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"apiActs",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i in r=[],a={},t)r.push(i),a[i]=t[i].map((function(e){var t={};for(var n in e){var r=e[n];if("object"===typeof r){var a={};for(var i in r){var s=r[i];if(s&&"object"===typeof s)if("time"===i)"[object Date]"===Object.prototype.toString.call(s)&&(s=s.getTime());else s=s.id;a[i]=s}t[n]=a}else t[n]=r}return t}));return a.$=r,e.next=6,this.apiPost("acts",n,a);case 6:return s=e.sent,e.abrupt("return",s);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiActIX",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i,s,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.IX,a=t.ID,i=t.values,s=t.IXs,c={IX:At(r),ID:At(a),IXs:null===s||void 0===s?void 0:s.map((function(e){return{IX:At(e.IX),ix:e.ix}})),values:i},e.next=4,this.apiPost("act-ix",n,c);case 4:return u=e.sent,e.abrupt("return",u);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiActIxSort",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.IX,a=t.ix,i=t.id,s=t.after,c={IX:At(r),ix:a,id:i,after:s},e.next=4,this.apiPost("act-ix-sort",n,c);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiActDetail",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i,s,c,u,l,h,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(a=t).main,s=a.detail,c=a.detail2,u=a.detail3,l={main:{name:At(i.ID),value:St(i.value)},detail:{name:At(s.ID),values:null===(r=s.values)||void 0===r?void 0:r.map((function(e){return St(e)}))}},c&&(l.detail2={name:At(c.ID),values:null===(h=c.values)||void 0===h?void 0:h.map((function(e){return St(e)}))}),u&&(l.detail3={name:At(u.ID),values:null===(d=u.values)||void 0===d?void 0:d.map((function(e){return St(e)}))}),e.next=6,this.apiPost("act-detail",n,l);case 6:e.sent;case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiQueryID",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.ID,a=t.IX,(i=t.IDX)||(i=[r]),e.next=4,this.apiPost("query-id",n,Object(V.a)(Object(V.a)({},t),{},{ID:At(r),IX:null===a||void 0===a?void 0:a.map((function(e){return At(e)})),IDX:this.IDXToString(i)}));case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiIDTv",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.apiPost("id-tv",n,t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiIDNO",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.ID,a=t.stamp,e.next=3,this.apiPost("id-no",n,{ID:At(r),stamp:a});case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiIDDetailGet",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i,s,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,a=t.main,i=t.detail,s=t.detail2,c=t.detail3,e.next=3,this.apiPost("id-detail-get",n,{id:r,main:At(a),detail:At(i),detail2:At(s),detail3:At(c)});case 3:return u=e.sent,e.abrupt("return",u);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"IDXToString",value:function(e){return!0===Array.isArray(e)?e.map((function(e){return At(e)})):At(e)}},{key:"apiID",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.IDX,e.next=3,this.apiPost("id",n,Object(V.a)(Object(V.a)({},t),{},{IDX:this.IDXToString(r)}));case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiKeyID",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.ID,a=t.IDX,e.next=3,this.apiPost("key-id",n,Object(V.a)(Object(V.a)({},t),{},{ID:At(r),IDX:null===a||void 0===a?void 0:a.map((function(e){return At(e)}))}));case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiIX",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.IX,a=t.IX1,i=t.IDX,e.next=3,this.apiPost("ix",n,Object(V.a)(Object(V.a)({},t),{},{IX:At(r),IX1:At(a),IDX:null===i||void 0===i?void 0:i.map((function(e){return At(e)}))}));case 3:return s=e.sent,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiIXValues",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.IX,e.next=3,this.apiPost("ix-values",n,Object(V.a)(Object(V.a)({},t),{},{IX:At(r)}));case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiIXr",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.IX,a=t.IX1,i=t.IDX,e.next=3,this.apiPost("ixr",n,Object(V.a)(Object(V.a)({},t),{},{IX:At(r),IX1:At(a),IDX:null===i||void 0===i?void 0:i.map((function(e){return At(e)}))}));case 3:return s=e.sent,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiKeyIX",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.ID,a=t.IX,i=t.IDX,e.next=3,this.apiPost("key-ix",n,Object(V.a)(Object(V.a)({},t),{},{ID:At(r),IX:At(a),IDX:null===i||void 0===i?void 0:i.map((function(e){return At(e)}))}));case 3:return s=e.sent,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiIDLog",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.IDX,e.next=3,this.apiPost("id-log",n,Object(V.a)(Object(V.a)({},t),{},{IDX:At(r)}));case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiIDSum",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.IDX,e.next=3,this.apiPost("id-sum",n,Object(V.a)(Object(V.a)({},t),{},{IDX:At(r)}));case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiIDinIX",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.ID,a=t.IX,e.next=3,this.apiPost("id-in-ix",n,Object(V.a)(Object(V.a)({},t),{},{ID:At(r),IX:At(a)}));case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiIDxID",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.ID,a=t.IX,i=t.ID2,e.next=3,this.apiPost("id-x-id",n,Object(V.a)(Object(V.a)({},t),{},{ID:At(r),IX:At(a),ID2:At(i)}));case 3:return s=e.sent,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiIDTree",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.ID,e.next=3,this.apiPost("id-tree",n,Object(V.a)(Object(V.a)({},t),{},{ID:At(r)}));case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function _t(e){if(e){var t=e.length;if(!(t<=1)){for(var n=[],r=0;r<t-1;r++)n.push(Number(e[r]));return n}}}function At(e){if(e)return"string"===typeof e?e:e.name}function St(e){if(!e)return e;var t={};for(var n in e){var r=e[n];"object"===typeof r&&(r=r.id),t[n]=r}return t}var qt=function(){function e(t){Object(a.a)(this,e),this.net=void 0,this.collection=void 0,this.proxy=void 0,this.uqMans=[],this.net=t,this.uqMans=[],this.collection={}}return Object(i.a)(e,[{key:"buildUqs",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r,a){var i,s,c,u,l,h,d,v,p,b,m,j,y,O,k;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init(t);case 2:if(i=this.net.localDb.createLocalMap("$app"),s=i.child("version"),c=s.get(),n!==c){u=Object(f.a)(this.uqMans);try{for(u.s();!(l=u.n()).done;)l.value.localMap.removeAll()}catch(o){u.e(o)}finally{u.f()}s.set(n)}return e.next=8,this.load();case 8:if(!((h=e.sent).length>0)){e.next=11;break}return e.abrupt("return",h);case 11:if(!1===a&&this.setTuidImportsLocal(),!(h.length>0)){e.next=14;break}return e.abrupt("return",h);case 14:if(r){d=Object(f.a)(r);try{for(d.s();!(v=d.n()).done;)p=v.value,b=p.dev,m=p.name,j=p.alias,y=b.name,O=b.alias,k=(null!==O&&void 0!==O?O:y).toLowerCase()+"/"+(null!==j&&void 0!==j?j:m).toLowerCase(),this.collection[k].config=p}catch(o){d.e(o)}finally{d.f()}}this.proxy=this.buildUQs();case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"uq",value:function(e){return this.collection[e.toLowerCase()]}},{key:"getUqUserRoles",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(n=this.collection[t])){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,n.getRoles();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i,s,c,u,l,h,d,v,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=Object(f.a)(t);try{for(r.s();!(a=r.n()).done;)i=a.value,s=i.uqOwner,c=i.ownerAlias,u=i.uqName,l=i.uqAlias,h=s+"/"+u,d=this.collection[h],v=void 0,d?v=d:(v=new Nt(this.net,i),this.collection[h]=v,n.push(v.init())),this.uqMans.push(v),p=h.toLowerCase(),this.collection[p]=v,l&&(u=l),c&&(s=c),p=(h=s+"/"+u).toLowerCase(),this.collection[p]=v}catch(o){r.e(o)}finally{r.f()}return e.next=5,Promise.all(n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,n,r,a,i,s,c,u,l,h;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=[],r=Object(f.a)(this.uqMans);try{for(r.s();!(a=r.n()).done;)i=a.value,n.push(i.loadEntities())}catch(o){r.e(o)}finally{r.f()}return e.next=6,Promise.all(n);case 6:s=e.sent,c=Object(f.a)(s);try{for(c.s();!(u=c.n()).done;)l=u.value,void 0!==(h=l)&&t.push(h)}catch(o){c.e(o)}finally{c.f()}return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buildUQs",value:function(){var e=this,t={};function n(e,n){if(e){var r=e.toLowerCase();t[e]=n,r!==e&&(t[r]=n)}}var r,a=Object(f.a)(this.uqMans);try{for(a.s();!(r=a.n()).done;){var i=r.value,s=i.createProxy();n(i.getUqKey(),s),n(i.getUqKeyWithConfig(),s)}}catch(c){a.e(c)}finally{a.f()}return new Proxy(t,{get:function(t,n,r){var a=t[n.toLowerCase()];if(void 0!==a)return a;e.errUndefinedUq(String(n))}})}},{key:"errUndefinedUq",value:function(e){var t="UQ ".concat(e," not defined"),n=new Error(t);throw n.name=r.b.undefined_uq,n}},{key:"getUqMans",value:function(){return this.uqMans}},{key:"setTuidImportsLocal",value:function(){var e,t=[],n=Object(f.a)(this.uqMans);try{for(n.s();!(e=n.n()).done;){var r,a=e.value,i=Object(f.a)(a.tuidArr);try{for(i.s();!(r=i.n()).done;){var s=r.value;if(!0===s.isImport){var c=this.setInner(s);c&&t.push(c)}}}catch(u){i.e(u)}finally{i.f()}}}catch(u){n.e(u)}finally{n.f()}return t}},{key:"setInner",value:function(e){var t=e.from,n=t.owner+"/"+t.uq,r=this.collection[n];if(void 0!==r){var a=e.name,i=r.tuid(a);return void 0===i?"setInner(tuidImport: TuidImport): uq ".concat(n," has no Tuid ").concat(a):!0===i.isImport?"setInner(tuidImport: TuidImport): uq ".concat(n," Tuid ").concat(a," is import"):void e.setFrom(i)}!0!==this.net.props.buildingUq&&console.error("setInner(tuidImport: TuidImport): uq ".concat(n," is not loaded"))}}]),e}(),Tt=function(){function e(t,n,r){Object(a.a)(this,e),this.net=void 0,this.uqConfigVersion=void 0,this.uqConfigs=void 0,this.isBuildingUQ=!1,this.uqsMan=void 0,this.net=t,this.uqConfigVersion=n,this.uqConfigs=r}return Object(i.a)(e,[{key:"build",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadUqs();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadUqs",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.uqsMan=new qt(this.net),e.next=3,this.loadUqData(this.uqConfigs);case 3:return t=e.sent,e.next=6,this.uqsMan.buildUqs(t,this.uqConfigVersion,this.uqConfigs,this.isBuildingUQ);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadUqData",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i,s,c,u,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.map((function(e){var t=e.dev,n=e.name,r=e.version,a=e.alias;return{owner:t.name,ownerAlias:t.alias,name:n,version:r,alias:a}})),r=new w(this.net,"tv/"),0!==n.length){e.next=6;break}e.t0=[],e.next=9;break;case 6:return e.next=8,r.uqs(n);case 8:e.t0=e.sent;case 9:if(!((a=e.t0).length<n.length)){e.next=14;break}throw i="\u4e0b\u5217UQ\uff1a\n".concat(n.map((function(e){return"".concat(e.owner,"/").concat(e.name)})).join("\n"),"\u4e4b\u4e00\u4e0d\u5b58\u5728"),console.error(i),Error(i);case 14:for(s=0;s<n.length;s++)c=n[s],u=c.ownerAlias,l=c.alias,a[s].ownerAlias=u,a[s].uqAlias=l;return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Dt(e){var t="{";if(void 0===e)return"undefined";for(var n in e){var r=e[n];if(t+=n+": ",void 0===r)t+="undefined";else if(null===r)t+="null";else switch(typeof r){default:t+=r;break;case"function":t+="function";break;case"object":t+="{obj}"}t+=", "}return t+"}"}var Et=Object(i.a)((function e(t){Object(a.a)(this,e),this.uq=void 0,this.uq=t})),Pt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,r,i){var s;return Object(a.a)(this,n),(s=t.call(this,e)).ID=void 0,s.IX=void 0,s.ID=r,s.IX=i,s}return Object(i.a)(n,[{key:"load",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n,r,a,i,s,c,u,l,h,d,v,p,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.uq.ID({IDX:this.ID,id:t}),this.uq.IX({IX:this.IX,IDX:[this.ID],ix:t})]);case 2:n=e.sent,r={},(a=n[0]).length>0&&(i=a[0].content,r.$=JSON.parse(i)),s=Object(f.a)(n[1]),e.prev=7,s.s();case 9:if((c=s.n()).done){e.next=22;break}if(u=c.value,l=u.entity,h=u.content,void 0!==(d=this.uq.IDEntity(l))){e.next=15;break}return e.abrupt("continue",20);case 15:v=d.name,void 0===(p=r[v])&&(r[v]=p=[]),b=JSON.parse(h),p.push(b);case 20:e.next=9;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(7),s.e(e.t0);case 27:return e.prev=27,s.f(),e.finish(27);case 30:return e.abrupt("return",r);case 31:case"end":return e.stop()}}),e,this,[[7,24,27,30]])})));return function(t){return e.apply(this,arguments)}}()},{key:"saveMain",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var r,a,i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},a={entity:void 0!==n?0:n.typeId,content:JSON.stringify(t)},i=this.ID.name,r[i]=[a],e.next=6,this.uq.Acts(r);case 6:return s=e.sent,e.abrupt("return",s[i][0]);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveDetail",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n,r){var a,i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=void 0!==r?0:r.typeId,i=n.map((function(e){return{ix:t,xi:{entity:a,content:JSON.stringify(e)}}})),e.next=4,this.uq.ActIX({IX:this.IX,ID:this.ID,values:i});case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(Et)},,function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"h",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return v})),n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return O})),n.d(t,"g",(function(){return C}));var r=n(47);function a(e){var t=Object(r.a)(e);return{id:t.id,name:t.name,guest:t.guest,token:e}}function i(e){return{id:0,guest:Object(r.a)(e).guest,token:e}}var s,c="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function u(){for(var e=c.length,t="",n=0;n<8;n++)t+=c.charAt(Math.floor(Math.random()*e));return t}!function(e){e.undefined_entity="UndefinedEntity",e.undefined_uq="UndefinedUq"}(s||(s={}));var o=n(10),l=n(5),h=n(6),d=n(3),f=n(4),v=function(){function e(){Object(d.a)(this,e)}return Object(f.a)(e,[{key:"createLocalMap",value:function(e){return new j(this,e)}}]),e}(),p=function(){function e(t,n){Object(d.a)(this,e),this.local=void 0,this.key=void 0,this.local=t,this.key=n}return Object(f.a)(e,[{key:"get",value:function(){try{var e=this.local.getItem(this.key);if(null===e)return;if(void 0===e)return;return JSON.parse(e)}catch(t){return void this.local.removeItem(this.key)}}},{key:"set",value:function(e){var t=JSON.stringify(e,(function(e,t){if("_tuid"!==e)return t}));this.local.setItem(this.key,t)}},{key:"remove",value:function(e){void 0===e?this.local.removeItem(this.key):this.local.removeLocal(e)}},{key:"child",value:function(e){return this.local.child(e)}},{key:"arr",value:function(e){return this.local.arr(e)}},{key:"map",value:function(e){return this.local.map(e)}}]),e}(),b=function(){function e(t,n){Object(d.a)(this,e),this.caches=void 0,this.locals=void 0,this.localDb=void 0,this.name=void 0,this.localDb=t,this.name=n,this.caches={},this.locals={}}return Object(f.a)(e,[{key:"getItem",value:function(e){var t=this.keyForGet(e);if(void 0!==t)return this.localDb.getItem(t)}},{key:"setItem",value:function(e,t){var n=this.keyForSet(e);this.localDb.setItem(n,t)}},{key:"removeItem",value:function(e){var t=this.keyForSet(e);void 0!==t&&localStorage.removeItem(t)}},{key:"arr",value:function(e){var t=String(e),n=this.locals[t];if(void 0===n){var r=this.keyForSet(e);this.locals[t]=n=new m(this.localDb,r)}return n}},{key:"map",value:function(e){var t=String(e),n=this.locals[t];if(void 0===n){var r=this.keyForSet(e);this.locals[t]=n=new j(this.localDb,r)}return n}},{key:"removeLocal",value:function(e){var t=e.name,n=this.keyForRemove(t);if(void 0!==n){var r=this.locals[t];void 0===r?r=new m(this.localDb,n):this.locals[t]=void 0,r.removeAll()}}},{key:"child",value:function(e){var t=String(e),n=this.caches[t];return void 0!==n?n:this.caches[t]=new p(this,e)}}]),e}(),m=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;Object(d.a)(this,n),(a=t.call(this,e,r)).index=void 0;var i=a.localDb.getItem(a.name);return a.index=null===i?[]:i.split("\n").map((function(e){return Number(e)})),a}return Object(f.a)(n,[{key:"saveIndex",value:function(){this.localDb.setItem(this.name,this.index.join("\n"))}},{key:"keyForGet",value:function(e){if(!(this.index.indexOf(e)<0))return"".concat(this.name,".").concat(e)}},{key:"keyForSet",value:function(e){var t=this.index.indexOf(e);return t<0?(this.index.unshift(e),this.index.length>500&&this.index.pop()):(this.index.splice(t,1),this.index.unshift(e)),this.saveIndex(),"".concat(this.name,".").concat(e)}},{key:"keyForRemove",value:function(e){var t=this.index.indexOf(e);if(!(t<0))return this.index.splice(t,1),this.saveIndex(),"".concat(this.name,".").concat(e)}},{key:"removeAll",value:function(){var e,t=Object(o.a)(this.index);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.localDb.removeItem("".concat(this.name,".").concat(n))}}catch(r){t.e(r)}finally{t.f()}this.localDb.removeItem(this.name),this.index.splice(0)}},{key:"item",value:function(e){return this.child(e)}}]),n}(b),j=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;Object(d.a)(this,n),(a=t.call(this,e,r)).index=void 0,a.max=void 0,a.max=0,a.index={};var i=a.localDb.getItem(a.name);null!==i&&i.split("\n").forEach((function(e){var t=e.indexOf("\t");if(!(t<0)){var n=e.substr(0,t),r=Number(e.substr(t+1));!0!==isNaN(r)&&(a.index[n]=r,r>a.max&&(a.max=r))}}));return a}return Object(f.a)(n,[{key:"saveIndex",value:function(){var e=[];for(var t in this.index){var n=this.index[t];void 0!==n&&e.push("".concat(t,"\t").concat(n))}this.localDb.setItem(this.name,e.join("\n"))}},{key:"keyForGet",value:function(e){var t=this.index[e];if(void 0!==t)return"".concat(this.name,".").concat(t)}},{key:"keyForSet",value:function(e){var t=this.index[e];return void 0===t&&(++this.max,t=this.max,this.index[e]=t,this.saveIndex()),"".concat(this.name,".").concat(t)}},{key:"keyForRemove",value:function(e){var t=this.index[e];if(void 0!==t)return this.index[e]=void 0,this.saveIndex(),"".concat(this.name,".").concat(t)}},{key:"removeAll",value:function(){for(var e in this.index)this.localDb.removeItem("".concat(this.name,".").concat(this.index[e])),this.index[e]=void 0;this.localDb.removeItem(this.name),this.max=0}},{key:"item",value:function(e){return this.child(e)}}]),n}(b);function y(e){return e.split(/[-._]/).map((function(e){return x(e)})).join("_")}function O(e){var t=e.split(/[-._]/),n=t.length;t[0]=function(e){if(!e)return"";var t=e.charCodeAt(0);if(t>=w&&t<=I)return String.fromCharCode(t+32)+e.substr(1);return e}(t[0]);for(var r=1;r<n;r++)t[1]=x(t[1]);return t.join("_")}var k="a".charCodeAt(0),g="z".charCodeAt(0);function x(e){if(!e)return"";var t=e.charCodeAt(0);return t>=k&&t<=g?String.fromCharCode(t-32)+e.substr(1):e}var w="A".charCodeAt(0),I="Z".charCodeAt(0);function C(e,t){if(e&&t){var n=Object.keys(e);t=t.toLowerCase();for(var r=0,a=n;r<a.length;r++){var i=a[r];if(i.toLowerCase()===t)return e[i]}}}},,,function(e,t,n){"use strict";n.d(t,"k",(function(){return r.a})),n.d(t,"l",(function(){return a.a})),n.d(t,"o",(function(){return i.a})),n.d(t,"e",(function(){return Re})),n.d(t,"c",(function(){return Je})),n.d(t,"j",(function(){return oe})),n.d(t,"g",(function(){return ue})),n.d(t,"i",(function(){return st})),n.d(t,"b",(function(){return ht})),n.d(t,"m",(function(){return wt})),n.d(t,"h",(function(){return ye})),n.d(t,"d",(function(){return Oe})),n.d(t,"f",(function(){return ke})),n.d(t,"n",(function(){return It})),n.d(t,"a",(function(){return Nt}));var r=n(33),a=n(24),i=n(41),s=(n(30),n(40),n(10));var c=n(2),u=n(3),o=n(4),l=n(5),h=n(6),d=n(1),f=n.n(d),v=n(8),p=n.n(v),b=n(7),m=n(12),j=n.n(m),y=n(9),O=n(14),k=n(20),g=n(17),x=n(16),w=n(29),I=n.n(w),C=Object(o.a)((function e(){Object(u.a)(this,e)})),N=Object(y.i)(y.e),_=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this)).func=void 0,r.func=e,r}return Object(o.a)(n,[{key:"check",value:function(e,t){var n=this.func(t);if(void 0!==n)switch(typeof n){case"undefined":return;case"string":return void e.push(n);default:return void e.push.apply(e,Object(k.a)(n))}}}]),n}(C),A=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this)).res=void 0,r.res=null!==e&&void 0!==e?e:N,r}return Object(o.a)(n)}(C),S=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"check",value:function(e,t){switch(typeof t){default:case"boolean":return;case"object":if(null!==t)return;break;case"string":if(t.trim().length>0)return;break;case"number":if(!1===isNaN(t))return;case"undefined":}e.push(this.res.required)}}]),n}(A),q=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(u.a)(this,n),(i=t.call(this,e)).minMsg=void 0,i.maxMsg=void 0,i.min=void 0,i.max=void 0,i.minMsg=I.a.template(i.res.min),i.maxMsg=I.a.template(i.res.max),i.min=r,i.max=a,i}return Object(o.a)(n,[{key:"check",value:function(e,t){if(void 0!==t&&null!==t){var n=Number(t);!0===isNaN(n)?e.push(this.res.number):this.checkMore(e,n)}}},{key:"checkMore",value:function(e,t){void 0!==this.min&&Number(t)<this.min&&e.push(this.minMsg({min:this.min})),void 0!==this.max&&Number(t)>this.max&&e.push(this.maxMsg({max:this.max}))}}]),n}(A),T=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"checkMore",value:function(e,t){Object(g.a)(Object(x.a)(n.prototype),"checkMore",this).call(this,e,t),!1===Number.isInteger(t)&&e.push(this.res.integer)}}]),n}(q),D=n(11),E=n(0),P=function(){function e(t,n,r,a){var i=this;Object(u.a)(this,e),this.name=void 0,this.context=void 0,this.fieldProps=void 0,this.children=void 0,this._itemSchema=void 0,this._ui=void 0,this.defaultValue=void 0,this.rules=void 0,this.readOnly=void 0,this.disabled=!1,this.errors=[],this.contextErrors=[],this.visible=null,this.value=null,this.isChanging=void 0,this.onInputChange=function(e){i.changeValue(e.target.value,!0)},this.container=Object(D.a)((function(){var e;if(!1===i.visible)return null;var t=i.context,n=t.form;if(!0===t.inNode||null!==(e=i._ui)&&void 0!==e&&e.align)return i.render();var r=i.label;return!0===i.itemSchema.required&&!1!==n.props.requiredFlag&&null!==r&&(r=Object(E.jsxs)(E.Fragment,{children:[r,"\xa0",Object(E.jsx)("span",{className:"text-danger",children:"*"})]})),n.FieldContainer(r,i.renderBody())})),Object(b.p)(this,{errors:b.q,contextErrors:b.q,hasError:b.i,visible:b.q,value:b.q,disabled:b.q,isOk:b.i}),this.context=t;var s=n.name;if(this.name=s,this._itemSchema=n,this.fieldProps=r,this.children=a,this._ui=t.getUiItem(s),void 0===this.ui)this.readOnly=!1,this.disabled=!1,this.visible=!0;else{var c=this.ui,o=c.readOnly,l=c.disabled,h=c.visible;this.readOnly=!0===o,this.disabled=!0===l,this.visible=!(!1===h)}this.value=this.defaultValue=t.getValue(s)}return Object(o.a)(e,[{key:"hasError",get:function(){return this.errors.length+this.contextErrors.length>0}},{key:"itemSchema",get:function(){return this._itemSchema}},{key:"ui",get:function(){return this._ui}},{key:"init",value:function(){if(this.rules=[],!0===this.itemSchema.required&&this.rules.push(new S(this.context.form.res)),this.buildRules(),void 0!==this.ui){var e=this.ui.rules;if(void 0!==e)if(!1!==Array.isArray(e)){var t,n=Object(s.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.rules.push(new _(r))}}catch(a){n.e(a)}finally{n.f()}}else this.rules.push(new _(e))}}},{key:"buildRules",value:function(){}},{key:"checkRules",value:function(){var e,t,n=[],r=Object(s.a)(this.rules);try{for(r.s();!(e=r.n()).done;){e.value.check(n,this.value)}}catch(a){r.e(a)}finally{r.f()}0===n.length?this.context.removeErrorWidget(this):(this.context.addErrorWidget(this),(t=this.errors).push.apply(t,n))}},{key:"isOk",get:function(){return 0===this.errors.length}},{key:"setError",value:function(e){var t;void 0!==e&&("string"===typeof e?this.errors.push(e):(t=this.errors).push.apply(t,Object(k.a)(e)))}},{key:"setContextError",value:function(e){var t;void 0!==e&&("string"===typeof e?this.contextErrors.push(e):(t=this.contextErrors).push.apply(t,Object(k.a)(e)))}},{key:"clearError",value:function(){this.errors.splice(0)}},{key:"clearContextError",value:function(){this.contextErrors.splice(0)}},{key:"parse",value:function(e){return e}},{key:"setElementValue",value:function(e){}},{key:"setDataValue",value:function(e){!0!==this.isChanging&&(this.context.initData[this.name]=this.value=this.parse(e))}},{key:"setValue",value:function(e){!0!==this.isChanging&&this.changeValue(e,!1)}},{key:"getValue",value:function(){return this.context.getValue(this.name)}},{key:"getReadOnly",value:function(){return this.readOnly}},{key:"getDisabled",value:function(){return this.disabled}},{key:"getVisible",value:function(){return this.visible}},{key:"setReadOnly",value:function(e){this.readOnly=e}},{key:"setDisabled",value:function(e){this.disabled=e}},{key:"setVisible",value:function(e){this.visible=e}},{key:"changeValue",value:function(e,t){var n,r,a=this.value;void 0!==this.ui&&(n=this.ui.onChanging,r=this.ui.onChanged);var i=!0;void 0!==n&&(this.isChanging=!0,i=n(this.context,this.value,a),this.isChanging=!1),!0===i&&(this.setDataValue(e),!0!==t&&this.setElementValue(e),void 0!==r&&(this.isChanging=!0,r(this.context,this.value,a),this.isChanging=!1))}},{key:"className",get:function(){var e,t;return!1!==this.context.inNode||null!==(e=this._ui)&&void 0!==e&&e.align||(t="form-control"),j()(t,this.context.form.FieldClass,this.ui&&this.ui.className)}},{key:"renderBody",value:function(){var e;if(!1===this.hasError&&this.ui){var t=this.ui,n=t.discription,r=t.discriptionClassName;void 0===r&&(r="small text-muted"),e=Object(E.jsx)("span",{className:r,children:n})}return Object(E.jsxs)(E.Fragment,{children:[this.render(),e]})}},{key:"label",get:function(){var e;if(void 0===this.ui)e=this.name;else{var t=this.ui.label;e=null===t?null:t||this.name}return e}},{key:"renderTemplet",value:function(){if(void 0!==this.children)return Object(E.jsx)(E.Fragment,{children:this.children});if(void 0!==this.ui){var e=this.ui.Templet;return"function"===typeof e?e(this.value):e}}},{key:"renderErrors",value:function(){var e=[].concat(Object(k.a)(this.errors),Object(k.a)(this.contextErrors));if(0===e.length)return null;var t=!0===this.context.inNode?"span":"div";return e.map((function(e){return v.createElement(t,{key:e,className:"text-danger d-inline-block my-2 ms-3"},Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("i",{className:"fa fa-exclamation-circle"})," \xa0",e]}))}))}}]),e}(),F=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var s;return Object(u.a)(this,n),(s=t.call(this,e,r,a,i)).inputType="text",s.input=void 0,s.hasFocus=!1,s.onKeyDown=function(){var e=Object(c.a)(f.a.mark((function e(t){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.internalOnKeyDown(t),13===t.keyCode){e.next=3;break}return e.abrupt("return");case 3:if(void 0!==(n=s.context.form.props.onEnter)){e.next=6;break}return e.abrupt("return");case 6:return s.changeValue(t.currentTarget.value,!0),s.input.blur(),e.next=10,n(s.name,s.context);case 10:void 0!==(r=e.sent)&&s.context.setError(s.name,r);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.onBlur=function(e){Object(b.s)((function(){s.onInputChange(e),s.checkRules(),s.context.checkContextRules(),s.hasFocus=!1}))},s.onFocus=function(e){Object(b.s)((function(){s.clearError(),s.context.removeErrorWidget(Object(O.a)(s)),s.context.clearErrors(),s.hasFocus=!0})),setTimeout((function(){console.log("focus and select"),s.input.focus(),s.input.select()}),10)},Object(b.p)(Object(O.a)(s),{hasFocus:b.q}),s}return Object(o.a)(n,[{key:"ui",get:function(){return this._ui}},{key:"setElementValue",value:function(e){null!==this.input&&(this.input.value=e)}},{key:"placeholder",get:function(){if(this.ui){var e=this.ui.placeholder;if(e)return e;var t=this.ui.label;if(t)return t}return this.name}},{key:"internalOnKeyDown",value:function(e){}},{key:"onChange",value:function(e){this.onInputChange(e)}},{key:"setReadOnly",value:function(e){null!==this.input&&(this.input.readOnly=this.readOnly=e)}},{key:"setDisabled",value:function(e){null!==this.input&&(this.input.disabled=this.disabled=e)}},{key:"render",value:function(){var e=this,t=this.renderTemplet();if(void 0!==t)return t;var n={};return!0===this.hasError?n["is-invalid"]=!0:n["required-item"]=!0===this.itemSchema.required,Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("input",{ref:function(t){return e.input=t},className:j()(this.className,n),type:this.inputType,defaultValue:this.value,onChange:function(t){return e.onChange(t)},placeholder:"string"===typeof this.placeholder?this.placeholder:void 0,readOnly:this.readOnly,disabled:this.disabled,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur,maxLength:this.itemSchema.maxLength}),this.renderErrors()]})}}]),n}(P),R=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).input=void 0,e.onInputChange=function(t){e.setValue(t.currentTarget.value)},e.onBlur=function(t){e.onInputChange(t),e.checkRules(),e.context.checkContextRules()},e.onFocus=function(t){e.clearError(),e.context.removeErrorWidget(Object(O.a)(e)),e.context.clearErrors()},e}return Object(o.a)(n,[{key:"itemSchema",get:function(){return this._itemSchema}},{key:"ui",get:function(){return this._ui}},{key:"setElementValue",value:function(e){this.input.value=e}},{key:"setReadOnly",value:function(e){this.input.readOnly=this.readOnly=e}},{key:"setDisabled",value:function(e){this.input.disabled=this.disabled=e}},{key:"render",value:function(){var e=this,t=this.renderTemplet();if(void 0!==t)return t;var n={};return!0===this.hasError?n["is-invalid"]=!0:n["required-item"]=!0===this.itemSchema.required,Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("textarea",{ref:function(t){return e.input=t},onBlur:this.onBlur,onFocus:this.onFocus,className:j()(this.className,n),rows:this.ui&&this.ui.rows,maxLength:this.itemSchema.maxLength,defaultValue:this.defaultValue,onChange:this.onInputChange}),this.renderErrors()]})}}]),n}(P),L=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="password",e}return Object(o.a)(n)}(F),V=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="url",e}return Object(o.a)(n)}(F),B=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="email",e}return Object(o.a)(n)}(F),M=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="number",e}return Object(o.a)(n,[{key:"itemSchema",get:function(){return this._itemSchema}},{key:"buildRules",value:function(){Object(g.a)(Object(x.a)(n.prototype),"buildRules",this).call(this);var e=this.context.form.res,t=this.itemSchema,r=t.min,a=t.max;this.rules.push("integer"===this.itemSchema.type?new T(e,r,a):new q(e,r,a))}},{key:"parse",value:function(e){switch(typeof e){default:case"undefined":return;case"number":return e;case"string":if(0===e.trim().length)return;return Number(e)}}}]),n}(F),U=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="number",e}return Object(o.a)(n,[{key:"isValidKey",value:function(e){return 46===e||8===e||37===e||39===e||e>=48&&e<=57||e>=96&&e<=105||109===e||189===e}},{key:"internalOnKeyDown",value:function(e){var t=e.keyCode;window.event.returnValue=this.isValidKey(t)}}]),n}(M),W=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="date",e}return Object(o.a)(n)}(F),$=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="datetime",e}return Object(o.a)(n)}(F),K=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="time",e}return Object(o.a)(n)}(F),z=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="month",e}return Object(o.a)(n)}(F),H=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).input=void 0,e.trueValue=void 0,e.falseValue=void 0,e.onInputChange=function(t){var n=!0===t.target.checked?e.trueValue:e.falseValue;e.setDataValue(n)},e.onClick=function(){e.context.clearErrors()},e}return Object(o.a)(n,[{key:"ui",get:function(){return this._ui}},{key:"init",value:function(){if(Object(g.a)(Object(x.a)(n.prototype),"init",this).call(this),void 0!==this.ui){var e=this.ui,t=e.trueValue,r=e.falseValue;this.trueValue=void 0===t||t,this.falseValue=void 0!==r&&r}else this.trueValue=!0,this.falseValue=!1}},{key:"setElementValue",value:function(e){this.input.checked=e===this.trueValue}},{key:"setReadOnly",value:function(e){this.input.readOnly=this.readOnly=e}},{key:"setDisabled",value:function(e){this.input.disabled=this.disabled=e}},{key:"render",value:function(){var e,t=this,n=this._ui.align,r=j()(this.className,"form-check-inline p-0"),a=Object(E.jsx)("input",{ref:function(e){return t.input=e},className:"align-self-center",type:"checkbox",defaultChecked:this.defaultValue,onChange:this.onInputChange,onClick:this.onClick});return!0===this.context.inNode||n?(e=n?" justify-content-".concat(n," mb-3 "):"",Object(E.jsxs)("label",{className:r+e,children:[a," ",this.ui&&this.ui.label||this.name]})):Object(E.jsx)("div",{className:r+" h-100",children:Object(E.jsx)("label",{className:"w-100 h-100 mb-0 d-flex justify-content-start ms-2",children:a})})}}]),n}(P),X=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var s;return Object(u.a)(this,n),(s=t.call(this,e,r,a,i)).select=void 0,s.readOnly=!1,s.onInputChange=function(e){s.setDataValue(e.target.value)},Object(b.p)(Object(O.a)(s),{readOnly:b.q}),s}return Object(o.a)(n,[{key:"ui",get:function(){return this._ui}},{key:"setElementValue",value:function(e){this.select.value=e}},{key:"setReadOnly",value:function(e){this.select.disabled=this.readOnly=!e}},{key:"setDisabled",value:function(e){this.select.disabled=this.disabled=e}},{key:"render",value:function(){var e=this;if(!0===this.readOnly){var t=this.ui.list.find((function(t){return t.value===e.value})),n=void 0===t?"(???)":t.title;return Object(E.jsx)("span",{className:"form-control w-min-6c",children:n})}return Object(E.jsx)("select",{ref:function(t){return e.select=t},className:j()(this.className,"form-control"),defaultValue:this.defaultValue,onChange:this.onInputChange,children:this.ui.list.map((function(e,t){var n=e.title,r=e.value;return Object(E.jsx)("option",{className:undefined,value:r,children:n||r},t)}))})}}]),n}(P),G={height:"auto"},Q=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputs={},e}return Object(o.a)(n,[{key:"ui",get:function(){return this._ui}},{key:"setElementValue",value:function(e){for(var t in this.inputs){var n=this.inputs[t];n.checked=e===n.value}}},{key:"setReadOnly",value:function(e){for(var t in this.readOnly=e,this.inputs)this.inputs[t].readOnly=e}},{key:"setDisabled",value:function(e){for(var t in this.disabled=e,this.inputs)this.inputs[t].disabled=e}},{key:"render",value:function(){var e,t=this,n=this.ui,r=n.defaultValue,a=n.list;!0===this.context.isRow&&(e=this.context.rowKey);var i=j()(this.className,"py-0");return Object(E.jsx)("span",{className:i,style:G,children:a.map((function(n,a){var i=n.value,s=n.title,c=t.name;return void 0!==e&&(c+="-"+e),Object(E.jsxs)("label",{className:"form-radio-inline",children:[Object(E.jsx)("input",{ref:function(e){return t.inputs[a]=e},type:"radio",name:c,value:i,defaultChecked:(t.defaultValue||r)===i,onChange:t.onInputChange}),s||i]},a)}))})}}]),n}(P),J=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="range",e.input=void 0,e}return Object(o.a)(n,[{key:"ui",get:function(){return this._ui}},{key:"setReadOnly",value:function(e){this.input.readOnly=this.readOnly=e}},{key:"setDisabled",value:function(e){this.input.disabled=this.disabled=e}},{key:"render",value:function(){var e=this,t=this.ui,n=t.min,r=t.max,a=t.step;return Object(E.jsx)(E.Fragment,{children:Object(E.jsx)("input",{ref:function(t){return e.input=t},className:j()(this.className,"form-control","w-min-6c"),type:this.inputType,defaultValue:this.defaultValue,onChange:this.onInputChange,max:r,min:n,step:a})})}}]),n}(P),Y=Object(E.jsx)("small",{className:"text-muted",children:"[\u65e0]"}),Z=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onClick=Object(c.a)(f.a.mark((function t(){var n,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(n=e.ui&&e.ui.pickId)){t.next=4;break}return alert("no pickId defined!"),t.abrupt("return");case 4:return t.next=6,n(e.context,e.name,e.value);case 6:r=t.sent,Object(b.s)((function(){e.setDataValue(r),e.clearError(),e.clearContextError(),e.checkRules()}));case 8:case"end":return t.stop()}}),t)}))),e}return Object(o.a)(n,[{key:"ui",get:function(){return this._ui}},{key:"setReadOnly",value:function(e){this.readOnly=e}},{key:"setDisabled",value:function(e){this.disabled=e}},{key:"setValue",value:function(e){Object(g.a)(Object(x.a)(n.prototype),"setValue",this).call(this,e)}},{key:"render",value:function(){var e,t;void 0!==this.ui&&(e=this.ui.placeholder,t=this.ui.Templet);var n,r={"form-control":!0,"required-item":!0===this.itemSchema.required,"cursor-pointer":!0,"is-invalid":this.hasError};if(void 0===this.value||null===this.value)n=e||Y,r["text-muted"]=!0;else if(void 0===t){var a;if(null===this.value)a="null";else switch(typeof this.value){case"undefined":a=Y;break;case"object":a=this.value.id;break;default:a=this.value}n=Object(E.jsx)(E.Fragment,{children:a})}else n="function"===typeof t?t(this.value):t;return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("div",{className:j()(r),onClick:this.onClick,children:n}),this.renderErrors()]})}}]),n}(P),ee=function(e,t,n){return Object(E.jsxs)("span",{className:"text-danger",children:["!!data type ",e," only support ",(n||[]).join(", "),", can't use ui ",t,"!!"]})},te=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onClick=Object(c.a)(f.a.mark((function t(){var n,r,a,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Object(b.s)((function(){e.clearError(),e.clearContextError()})),n=e.itemSchema,r=n.name,"submit"!==n.type){t.next=6;break}return t.next=5,e.context.submit(r);case 5:return t.abrupt("return");case 6:if(void 0!==(a=e.context.form.props.onButtonClick)){t.next=10;break}return alert("button ".concat(r," clicked. you should define form onButtonClick")),t.abrupt("return");case 10:return t.next=12,a(r,e.context);case 12:if(void 0!==(i=t.sent)){t.next=15;break}return t.abrupt("return");case 15:Object(b.s)((function(){e.context.setError(r,i)}));case 16:case"end":return t.stop()}}),t)}))),e.observerRender=Object(D.a)((function(){var t,n,r,a=e.itemSchema,i=a.name,s=a.type;if(void 0!==e.ui){var c=e.ui.widget;if("button"!==c)return ee(s,c,["button"]);t=e.ui.Templet,n=e.ui.className,r=e.ui.label}var u,o=e.context,l=o.form,h=o.hasError,d=e.context,f="submit"===s&&h||e.disabled;u=void 0!==e.children?e.children:"function"===typeof t?t():void 0!==t?t:r;var v=Object(E.jsx)("button",{className:n,type:"button",disabled:f,onClick:e.onClick,children:u||i});return!0===d.inNode?Object(E.jsxs)(E.Fragment,{children:[v,e.renderErrors()]}):Object(E.jsxs)("div",{className:l.ButtonClass,children:[Object(E.jsx)("div",{children:e.renderErrors()}),v]})})),e}return Object(o.a)(n,[{key:"ui",get:function(){return this._ui}},{key:"label",get:function(){return null}},{key:"render",value:function(){return v.createElement(this.observerRender)}}]),n}(P),ne=function(){function e(t,n,r,a,i){var s=this;if(Object(u.a)(this,e),this.subContexts=void 0,this.form=void 0,this.uiSchema=void 0,this.initData=void 0,this.inNode=void 0,this.widgets={},this.rules=void 0,this.isRow=void 0,this.errors=[],this.errorWidgets=[],this.renderErrors=Object(D.a)((function(){var e=s.errors;return 0===e.length?null:Object(E.jsx)(E.Fragment,{children:e.map((function(e){return Object(E.jsxs)("span",{className:"text-danger inline-block my-1 ms-3",children:[Object(E.jsx)("i",{className:"fa fa-exclamation-circle"})," \xa0",e]},e)}))})})),Object(b.p)(this,{errors:b.q,errorWidgets:b.q,hasError:b.i}),this.form=t,this.uiSchema=n,this.initData=r,this.inNode=a,this.isRow=i,void 0!==n){var c,o=n.rules;if(void 0!==o)this.rules=[],!1===Array.isArray(o)?this.rules.push(o):(c=this.rules).push.apply(c,Object(k.a)(o))}}return Object(o.a)(e,[{key:"getArrRowContexts",value:function(e){void 0===this.subContexts&&(this.subContexts={});var t=this.subContexts[e];return void 0===t&&(this.subContexts[e]=t={}),t}},{key:"arrName",get:function(){}},{key:"getValue",value:function(e){return this.initData[e]}},{key:"setValue",value:function(e,t){this.initData[e]=t;var n=this.widgets[e];void 0!==n&&n.setValue(t)}},{key:"getDisabled",value:function(e){var t=this.widgets[e];if(void 0!==t)return t.getDisabled()}},{key:"setDisabled",value:function(e,t){var n=this.widgets[e];void 0!==n&&n.setDisabled(t)}},{key:"getReadOnly",value:function(e){var t=this.widgets[e];void 0!==t&&t.getReadOnly()}},{key:"setReadOnly",value:function(e,t){var n=this.widgets[e];void 0!==n&&n.setReadOnly(t)}},{key:"getVisible",value:function(e){var t=this.widgets[e];void 0!==t&&t.getVisible()}},{key:"setVisible",value:function(e,t){var n=this.widgets[e];void 0!==n&&n.setVisible(t)}},{key:"submit",value:function(){var e=Object(c.a)(f.a.mark((function e(t){var n,r,a,i,c,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.checkRules(),!0!==this.hasError){e.next=7;break}n="",r=Object(s.a)(this.errorWidgets);try{for(r.s();!(a=r.n()).done;)i=a.value,n+=i.name+":\n"+i.errors.join("\n")}catch(n){r.e(n)}finally{r.f()}return console.error(n),e.abrupt("return");case 7:if(void 0!==(c=this.form.props.onButtonClick)){e.next=11;break}return alert("button ".concat(t," clicked. you should define form onButtonClick")),e.abrupt("return");case 11:return e.next=13,c(t,this);case 13:if(void 0!==(u=e.sent)){e.next=16;break}return e.abrupt("return");case 16:this.setError(t,u);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkFieldRules",value:function(){for(var e in this.widgets)this.widgets[e].checkRules();if(void 0!==this.subContexts)for(var t in this.subContexts){var n=this.subContexts[t];for(var r in n)n[r].checkFieldRules()}}},{key:"checkContextRules",value:function(){if(this.clearErrors(),void 0!==this.rules){var e,t=Object(s.a)(this.rules);try{for(t.s();!(e=t.n()).done;){var n,r=(0,e.value)(this);if(void 0!==r)if(!0===Array.isArray(r))(n=this.errors).push.apply(n,Object(k.a)(r));else if("string"===typeof r)this.errors.push(r);else for(var a in r)this.setError(a,r[a])}}catch(l){t.e(l)}finally{t.f()}if(void 0!==this.subContexts)for(var i in this.subContexts){var c=this.subContexts[i];for(var u in c){var o=c[u];o.clearErrors(),o.checkContextRules()}}}}},{key:"setError",value:function(e,t){var n=this;Object(b.s)((function(){var r=n.widgets[e];void 0!==r&&(r.setContextError(t),n.addErrorWidget(r))}))}},{key:"clearContextErrors",value:function(){var e=this;Object(b.s)((function(){for(var t in e.widgets){var n=e.widgets[t];void 0!==n&&n.clearContextError()}}))}},{key:"clearWidgetsErrors",value:function(){var e=this;Object(b.s)((function(){for(var t in e.widgets){var n=e.widgets[t];void 0!==n&&n.clearError()}}))}},{key:"checkRules",value:function(){this.clearErrors(),this.clearWidgetsErrors(),this.checkFieldRules(),!0!==this.hasError&&this.checkContextRules()}},{key:"addErrorWidget",value:function(e){this.errorWidgets.findIndex((function(t){return t===e}))<0&&this.errorWidgets.push(e)}},{key:"removeErrorWidget",value:function(e){var t=this.errorWidgets.findIndex((function(t){return t===e}));t>=0&&this.errorWidgets.splice(t,1)}},{key:"checkHasError",value:function(){if(!0===this.errorWidgets.length+this.errors.length>0)return!0;if(void 0===this.subContexts)return!1;for(var e in this.subContexts){var t=this.subContexts[e];for(var n in t)if(!0===t[n].hasError)return!0}return!1}},{key:"hasError",get:function(){return this.checkHasError()}},{key:"clearErrors",value:function(){var e=this;Object(b.s)((function(){e.errors.splice(0),e.errorWidgets.splice(0),e.clearContextErrors()}))}}]),e}(),re=1,ae=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var s,c;Object(u.a)(this,n);var o=e.uiSchema;if(void 0!==o){var l=o.items;void 0!==l&&(c=l[r.name])}return(s=t.call(this,e.form,c,a,i,!0)).parentContext=void 0,s.arrSchema=void 0,s.rowKey=void 0,s.data=void 0,s.parentContext=e,s.arrSchema=r,s.rowKey=re++,s.data=a,s}return Object(o.a)(n,[{key:"getItemSchema",value:function(e){return this.arrSchema.itemSchemas[e]}},{key:"getUiItem",value:function(e){if(void 0!==this.uiSchema){var t=this.uiSchema.items;if(void 0!==t)return t[e]}}},{key:"arrName",get:function(){return this.arrSchema.name}},{key:"clearErrors",value:function(){Object(g.a)(Object(x.a)(n.prototype),"clearErrors",this).call(this),this.parentContext.clearErrors()}},{key:"parentData",get:function(){return this.parentContext.data}}]),n}(ne),ie=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){return Object(u.a)(this,n),t.call(this,e,e.uiSchema,e.data,r,!1)}return Object(o.a)(n,[{key:"data",get:function(){return this.form.data}},{key:"getItemSchema",value:function(e){return this.form.itemSchemas[e]}},{key:"getUiItem",value:function(e){var t=this.form.uiSchema;if(void 0!==t){var n=t.items;if(void 0!==n)return n[e]}}}]),n}(ne),se=v.createContext({}),ce=Object(D.a)((function(e){var t,n,r,a,i=e.parentContext,s=e.arrSchema,c=e.children,u=s.name,o=s.arr,l=i.initData[u],h=i.form,d=i.getArrRowContexts(u),f=i.getUiItem(u),p=f.onDeleted,b=f.onRestored,m=u,y=h.ArrContainer,O=h.RowContainer,k=h.RowSeperator,g=h.uiSchema;if(void 0!==g){var x=g.selectable,w=g.deletable,I=g.restorable;!0!==n&&(n=x),!0!==r&&(r=w),!0!==a&&(a=I)}if(void 0!==f){var C=f.widget,N=f.label,_=f.selectable,A=f.deletable,S=f.restorable,q=f.ArrContainer,T=f.RowContainer,P=f.RowSeperator;if(void 0!==_&&(n=_),void 0!==A&&(r=A),void 0!==S&&(a=S),void 0!==q&&(y=q),void 0!==T&&(O=T),void 0!==P&&(k=P),t=f.Templet,"arr"!==C)return ee(s.type,C,["arr"]);m=N||m}var F=!0;return y(m,Object(E.jsx)(E.Fragment,{children:l.map((function(e,u){var h,f,m=void 0;if(!1===F?m=k:F=!1,void 0!==c)h=new ae(i,s,e,!0),f=Object(E.jsx)(E.Fragment,{children:c});else{var y=typeof t;"function"===y?(h=new ae(i,s,e,!0),f=v.createElement(Object(D.a)(t),e)):"object"===y?(h=new ae(i,s,e,!0),f=t):(h=new ae(i,s,e,!1),f=Object(E.jsx)(E.Fragment,{children:o.map((function(e,t){return Object(E.jsx)(v.Fragment,{children:Fe(h,e,void 0)},e.name)}))}))}var g,x,w=h.rowKey;if(d[w]=h,!0===n){g=Object(E.jsx)("div",{className:"form-row-checkbox",children:Object(E.jsx)("input",{type:"checkbox",onClick:function(t){var n=t.target.checked;e.$isSelected=n;var r=e.$source;void 0!==r&&(r.$isSelected=n),h.clearErrors()},defaultChecked:e.$isSelected})})}var I=!(void 0===e.$isDeleted||!1===e.$isDeleted);if(!0===r){var C=I?"fa-undo":"fa-trash";x=Object(E.jsx)("div",{className:"form-row-edit text-info",onClick:function(){if(!0===a){e.$isDeleted=!I;var t=e.$source;void 0!==t&&(t.$isDeleted=!I),b&&b(e)}else{var n=l.indexOf(e);n>=0&&l.splice(n,1),p&&p(e)}h.clearErrors()},children:Object(E.jsx)("i",{className:j()("fa",C,"fa-fw")})})}var N=!0===n||!0===r?function(t){return Object(E.jsx)("fieldset",{disabled:I,children:Object(E.jsxs)("div",{className:j()("d-flex",{deleted:I,"row-selected":e.$isSelected}),children:[g,Object(E.jsx)("div",{className:!0===n&&!0===r?"form-row-content":"form-row-content-1",children:t}),x]})})}:function(e){return e};return Object(E.jsxs)(se.Provider,{value:h,children:[m,O(N(Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(h.renderErrors,{}),f]})))]},w)}))}))}));function ue(e){var t,n=e.className,r=e.style,a=e.src,i=e.altImage;if(a){if(0!==a.indexOf("."))return!0===a.startsWith(":")&&(a=y.m.resUrl+a.substr(1)),Object(E.jsx)("img",{src:a,className:n,alt:"img",style:r,onError:function(e){e.currentTarget.src=i||"https://tv.jkchemical.com/imgs/0001.png"}});t=a.substr(1)}else t="file-o";return Object(E.jsx)("span",{className:j()(n,"image-none"),style:r,children:Object(E.jsx)("i",{className:"fa fa-"+t})})}function oe(){return Object(E.jsx)("div",{className:"d-flex h-100 align-items-center justify-content-center",children:Object(E.jsx)("i",{className:"fa fa-spinner fa-spin fa-2x fa-fw text-info"})})}n(67),Object(D.a)(le=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e,t=this.props,n=t.className,r=t.badge,a=t.size,i=t.color,s=t.badgeAlign,c=t.badgeVertical,u=t.children,o=j()(n,"va-badge",a&&"va-badge-"+a,"va-badge-"+(i||"secondary"),s&&"va-badg-"+s,c&&"va-badg-"+c);return r&&(e=Object(E.jsx)("b",{children:r})),Object(E.jsxs)("div",{className:o,children:[u,e]})}}]),n}(v.Component)),n(68);var le,he,de,fe,ve,pe,be,me,je,ye=Object(D.a)(he=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e,t,n,r=this.props,a=r.className,i=r.style,s=r.left,c=r.children,u=r.right,o=r.onClick;return void 0!==s&&(e=Object(E.jsx)("header",{children:s})),void 0!==u&&(t=Object(E.jsx)("footer",{children:u})),void 0!==o&&(n="cursor-pointer"),Object(E.jsxs)("div",{className:j()("va-lmr",a,n),style:i,onClick:o,children:[e,Object(E.jsx)("div",{children:c}),t]})}}]),n}(v.Component))||he,Oe=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.className,r=e.size,a=e.spin,i=e.fixWidth,s=e.border,c=e.pull,u=e.pulse,o=e.rotate,l=e.flip,h=e.inverse,d=j()(n,"fa",t&&"fa-"+t,r&&"fa-"+r,i&&"fa-fw",s&&"fa-border",c&&"fa-pull-"+c,a&&"fa-spin",u&&"fa-pulse",o&&"fa-rotate-"+o,l&&"fa-flip-"+l,h&&"fa-inverse");return Object(E.jsx)("i",{className:d})}}]),n}(v.Component),ke=(v.Component,function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.iconClass,r=e.text,a=e.textClass;return Object(E.jsxs)("div",{className:"py-2",children:[Object(E.jsx)(Oe,{className:n,name:t,fixWidth:!0}),Object(E.jsx)("span",{className:a,children:r})]})}}]),n}(v.Component)),ge=Object(D.a)(de=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).fileInput=void 0,r.fileName=null,r.upload=function(){var e=Object(c.a)(f.a.mark((function e(t){var n,a,i,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.m.resUrl+"upload",t||(t=r.buildFormData()),e.prev=2,(a=new Headers).append("Access-Control-Allow-Origin","*"),e.next=7,fetch(n,{method:"POST",body:t,headers:a});case 7:return i=e.sent,e.next=10,i.json();case 10:return s=e.sent,e.abrupt("return",":"+s.res.id);case 14:return e.prev=14,e.t0=e.catch(2),console.error("%s %s",n,e.t0),e.abrupt("return",{error:e.t0});case 18:return e.prev=18,e.finish(18);case 20:case"end":return e.stop()}}),e,null,[[2,14,18,20]])})));return function(t){return e.apply(this,arguments)}}(),r.onFilesChange=function(e){var t=r.props.onFilesChange;t&&t(e);for(var n=e.target.files,a=n.length,i=[],s=0;s<a;s++)i.push(n.item(s).name);r.fileName=i.join(", ")},Object(b.p)(Object(O.a)(r),{fileName:b.q}),r}return Object(o.a)(n,[{key:"buildFormData",value:function(){var e=this.props.maxSize;void 0===e||e<=0?e=1e11:e*=1024;for(var t=this.fileInput.files,n=new FormData,r=t.length,a=0;a<r;a++){var i=t[a];if(i.size>e)return null;n.append("files[]",i,i.name)}return n}},{key:"getFile0",value:function(){return this.fileInput.files[0]}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.multiple,a=t.label;return Object(E.jsxs)("div",{children:[Object(E.jsxs)("label",{className:"btn btn-outline-success",children:[a||"\u9009\u62e9\u6587\u4ef6",Object(E.jsx)("input",{className:n,ref:function(t){return e.fileInput=t},onChange:this.onFilesChange,type:"file",name:"file",multiple:r,style:{display:"none"}})]}),"\xa0",this.fileName]})}}]),n}(v.Component))||de;function xe(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments.length>2?arguments[2]:void 0;for(r=r||["B","K","M","G","TB"];(t=r.shift())&&e>1024;)e/=1024;return("B"===t?e:e.toFixed(void 0===n?2:n))+t}var we=1600,Ie=400,Ce=Object(D.a)((pe=ve=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).imgBaseSize=void 0,r.imageTypes=void 0,r.suffix=void 0,r.resUploader=void 0,r.file=null,r.desImgWidth=null,r.desImgHeight=null,r.desImgSize=null,r.srcImgWidth=null,r.srcImgHeight=null,r.isChanged=!1,r.resId=null,r.enableUploadButton=!1,r.srcImage=null,r.desImage=null,r.fileError=null,r.uploaded=!1,r.onFileChange=function(e){if(r.fileError=void 0,r.uploaded=!1,r.enableUploadButton=e.target.files.length>0,r.enableUploadButton){r.file=e.target.files[0];var t=r.file.name.lastIndexOf(".");if(t>=0&&(r.suffix=r.file.name.substr(t+1).toLowerCase()),r.imageTypes.indexOf(r.suffix)<0)return void(r.fileError="\u56fe\u7247\u7c7b\u578b\u5fc5\u987b\u662f ".concat(r.imageTypes.join(", ")," \u4e2d\u7684\u4e00\u79cd"));var n=new FileReader;n.readAsDataURL(r.file),n.onload=Object(c.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.srcImage=n.result,e.t0=r.suffix,e.next="svg"===e.t0?7:4;break;case 4:return e.next=6,r.setSize(r.props.size);case 6:return e.abrupt("break",11);case 7:return r.imgBaseSize=Ie,r.desImgSize=r.srcImage.length,r.desImage=r.srcImage,e.abrupt("break",11);case 11:case"end":return e.stop()}}),e)})))}},r.compress=function(){return new Promise((function(e,t){var n=new Image;n.src=r.srcImage,n.onload=function(){var t=n.width,a=n.height;r.srcImgWidth=t,r.srcImgHeight=a;var i,s,c=t/a;r.imgBaseSize<0||t<=r.imgBaseSize&&a<=r.imgBaseSize?(i=t,s=a):c<0?s=(i=r.imgBaseSize)/c:i=(s=r.imgBaseSize)*c,r.desImgWidth=Math.round(i),r.desImgHeight=Math.round(s);var u=document.createElement("canvas"),o=u.getContext("2d"),l=document.createAttribute("width");l.nodeValue=String(i);var h=document.createAttribute("height");h.nodeValue=String(s),u.setAttributeNode(l),u.setAttributeNode(h),o.drawImage(n,0,0,i,s);var d=u.toDataURL("image/"+r.suffix,.7),f=r.convertBase64UrlToBlob(d);r.desImgSize=f.size,r.desImgSize>3145728&&(r.fileError="\u56fe\u7247\u5927\u4e8e3M\uff0c\u65e0\u6cd5\u4e0a\u4f20",r.enableUploadButton=!1),e(d)}}))},r.upload=Object(c.a)(f.a.mark((function e(){var t,n,a,i,s,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.resUploader){e.next=2;break}return e.abrupt("return");case 2:return t=new FormData,n=r.convertBase64UrlToBlob(r.desImage),t.append("image",n,r.file.name),e.next=7,r.resUploader.upload(t);case 7:if("object"!==typeof(a=e.sent)){e.next=24;break}i=a.error,s=typeof i,e.t0=s,e.next="undefined"===e.t0?14:"string"===e.t0?16:"object"===e.t0?18:20;break;case 14:return c="error: undefined",e.abrupt("break",22);case 16:return c=i,e.abrupt("break",22);case 18:return c=i.message,e.abrupt("break",22);case 20:return c=String(c),e.abrupt("break",22);case 22:return r.fileError="error: "+s+" - "+c,e.abrupt("return");case 24:r.resId=a,r.isChanged=r.resId!==r.props.id,r.uploaded=!0;case 27:case"end":return e.stop()}}),e)}))),r.onSaved=function(){var e=r.props.onSaved;e&&e(r.resId)},r.showOrgImage=function(){y.m.nav.push(Object(E.jsx)(a.a,{header:"\u539f\u56fe",children:Object(E.jsx)("div",{className:"p-3 text-center",children:Object(E.jsx)(ue,{className:"h-min-4c",style:{maxWidth:"100%"},src:r.srcImage})})}))},Object(b.p)(Object(O.a)(r),{file:b.q,desImgWidth:b.q,desImgHeight:b.q,desImgSize:b.q,srcImgWidth:b.q,srcImgHeight:b.q,isChanged:b.q,resId:b.q,enableUploadButton:b.q,srcImage:b.q,desImage:b.q,fileError:b.q,uploaded:b.q}),r.resId=e.id,r.imageTypes=e.imageTypes||n.imageTypes,r}return Object(o.a)(n,[{key:"setSize",value:function(){var e=Object(c.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="sm"===e.t0?3:"md"===e.t0?5:"lg"===e.t0?7:"xl"===e.t0?9:"raw"===e.t0?11:3;break;case 3:return this.imgBaseSize=180,e.abrupt("break",13);case 5:return this.imgBaseSize=Ie,e.abrupt("break",13);case 7:return this.imgBaseSize=800,e.abrupt("break",13);case 9:return this.imgBaseSize=we,e.abrupt("break",13);case 11:return this.imgBaseSize=-1,e.abrupt("break",13);case 13:return e.next=15,this.compress();case 15:this.desImage=e.sent;case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"convertBase64UrlToBlob",value:function(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),a=r.length,i=new Uint8Array(a);a--;)i[a]=r.charCodeAt(a);return new Blob([i],{type:n})}},{key:"levelDiv",value:function(){var e=this;if(!this.props.size){var t=[{caption:"\u5c0f\u56fe",size:"sm"}];if((this.srcImgHeight>Ie||this.srcImgWidth>Ie)&&t.push({caption:"\u4e2d\u56fe",size:"md"}),(this.srcImgHeight>800||this.srcImgWidth>800)&&t.push({caption:"\u5927\u56fe",size:"lg"}),(this.srcImgHeight>we||this.srcImgWidth>we)&&(t.push({caption:"\u8d85\u5927\u56fe",size:"xl"}),t.push({caption:"\u539f\u56fe",size:"raw"})),!(t.length<2))return Object(E.jsx)("div",{children:t.map((function(t,n){var r=t.caption,a=t.size;return Object(E.jsxs)("label",{className:"me-3",children:[Object(E.jsx)("input",{type:"radio",name:"size",onChange:function(){return e.setSize(a)},defaultChecked:0===n})," ",r]},n)}))})}}},{key:"render",value:function(){var e=this,t=this.props.label,n=Object(E.jsx)("button",{className:"btn btn-sm btn-success align-self-center me-2",disabled:!this.isChanged,onClick:this.onSaved,children:"\u4fdd\u5b58"});return Object(E.jsx)(a.a,{header:t||"\u66f4\u6539\u56fe\u7247",right:n,children:Object(E.jsxs)("div",{className:"my-3 px-3 py-3 bg-white",children:[Object(E.jsxs)("div",{children:[Object(E.jsxs)("div",{className:"mb-3",children:[Object(E.jsx)(ge,{ref:function(t){return e.resUploader=t},multiple:!1,maxSize:2048,label:"\u9009\u62e9\u56fe\u7247\u6587\u4ef6",onFilesChange:this.onFileChange}),Object(E.jsxs)("div",{className:"small text-muted",children:["\u652f\u6301 ",this.imageTypes.join(", ")," \u683c\u5f0f\u56fe\u7247\u3002"]}),this.fileError&&Object(E.jsx)("div",{className:"text-danger",children:this.fileError})]}),Object(E.jsx)(ye,{left:!0===this.uploaded?Object(E.jsx)("div",{className:"text-success p-2",children:"\u4e0a\u4f20\u6210\u529f\uff01"}):this.file&&this.desImgSize>0&&Object(E.jsxs)("div",{className:"mb-3 d-flex align-items-end",children:[Object(E.jsxs)("div",{className:"me-5",children:[this.levelDiv(),Object(E.jsxs)("div",{children:["\u5206\u8fa8\u7387\uff1a",this.desImgWidth," x ",this.desImgHeight,"\xa0 \xa0 \u6587\u4ef6\u5927\u5c0f\uff1a",xe(this.desImgSize)]})]}),Object(E.jsx)("button",{className:"btn btn-primary",disabled:!this.enableUploadButton,onClick:this.upload,children:"\u4e0a\u4f20"})]}),right:this.desImage&&Object(E.jsxs)("button",{className:"btn btn-link btn-sm text-right mb-3",onClick:this.showOrgImage,children:["\u539f\u56fe\u5927\u5c0f: ",xe(this.file.size),Object(E.jsx)("br",{}),"\u5206\u8fa8\u7387\uff1a",this.srcImgWidth," x ",this.srcImgHeight]})})]}),Object(E.jsx)("div",{className:"text-center",style:{border:!0===this.uploaded?"2px solid green":"1px dotted gray",padding:"8px"},children:Object(E.jsx)(ue,{className:"h-min-4c",style:{maxWidth:"100%"},src:this.desImage})})]})})}}]),n}(v.Component),ve.imageTypes=["gif","jpg","jpeg","png","svg","apng","bmp","ico","cur","tiff","tif","webp"],fe=pe))||fe,Ne=(Object(D.a)((je=me=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).suffix=void 0,r.resUploader=void 0,r.content=null,r.file=null,r.fileSize=null,r.isChanged=!1,r.resId=null,r.enableUploadButton=!1,r.fileError=null,r.uploaded=!1,r.uploading=!1,r.onFileChange=function(e){if(r.fileError=void 0,r.uploaded=!1,r.enableUploadButton=e.target.files.length>0,r.enableUploadButton){r.file=e.target.files[0];var t=r.file.name.lastIndexOf(".");if(t>=0&&(r.suffix=r.file.name.substr(t+1).toLowerCase()),n.audioTypes.indexOf(r.suffix)<0)return void(r.fileError="\u97f3\u9891\u7c7b\u578b\u5fc5\u987b\u662f ".concat(n.audioTypes.join(", ")," \u4e2d\u7684\u4e00\u79cd"));var a=new FileReader;a.readAsDataURL(r.file),a.onload=Object(c.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.content=a.result,r.fileSize=r.content.length;case 2:case"end":return e.stop()}}),e)})))}},r.upload=Object(c.a)(f.a.mark((function e(){var t,n,a,i,s,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.resUploader){e.next=2;break}return e.abrupt("return");case 2:return r.uploading=!0,t=new FormData,n=r.convertBase64UrlToBlob(r.content),t.append("image",n,r.file.name),e.next=8,r.resUploader.upload(t);case 8:if("object"!==typeof(a=e.sent)){e.next=25;break}i=a.error,s=typeof i,e.t0=s,e.next="undefined"===e.t0?15:"string"===e.t0?17:"object"===e.t0?19:21;break;case 15:return c="error: undefined",e.abrupt("break",23);case 17:return c=i,e.abrupt("break",23);case 19:return c=i.message,e.abrupt("break",23);case 21:return c=String(c),e.abrupt("break",23);case 23:return r.fileError="error: "+s+" - "+c,e.abrupt("return");case 25:r.resId=a,r.isChanged=r.resId!==r.props.id,r.uploaded=!0;case 28:case"end":return e.stop()}}),e)}))),r.onSaved=function(){var e=r.props.onSaved;e&&e(r.resId)},Object(b.p)(Object(O.a)(r),{content:b.q,file:b.q,fileSize:b.q,isChanged:b.q,resId:b.q,enableUploadButton:b.q,fileError:b.q,uploaded:b.q,uploading:b.q}),r.resId=e.id,r}return Object(o.a)(n,[{key:"convertBase64UrlToBlob",value:function(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),a=r.length,i=new Uint8Array(a);a--;)i[a]=r.charCodeAt(a);return new Blob([i],{type:n})}},{key:"render",value:function(){var e=this,t=this.props.label,r=Object(E.jsx)("button",{className:"btn btn-sm btn-success align-self-center me-2",disabled:!this.isChanged,onClick:this.onSaved,children:"\u4fdd\u5b58"});return Object(E.jsxs)(a.a,{header:t||"\u66f4\u6539\u6587\u4ef6",right:r,children:[Object(E.jsx)("div",{className:"my-3 px-3 py-3 bg-white",children:Object(E.jsx)("div",{children:Object(E.jsxs)("div",{className:"mb-3",children:[Object(E.jsx)(ge,{ref:function(t){return e.resUploader=t},multiple:!1,maxSize:2048,label:"\u9009\u62e9\u97f3\u9891\u6587\u4ef6",onFilesChange:this.onFileChange}),Object(E.jsxs)("div",{className:"small text-muted",children:["\u652f\u6301 ",n.audioTypes.join(", ")," \u683c\u5f0f\u3002"]}),this.fileError&&Object(E.jsx)("div",{className:"text-danger",children:this.fileError})]})})}),Object(E.jsx)(ye,{left:!0===this.uploaded?Object(E.jsx)("div",{className:"text-success p-2",children:"\u4e0a\u4f20\u6210\u529f\uff01"}):!0===this.uploading?Object(E.jsx)("div",{className:"m-3",children:Object(E.jsx)(oe,{})}):this.file&&this.content&&Object(E.jsxs)("div",{className:"m-3",children:[Object(E.jsxs)("div",{className:"mb-3",children:["\u6587\u4ef6\u5927\u5c0f\uff1a",xe(this.fileSize)]}),Object(E.jsx)("button",{className:"btn btn-primary",disabled:!this.enableUploadButton,onClick:this.upload,children:"\u4e0a\u4f20"})]})})]})}}]),n}(v.Component),me.audioTypes=["mp3","wav"],be=je)),function(){function e(t,n,r,a,i){Object(u.a)(this,e),this.edit=void 0,this.name=void 0,this._itemSchema=void 0,this._uiItem=void 0,this.value=void 0,this.label=void 0,this.newValue=void 0,this.error=null,this.isChanged=!1,Object(b.p)(this,{error:b.q,isChanged:b.q}),this.edit=t,this._itemSchema=n,this._uiItem=r,this.value=i;var s=n.name;this.name=s,this.label=a}return Object(o.a)(e,[{key:"itemSchema",get:function(){return this._itemSchema}},{key:"uiItem",get:function(){return this._uiItem}},{key:"editInRow",get:function(){return!1}},{key:"init",value:function(){}},{key:"start",value:function(){var e=Object(c.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.internalStart();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"end",value:function(){var e=Object(c.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.internalEnd();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderContent",value:function(){var e,t,n,r=this,a=this._itemSchema,i=a.name,s=a.type,c=this._uiItem;if(void 0===c)t=i;else{t=c.label,n=c.labelHide;var u=c.Templet;if(void 0!==u)"function"===typeof u?void 0!==this.value&&(e=u(this.value)):e={templet:u};else if(void 0!==this.value)switch(c.widget){case"radio":case"select":var o=c.list;e=Object(E.jsx)("b",{children:o.find((function(e){return e.value===r.value})).title});break;case"id":e=Object(E.jsxs)("b",{children:["no templet for ",i,"=",this.value]})}}if(void 0===e)if("image"===s)e=Object(E.jsx)(ue,{className:"w-4c h-4c",src:this.value});else e=this.value?Object(E.jsx)("b",{children:this.value}):Object(E.jsxs)("small",{className:"text-muted",children:["[",!0===n?t:"\u65e0","]"]});return e}},{key:"internalEnd",value:function(){var e=Object(c.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y.m.nav.pop(1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"verifyValue",value:function(){if(void 0!==this.uiItem){var e=this.uiItem.rules;if(void 0!==e){var t=this.newValue;if(Array.isArray(e)){var n,r=Object(s.a)(e);try{for(r.s();!(n=r.n()).done;){var a=i(n.value);if(void 0!==a){this.error=a;break}}}catch(c){r.e(c)}finally{r.f()}}else this.error=i(e)}}function i(e,n){var r=e(t);if(void 0!==r)return"object"!==typeof r?r:JSON.stringify(r)}}}]),e}()),_e=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i,s){var c;return Object(u.a)(this,n),(c=t.call(this,e,r,a,i,s)).resId=null,c.page=Object(D.a)((function(e){var t=e.resolve,n=c.uiItem&&c.uiItem.size;return Object(E.jsx)(Ce,{label:"\u66f4\u6539"+c.label,id:c.resId,size:n,onSaved:function(e){t(e)}})})),Object(b.p)(Object(O.a)(c),{resId:b.q}),c}return Object(o.a)(n,[{key:"uiItem",get:function(){return this._uiItem}},{key:"internalStart",value:function(){var e=Object(c.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.resId=this.value,e.abrupt("return",new Promise((function(e,n){y.m.nav.push(v.createElement(t.page,{resolve:e,reject:n}),(function(){return n()}))})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Ne),Ae=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a,i){var s;return Object(u.a)(this,n),(s=t.call(this,e,r,a,i)).input=void 0,s.imageSrc=null,s.onClick=Object(c.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new _e(void 0,s.itemSchema,s.ui,s.ui.label,s.value),e.next=3,t.start();case 3:return null!==(n=e.sent)&&(s.setValue(n),s.imageSrc=n),e.next=7,t.end();case 7:case"end":return e.stop()}}),e)}))),s.observerRender=Object(D.a)((function(){var e,t=["bg-white p-1 d-flex justify-content-center"];return s.readOnly||s.disabled||(t.push("cursor-pointer"),e=s.onClick),Object(E.jsx)("div",{className:j()(t),onClick:e,children:Object(E.jsx)(ue,{src:s.imageSrc,className:"w-4c h-4c"})})})),Object(b.p)(Object(O.a)(s),{imageSrc:b.q}),s}return Object(o.a)(n,[{key:"ui",get:function(){return this._ui}},{key:"init",value:function(){Object(g.a)(Object(x.a)(n.prototype),"init",this).call(this),this.imageSrc=this.value}},{key:"render",value:function(){return v.createElement(this.observerRender)}}]),n}(P),Se=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputs={},e}return Object(o.a)(n,[{key:"ui",get:function(){return this._ui}},{key:"setElementValue",value:function(e){for(var t in this.inputs){var n=this.inputs[t];n.checked=e===n.value}}},{key:"setReadOnly",value:function(e){for(var t in this.readOnly=e,this.inputs)this.inputs[t].readOnly=e}},{key:"setDisabled",value:function(e){for(var t in this.disabled=e,this.inputs)this.inputs[t].disabled=e}}]),n}(P),qe=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e,t=this.ui,n=t.valuesView,r=t.wrapClassName;if(void 0===n)return Object(E.jsx)(E.Fragment,{children:"valuesView must be defined"});!0===this.context.isRow&&(e=this.context.rowKey);var a=j()(this.className,"py-0"),i=this.name;void 0!==e&&(i+="-"+e);var s={className:a,inputName:i,wrapClassName:r,onInputChange:this.onInputChange};return n.renderRadios(this.defaultValue,s)}}]),n}(Se),Te=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).defaultArr=void 0,e.onInputChange=function(t){var n=[];for(var r in e.inputs){var a=e.inputs[r];!0===a.checked&&n.push(a.value)}e.changeValue(n.join("|"),!0)},e}return Object(o.a)(n,[{key:"init",value:function(){Object(g.a)(Object(x.a)(n.prototype),"init",this).call(this);var e=this.defaultValue;if("string"===typeof e)this.defaultArr=e.split("|").map((function(e){return Number(e)}));else this.defaultArr=[]}},{key:"render",value:function(){var e=this.ui,t=e.valuesView,n=e.wrapClassName;if(void 0===t)return Object(E.jsx)(E.Fragment,{children:"valuesView must be defined"});var r={className:j()(this.className,"py-0"),inputs:this.inputs,wrapClassName:n,onInputChange:this.onInputChange};return t.renderChecks(this.defaultValue,r)}}]),n}(Se),De=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onClick=Object(c.a)(f.a.mark((function t(){var n,r,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(r=null===(n=e.ui)||void 0===n?void 0:n.pick)){t.next=4;break}return alert("no pick defined!"),t.abrupt("return");case 4:return t.next=6,r.pick();case 6:a=t.sent,Object(b.s)((function(){e.setDataValue(a),e.clearError(),e.clearContextError(),e.checkRules()}));case 8:case"end":return t.stop()}}),t)}))),e}return Object(o.a)(n,[{key:"ui",get:function(){return this._ui}},{key:"setReadOnly",value:function(e){this.readOnly=e}},{key:"setDisabled",value:function(e){this.disabled=e}},{key:"setValue",value:function(e){Object(g.a)(Object(x.a)(n.prototype),"setValue",this).call(this,e)}},{key:"render",value:function(){var e,t=null===(e=this.ui)||void 0===e?void 0:e.pick;return void 0===t?Object(E.jsx)("span",{children:"no pick defined!"}):Object(E.jsx)("div",{className:this.className+" cursor-pointer ",onClick:this.onClick,children:t.ref()})}}]),n}(P),Ee={dataTypes:["integer","number","string"],widget:F},Pe={id:{dataTypes:["id"],widget:Z},pick:{dataTypes:["id"],widget:De},text:Ee,string:Ee,textarea:{dataTypes:["string"],widget:R},password:{dataTypes:["string"],widget:L},date:{dataTypes:["date"],widget:W},datetime:{dataTypes:["date"],widget:$},time:{dataTypes:["date"],widget:K},month:{dataTypes:["date"],widget:z},select:{dataTypes:["integer","number","string","date","boolean"],widget:X},url:{dataTypes:["string"],widget:V},email:{dataTypes:["string"],widget:B},number:{dataTypes:["integer","number"],widget:M},updown:{dataTypes:["integer","number"],widget:U},color:{},checkbox:{dataTypes:["boolean","integer","number"],widget:H},image:{dataTypes:["string"],widget:Ae},checkboxes:{},radio:{dataTypes:["integer","number","string","date","boolean"],widget:Q},tagSingle:{dataTypes:["integer"],widget:qe},tagMulti:{dataTypes:["string"],widget:Te},range:{dataTypes:["integer"],widget:J},button:{dataTypes:["button","submit"],widget:te}};function Fe(e,t,n,r){if(void 0===e)return null;if(void 0!==t){var a,i=t.name,s=t.type;if("arr"===s){var c=e.getItemSchema(i);return Object(E.jsx)(ce,{parentContext:e,arrSchema:c,children:n})}var u=e.getUiItem(i);if(void 0===u)a=f(s);else{var o=u.widget;if(!0===u.hiden)return null;switch(o){default:if(void 0!==o){var l=Pe[o];if(!l)throw new Error("unknown widget ".concat(o));a=l.widget}void 0===a&&(a=f(s));break;case"custom":a=u.WidgetClass;break;case"group":return Object(E.jsx)("span",{children:"impletment group"})}}var h=e.widgets,d=h[i];return d||((d=new a(e,t,r,n)).init(),h[i]=d),Object(E.jsx)(d.container,{})}function f(e){switch(e){default:case"string":return F;case"id":return Z;case"integer":return U;case"number":return M;case"date":return W;case"boolean":return H;case"button":case"submit":return te}}}n(51);var Re=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;Object(u.a)(this,n),(r=t.call(this,e)).schema=void 0,r.itemSchemas=void 0,r.uiSchema=void 0,r.res=void 0,r.formContext=void 0,r.disposer=void 0,r.data=void 0,r.Container=void 0,r.FieldContainer=void 0,r.FieldClass=void 0,r.ButtonClass=void 0,r.watch=function(){void 0!==r.props.formData&&r.calcSelectOrDelete()},r.DefaultContainer=function(e){return Object(E.jsx)("form",{className:j()(r.props.className),onSubmit:function(e){return e.preventDefault()},children:e})},r.DefaultFieldContainer=function(e,t){var n=r.props,a=n.fieldLabelSize,i=n.fieldLabelAlign;if(a>0){var s;if(null===e)a=0;else{var c;switch(i){case"right":c="text-sm-right";break;case"center":c="text-sm-center"}s=Object(E.jsx)("label",{className:j()("col-sm-"+a,"col-form-label",c),children:e})}var u="col-sm-"+(12-a);return Object(E.jsxs)("div",{className:"mb-3 row",children:[s,Object(E.jsx)("div",{className:u,children:t})]})}return Object(E.jsxs)("div",{className:"mb-3",children:[null===e?null:Object(E.jsx)("label",{className:"col-form-label",children:e}),t]})},r.DefaultFieldClass=void 0,r.DefaultButtonClass="text-center py-2",r.DefaultRes=Object(y.i)(y.e),r.ArrContainer=function(e,t){return Object(E.jsxs)("div",{children:[Object(E.jsx)("div",{className:j()("small text-muted text-center bg-light py-1 px-3 mt-4 mb-1"),children:e}),t]})},r.RowContainer=function(e){var t=j()({"py-3":!0});return Object(E.jsx)("div",{className:t,children:e})},r.RowSeperator=Object(E.jsx)("div",{className:"border border-gray border-top"});var a=e.schema,i=e.uiSchema,c=e.Container,o=e.FieldContainer,l=e.FieldClass,h=e.ButtonClass,d=e.res;r.Container=c||r.DefaultContainer,r.FieldContainer=o||r.DefaultFieldContainer,r.FieldClass=void 0!==l&&""!==l&&null!==l?l:r.DefaultFieldClass,r.res=d||r.DefaultRes,r.ButtonClass=h||r.DefaultButtonClass,r.schema=a,r.itemSchemas={};var f,v=Object(s.a)(r.schema);try{for(v.s();!(f=v.n()).done;){var p=f.value;r.itemSchemas[p.name]=p}}catch(m){v.e(m)}finally{v.f()}return r.uiSchema=i,r.disposer=Object(b.h)(r.watch),r.data={},r}return Object(o.a)(n,[{key:"renderContent",value:function(){var e=this;this.initData(this.props.formData);var t,n=this.props.children;return void 0!==n?(this.formContext=new ie(this,!0),Object(E.jsx)(E.Fragment,{children:n})):(void 0!==this.uiSchema&&(t=this.uiSchema.Templet),void 0!==t?(this.formContext=new ie(this,!0),"function"===typeof t?t(this.data):t):(this.formContext||(this.formContext=new ie(this,!1)),Object(E.jsx)(E.Fragment,{children:this.schema.map((function(t,r){return Object(E.jsx)(v.Fragment,{children:Fe(e.formContext,t,n)},r)}))})))}},{key:"initData",value:function(e){if(void 0===e&&(e={}),void 0!==this.uiSchema){var t=this.uiSchema.items;if(void 0!==t)for(var n in t){var r=t[n].defaultValue;void 0!==r&&void 0===e[n]&&(e[n]=r)}}var a,i=Object(s.a)(this.schema);try{for(i.s();!(a=i.n()).done;){var c=a.value;this.initDataItem(c,this.data,e)}}catch(u){i.e(u)}finally{i.f()}}},{key:"initDataItem",value:function(e,t,n){var r=e.name,a=e.type;if("button"!==a)if("arr"===a){var i=e,c=i.arr;if(void 0!==c){var u,o=i.itemSchemas={},l=Object(s.a)(c);try{for(l.s();!(u=l.n()).done;){var h=u.value;o[h.name]=h}}catch(g){l.e(g)}finally{l.f()}var d=n[r];void 0===d?d=[]:!1===Array.isArray(d)&&(d=[d]);var f,v=[],p=Object(s.a)(d);try{for(p.s();!(f=p.n()).done;){var m,j=f.value,y={$source:j,$isSelected:j.$isSelected,$isDeleted:j.$isDeleted},O=Object(s.a)(c);try{for(O.s();!(m=O.n()).done;){var k=m.value;this.initDataItem(k,y,j)}}catch(g){O.e(g)}finally{O.f()}v.push(y)}}catch(g){p.e(g)}finally{p.f()}t[r]=Object(b.q)(v)}}else t[r]=n[r]}},{key:"calcSelectOrDelete",value:function(){var e,t=Object(s.a)(this.schema);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.arrItemOperated(n)}}catch(r){t.e(r)}finally{t.f()}}},{key:"arrItemOperated",value:function(e){var t=e.name;if("arr"===e.type&&void 0!==this.data){var n=this.data[t];if(void 0!==n){var r,a=e.arr,i=Object(s.a)(n);try{for(i.s();!(r=i.n()).done;){var c=r.value,u=c.$source;if(void 0!==u){var o=u.$isSelected,l=u.$isDeleted;c.$isSelected=o,c.$isDeleted=l;var h,d=Object(s.a)(a);try{for(d.s();!(h=d.n()).done;){var f=h.value;this.arrItemOperated(f)}}catch(v){d.e(v)}finally{d.f()}}}}catch(v){i.e(v)}finally{i.f()}}}}},{key:"componentDidMount",value:function(){var e=this.props.beforeShow;void 0!==e&&e(this.formContext)}},{key:"componentWillUnmount",value:function(){void 0!==this.disposer&&this.disposer()}},{key:"render",value:function(){var e=this.renderContent();return Object(E.jsxs)(se.Provider,{value:this.formContext,children:[v.createElement(this.formContext.renderErrors),this.Container(e)]})}},{key:"buttonClick",value:function(){var e=Object(c.a)(f.a.mark((function e(t){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.formContext.checkRules(),!0!==this.formContext.hasError){e.next=3;break}return e.abrupt("return");case 3:if(void 0!==(n=this.formContext.form.props.onButtonClick)){e.next=7;break}return alert("you should define form onButtonClick"),e.abrupt("return");case 7:return e.next=9,n(t,this.formContext);case 9:if(void 0!==(r=e.sent)){e.next=12;break}return e.abrupt("return");case 12:this.formContext.setError(t,r);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(v.Component),Le=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.children,r=this.context;if(void 0===r)return Object(E.jsx)("span",{className:"text-danger",children:"!only in Form!"});var a=r.getItemSchema(t),i=Fe(r,a,n,this.props);return void 0===i?Object(E.jsxs)("span",{className:"text-danger",children:["!!",t," is not defined!!"]}):i}}]),n}(v.Component);Le.contextType=se;var Ve,Be=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onChange=function(t){e.newValue=t.target.value;var n=e.value;e.isChanged=e.newValue!==n},e.onBlur=function(t){e.verifyValue()},e.onFocus=function(){e.error=void 0},e.page=Object(D.a)((function(t){var n=t.resolve,r=function(){if(e.verifyValue(),!e.error){var t=e.newValue;n(t)}},i=Object(E.jsx)("button",{className:"btn btn-sm btn-success align-self-center me-2",disabled:!e.isChanged,onClick:r,children:"\u4fdd\u5b58"}),s=e.inputOptions(),c=s.type,u=s.max,o=s.min,l=s.step;return Object(E.jsx)(a.a,{header:e.label,right:i,children:Object(E.jsxs)("div",{className:"m-3",children:[Object(E.jsx)("input",{type:c,onChange:e.onChange,onKeyDown:function(e){13===e.keyCode&&r()},onBlur:e.onBlur,onFocus:e.onFocus,className:"form-control",defaultValue:e.value,min:o,max:u,step:l}),e.uiItem&&Object(E.jsx)("div",{className:"small muted m-2",children:e.uiItem.placeholder}),e.error&&Object(E.jsx)("div",{className:"text-danger",children:e.error})]})})})),e}return Object(o.a)(n,[{key:"uiItem",get:function(){return this._uiItem}},{key:"internalStart",value:function(){var e=Object(c.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=v.createElement(t.page,{resolve:e,reject:n});y.m.nav.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"inputOptions",value:function(){return{type:"text"}}}]),n}(Ne),Me=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onChange=function(t){e.newValue=t;var n=e.value;e.isChanged=e.newValue!==n},e.page=Object(D.a)((function(t){var n=t.resolve,r=e.itemSchema.name,i=e.uiItem.list,s=Object(E.jsx)("button",{className:"btn btn-sm btn-success align-self-center me-2",disabled:!e.isChanged,onClick:function(){e.verifyValue(),e.error||n(e.newValue)},children:"\u4fdd\u5b58"}),c=i?i.map((function(t,n){var a=t.title,i=t.value;return Object(E.jsx)("div",{className:"col",children:Object(E.jsxs)("label",{className:"px-3 py-2 cursor-pointer",children:[Object(E.jsx)("input",{name:r,type:"radio",value:i,onClick:function(){return e.onChange(i)},defaultChecked:i===e.value})," ",a||i," \xa0"]})},n)})):Object(E.jsx)(E.Fragment,{children:"no list defined"});return Object(E.jsx)(a.a,{header:"\u66f4\u6539"+e.label,right:s,children:Object(E.jsx)("div",{className:"m-3",children:Object(E.jsx)("div",{className:"row row-cols-2 row-cols-sm-3 row-cols-md-4",children:c})})})})),e}return Object(o.a)(n,[{key:"uiItem",get:function(){return this._uiItem}},{key:"init",value:function(){void 0===this.value&&(this.value=void 0===this._uiItem?void 0:this._uiItem.defaultValue)}},{key:"internalStart",value:function(){var e=Object(c.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=v.createElement(t.page,{resolve:e,reject:n});y.m.nav.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}(Ne),Ue=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onChange=function(t){e.newValue=t;var n=e.value;e.isChanged=e.newValue!==n},e.page=Object(D.a)((function(t){var n=t.resolve,r=e.uiItem.list,i=r?r.map((function(t,r){var a=t.title,i=t.value;return Object(E.jsx)("div",{className:"px-3 py-2 cursor-pointer bg-white mb-1",onClick:function(){e.onChange(i),n(e.newValue)},children:a||i},r)})):Object(E.jsx)(E.Fragment,{children:"no list defined"});return Object(E.jsx)(a.a,{header:"\u66f4\u6539"+e.label,children:Object(E.jsx)("div",{className:"my-3",children:i})})})),e}return Object(o.a)(n,[{key:"uiItem",get:function(){return this._uiItem}},{key:"internalStart",value:function(){var e=Object(c.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=v.createElement(t.page,{resolve:e,reject:n});y.m.nav.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}(Ne),We=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onChange=function(t){e.newValue=t;var n=e.value;e.isChanged=e.newValue!==n},e.page=Object(D.a)((function(t){return Object(E.jsx)(a.a,{header:"\u66f4\u6539"+e.label,children:"ddd"})})),e}return Object(o.a)(n,[{key:"uiItem",get:function(){return this._uiItem}},{key:"internalStart",value:function(){var e=Object(c.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(f.a.mark((function e(n,r){var a,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(a=t.uiItem.pickId)){e.next=4;break}return alert("IdItemEdit.pickId = undefined"),e.abrupt("return");case 4:return e.next=6,a(void 0,void 0,t.value);case 6:i=e.sent,t.onChange(i.id),n(i);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"internalEnd",value:function(){var e=Object(c.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}(Ne),$e=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).inputs={},e.inputType=void 0,e.page=Object(D.a)((function(t){var n=t.resolve,r=Object(E.jsx)("button",{className:"btn btn-sm btn-success align-self-center me-2",disabled:!e.isChanged,onClick:function(){e.verifyValue(),e.error||n(e.newValue)},children:"\u4fdd\u5b58"});return Object(E.jsx)(a.a,{header:"\u66f4\u6539"+e.label,right:r,children:Object(E.jsx)("div",{className:"p-3",children:e.renderInputs()})})})),e}return Object(o.a)(n,[{key:"uiItem",get:function(){return this._uiItem}},{key:"init",value:function(){void 0===this.value&&(this.value=void 0===this._uiItem?void 0:this._uiItem.defaultValue)}},{key:"internalStart",value:function(){var e=Object(c.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=v.createElement(t.page,{resolve:e,reject:n});y.m.nav.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"renderContent",value:function(){var e=this.uiItem.valuesView;return void 0===e?Object(g.a)(Object(x.a)(n.prototype),"renderContent",this).call(this):e.render(this.value)}}]),n}(Ne),Ke=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="radio",e.onInputChange=function(t){var n=t.currentTarget;if(!1!==n.checked){e.newValue=Number(n.value);var r=e.value;e.isChanged=e.newValue!==r}},e}return Object(o.a)(n,[{key:"renderInputs",value:function(){var e=this.uiItem.valuesView,t={inputs:this.inputs,onInputChange:this.onInputChange};return e.renderRadios(this.value,t)}}]),n}($e),ze=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="checkbox",e.onInputChange=function(t){var n=[];for(var r in e.inputs){var a=e.inputs[r];!0===a.checked&&n.push(a.value)}e.newValue=n.join("|");var i=e.value;e.isChanged=e.newValue!==i},e}return Object(o.a)(n,[{key:"renderInputs",value:function(){var e=this.uiItem.valuesView,t={inputs:this.inputs,onInputChange:this.onInputChange};return e.renderChecks(this.value,t)}}]),n}($e),He=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onChange=function(t){e.newValue=t.target.value;var n=e.value;e.isChanged=e.newValue!==n},e.onBlur=function(t){e.verifyValue()},e.onFocus=function(){e.error=void 0},e.page=Object(D.a)((function(t){var n=t.resolve,r=Object(E.jsx)("button",{className:"btn btn-sm btn-success align-self-center me-2",disabled:!e.isChanged,onClick:function(){if(e.verifyValue(),!e.error){var t=e.newValue;n(t)}},children:"\u4fdd\u5b58"});return Object(E.jsx)(a.a,{header:e.label,right:r,children:Object(E.jsxs)("div",{className:"m-3",children:[Object(E.jsx)("textarea",{onChange:e.onChange,onKeyDown:function(e){},onBlur:e.onBlur,onFocus:e.onFocus,className:"form-control",defaultValue:e.value,rows:6}),e.uiItem&&Object(E.jsx)("div",{className:"small muted m-2",children:e.uiItem.placeholder}),e.error&&Object(E.jsx)("div",{className:"text-danger",children:e.error})]})})})),e}return Object(o.a)(n,[{key:"uiItem",get:function(){return this._uiItem}},{key:"internalStart",value:function(){var e=Object(c.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=v.createElement(t.page,{resolve:e,reject:n});y.m.nav.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}(Ne),Xe=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).input=void 0,e.onChange=function(t){e.newValue=e.getValue(t.target.checked);var n=e.value;e.isChanged=e.newValue!==n,e.edit.onItemChanged(Object(O.a)(e),e.newValue)},e}return Object(o.a)(n,[{key:"uiItem",get:function(){return this._uiItem}},{key:"editInRow",get:function(){return!0}},{key:"internalStart",value:function(){var e=Object(c.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.input){e.next=2;break}return e.abrupt("return");case 2:if(void 0!==this.uiItem){e.next=5;break}return e.abrupt("return",this.input.checked);case 5:return t=this.input.checked,e.abrupt("return",this.getValue(t));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"end",value:function(){var e=Object(c.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"renderContent",value:function(){var e,t=this,n=this.uiItem.readOnly,r=!0===n;return!0!==n&&(e=this.onChange),Object(E.jsx)("input",{ref:function(e){return t.input=e},type:"checkbox",defaultChecked:this.value,disabled:r,onChange:e})}},{key:"getValue",value:function(e){var t=this.uiItem,n=t.trueValue,r=t.falseValue;return!0===e?null===n||void 0===n||n:null!==r&&void 0!==r&&r}}]),n}(Ne),Ge=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"inputOptions",value:function(){var e,t,n;return this._uiItem&&(e=this._uiItem.min,t=this._uiItem.max,n=this._uiItem.step),{type:"range",min:e,max:t,step:n}}}]),n}(Be),Qe=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"inputOptions",value:function(){var e,t,n;return this._uiItem&&(e=this._uiItem.min,t=this._uiItem.max,n=this._uiItem.step),{type:"number",min:e,max:t,step:n}}}]),n}(Be),Je=Object(D.a)(Ve=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;Object(u.a)(this,n),(r=t.call(this,e)).defaultSepClassName="border-top edit-sep-light-gray",r.defaultRowContainerClassName="d-flex px-3 py-2 bg-white align-items-center",r.topBorder=void 0,r.bottomBorder=void 0,r.rowContainerClassName=void 0,r.sep=void 0,r.uiSchema=void 0,r.rowClick=function(){var e=Object(c.a)(f.a.mark((function e(t){var n,a,i,s,c,u,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=3;break}return alert("item has no edit"),e.abrupt("return");case 3:if(n=t.itemSchema,a=t.uiItem,i=t.value,!0!==t.editInRow){e.next=6;break}return e.abrupt("return");case 6:if(s=r.props,c=s.onItemChanged,u=s.onItemClick,!0!==s.stopEdit){e.next=9;break}return e.abrupt("return");case 9:if(!0!==(null===a||void 0===a?void 0:a.readOnly)){e.next=11;break}return e.abrupt("return");case 11:if(void 0===u){e.next=15;break}return e.next=14,u(n,a,i);case 14:return e.abrupt("return");case 15:if(void 0!==t){e.next=18;break}return alert("undefined: let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);"),e.abrupt("return");case 18:return e.prev=18,e.next=21,t.start();case 21:if((o=e.sent)===i){e.next=30;break}if(r.props.data[n.name]=o,void 0!==c){e.next=28;break}alert("".concat(n.name," value changed, new: ").concat(o,", pre: ").concat(i)),e.next=30;break;case 28:return e.next=30,c(n,o,i);case 30:return e.next=32,t.end();case 32:e.next=38;break;case 34:e.prev=34,e.t0=e.catch(18),console.log("no value changed"),console.error(e.t0);case 38:case"end":return e.stop()}}),e,null,[[18,34]])})));return function(t){return e.apply(this,arguments)}}();var a=e.topBorderClassName,i=e.bottomBorderClassName,s=e.sepClassName,o=e.rowContainerClassName,l=e.uiSchema;return r.topBorder=Object(E.jsx)("div",{className:a||r.defaultSepClassName}),r.bottomBorder=Object(E.jsx)("div",{className:i||r.defaultSepClassName}),r.rowContainerClassName=o||r.defaultRowContainerClassName,r.sep=Object(E.jsx)("div",{className:s||r.defaultSepClassName}),r.uiSchema=l&&l.items||{},r}return Object(o.a)(n,[{key:"render",value:function(){var e,t=this,n=this.props.schema;return Object(E.jsxs)("div",{children:[this.topBorder,n.map((function(n,r){var a,i,s=t.props.stopEdit,u=n.name,o=void 0===t.uiSchema?void 0:t.uiSchema[u];void 0!==o&&(a=o.label||u,i=o.labelHide);var l=t.props.data[u],h=function(e,t,n,r,a){var i,s;if(void 0!==n)switch(n.widget){default:break;case"id":s=We;break;case"text":s=Be;break;case"textarea":s=He;break;case"image":s=_e;break;case"select":s=Ue;break;case"range":s=Ge;break;case"number":case"updown":s=Qe;break;case"checkbox":s=Xe;break;case"radio":i=new Me(e,t,n,r,a);break;case"tagSingle":i=new Ke(e,t,n,r,a);break;case"tagMulti":i=new ze(e,t,n,r,a)}if(void 0===i){if(void 0===s)switch(t.type){case"string":s=Be;break;case"image":s=_e;break;case"boolean":s=Xe;break;case"number":case"integer":s=Ge}if(void 0===s)return;i=new s(e,t,n,r,a)}return i.init(),i}(t,n,o,a,l),d=t.rowContainerClassName,p=h.editInRow;!1===p&&!0!==s&&(p=!1),!1===p&&(d+=" cursor-pointer");var b,m=!0===n.required&&Object(E.jsx)("span",{className:"text-danger",children:"*"}),j="flex-fill d-flex ";!0===i?b=void 0:(b=Object(E.jsxs)("div",{children:[a," ",m]}),j+="justify-content-end");var y=Object(E.jsxs)(v.Fragment,{children:[e,Object(E.jsxs)("div",{className:"d-flex align-items-center"+d,onClick:Object(c.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.rowClick(h);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),children:[b,Object(E.jsx)("div",{className:j,children:void 0===h?void 0:h.renderContent()}),!1===p&&Object(E.jsx)("div",{className:"w-2c text-right",children:Object(E.jsx)("i",{className:"fa fa-angle-right"})})]})]},r);return e=t.sep,y})),this.bottomBorder]})}},{key:"onItemChanged",value:function(){var e=Object(c.a)(f.a.mark((function e(t,n){var r,a,i,s,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.itemSchema,a=t.uiItem,i=t.value,this.props.data[r.name]=n,s=this.props,c=s.onItemChanged,!0!==s.stopEdit){e.next=5;break}return e.abrupt("return");case 5:if(!0!==(null===a||void 0===a?void 0:a.readOnly)){e.next=7;break}return e.abrupt("return");case 7:if(void 0!==c){e.next=11;break}alert("".concat(r.name," value changed, new: ").concat(n,", pre: ").concat(i)),e.next=13;break;case 11:return e.next=13,c(r,n,i);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(v.Component))||Ve;var Ye,Ze,et,tt=function(){function e(t){Object(u.a)(this,e),this.list=void 0,this.render=void 0,this.list=t,Object(b.p)(this,{loading:b.i})}return Object(o.a)(e,[{key:"isPaged",get:function(){var e=this.list.props.items;return null!==e&&void 0!==e&&!1===Array.isArray(e)}},{key:"items",get:function(){var e=this.list.props.items;return null===e?null:void 0!==e?!0===Array.isArray(e)?e:e.items:void 0}},{key:"loading",get:function(){var e=this.list.props.items;if(null===e)return!1;if(void 0===e)return!0;var t=e;return void 0!==t.items&&t.loading}},{key:"selectedItems",get:function(){}},{key:"dispose",value:function(){}},{key:"renderContent",value:function(e,t){var n=this.list.props.item.render;return void 0===n?Object(E.jsx)("div",{className:"px-3 py-2",children:JSON.stringify(e)}):n(e,t)}}]),e}(),nt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).render=function(t,n){var r=e.list.props.item,a=r.className,i=r.key,s=r.onClick;return Object(E.jsx)("li",{className:j()("va-row-clickable",a),onClick:function(){return s&&s(t)},children:e.renderContent(t,n)},void 0===i?n:i(t))},e}return Object(o.a)(n)}(tt),rt=n(13),at=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).render=function(t,n){var r=e.list.props.item,a=r.className,i=r.key;if("string"===typeof t){var s=j()("va-list-gap","px-3","pt-1");return Object(E.jsx)("li",{className:s,children:t},Object(rt.j)())}return Object(E.jsx)("li",{className:j()(a),children:e.renderContent(t,n)},void 0===i?n:i(t))},e}return Object(o.a)(n)}(tt),it=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e))._items=null,r.inputItems={},r.buildItems=function(){var e,t=r.list.props,n=t.items,a=t.isItemSelected,i=t.selectedItems,s=t.compare;if(void 0!==n)if(null!==n)if(e=!0===Array.isArray(n)?n:n.items,a){var c=e.map((function(e){return{selected:a(e),item:e,labelId:Object(rt.j)()}}));r._items=c}else{var u;u=void 0===s?function(e,t){return e===t}:s;var o=e.map((function(e){return{selected:void 0!==i&&void 0!==i.find((function(t){return u(e,t)})),item:e,labelId:Object(rt.j)()}}));r._items=o}else r._items=null;else r._items=void 0},r.render=function(e,t){var n=r.list.props.item.key;return v.createElement(r.row,{item:e,index:t,key:void 0===n?t:n(e)})},r.row=Object(D.a)((function(e){var t=e.item,n=e.index,a=r.list.props.item.className,i=t.labelId,s=t.selected,c=t.item;return Object(E.jsx)("li",{className:j()(a),children:Object(E.jsxs)("div",{className:"d-flex align-items-center px-3",children:[Object(E.jsx)("input",{ref:function(e){e&&(r.inputItems[i]=e)},className:"",type:"checkbox",value:"",id:i,defaultChecked:s,onChange:function(e){r.onSelect(t,e.target.checked)}}),Object(E.jsx)("label",{className:"",style:{flex:1,marginBottom:0},htmlFor:i,children:r.renderContent(c,n)})]})})})),Object(b.p)(Object(O.a)(r),{_items:b.q}),r.buildItems(),r.listenArraySplice(),r}return Object(o.a)(n,[{key:"listenArraySplice",value:function(){var e,t=this,n=this.list.props.items;void 0!==n&&(null!==n&&(e=!0===Array.isArray(n)?n:n.items,!0===Object(b.m)(n)&&Object(b.r)(e,(function(e){if("splice"===e.type){var n,r=e.index,a=e.removedCount,i=e.added,s=i&&i.map((function(e){return{selected:!1,item:e,labelId:Object(rt.j)()}}));(n=t._items).splice.apply(n,[r,a].concat(Object(k.a)(s))),t.buildItems()}}),!0)))}},{key:"items",get:function(){return this._items}},{key:"checkAll",value:function(e){for(var t in this.inputItems)this.inputItems[t].checked=e;var n,r=Object(s.a)(this._items);try{for(r.s();!(n=r.n()).done;){n.value.selected=e}}catch(a){r.e(a)}finally{r.f()}}},{key:"selectAll",value:function(){this.checkAll(!0),this.list.props.item.onSelect(void 0,!0,this.anySelected)}},{key:"unselectAll",value:function(){this.checkAll(!1),this.list.props.item.onSelect(void 0,!1,this.anySelected)}},{key:"anySelected",get:function(){return this._items.some((function(e){return e.selected}))}},{key:"onSelect",value:function(e,t){e.selected=t,this.list.props.item.onSelect(e.item,t,this.anySelected)}},{key:"selectedItems",get:function(){return this._items.filter((function(e){return!0===e.selected})).map((function(e){return e.item}))}}]),n}(tt),st=(n(69),Object(D.a)((et=Ze=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).listBase=void 0,r.selectable=void 0,r._$scroll=function(e){console.log("############### items scroll to "+e)},r.buildBase(),r}return Object(o.a)(n,[{key:"buildBase",value:function(){var e=this.props.item,t=e.onClick;void 0!==e.onSelect?this.selectable=this.listBase=new it(this):this.listBase=void 0!==t?new nt(this):new at(this)}},{key:"componentDidUpdate",value:function(e,t){!1===I.a.isEqual(this.props.item,e.item)&&(this.buildBase(),this.forceUpdate())}},{key:"componentWillUnmount",value:function(){this.listBase.dispose()}},{key:"selectAll",value:function(){this.selectable&&this.selectable.selectAll()}},{key:"unselectAll",value:function(){this.selectable&&this.selectable.unselectAll()}},{key:"selectedItems",get:function(){return this.listBase.selectedItems}},{key:"render",value:function(){var e=this,t=this.props,r=t.className,a=t.header,i=t.footer,s=t.before,c=t.loading,u=t.none,o=t.onFocus;void 0===s&&(s="-"),void 0===c&&(c=function(){return Object(E.jsx)("i",{className:"fa fa-spinner fa-spin fa-2x fa-fw text-info"})}),void 0===u&&(u=n.res.none);var l,h,d,f=this.listBase,v=f.items,p=f.loading;function b(e,t){if(e)switch(typeof e){default:case"string":return Object(E.jsx)("li",{className:"va-list-"+t,children:e});case"function":return Object(E.jsx)("li",{className:"va-list-"+t,children:e()});case"object":return Object(E.jsx)("li",{children:e})}}return l=null===v?b(s,"before"):void 0===v?b(c,"loading"):0===v.length?b(u,"none"):v.map((function(t,n){return e.listBase.render(t,n)})),!0===p&&v&&(h=b(c,"loading")),void 0!==o&&(d=-1),Object(E.jsxs)("ul",{className:j()("va-list",r),onFocus:o,tabIndex:d,children:[b(a,"header"),l,h,b(i,"footer")]})}}]),n}(v.Component),Ze.res=Object(y.i)(y.f),Ye=et))||Ye),ct=(v.Component,{md:function(e,t){return"".concat(e,"-").concat(t)},ymd:function(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)},yesterday:"Yday",today:"Today",tomorrow:"Tmw",$zh:{md:function(e,t){return"".concat(e,"\u6708").concat(t,"\u65e5")},ymd:function(e,t,n){return"".concat(e,"\u5e74").concat(t,"\u6708").concat(n,"\u65e5")},yesterday:"\u6628\u5929",today:"\u4eca\u5929",tomorrow:"\u660e\u5929"},$en:{md:function(e,t){return"".concat(e,"-").concat(t)},ymd:function(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)},yesterday:"Yday",today:"Today",tomorrow:"Tmw"}});function ut(e){return ct[e]}function ot(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;switch(typeof e){default:n=e;break;case"string":n=new Date(e);break;case"number":n=new Date(1e3*e)}var a,i,s,c,u,o,l=new Date,h=n;a=l.getTime()-h.getTime();var d=h.getHours(),f=h.getMinutes();i=l.getDate(),s=h.getDate(),c=h.getMonth()+1,u=h.getFullYear(),o=l.getFullYear();var v=!1,p=a<-864e5?u===o?(v=!0,ut("md")(c,s)):(v=!0,ut("ymd")(u,c,s)):a<864e5?s!==i?(v=!0,ut(a<0?"tomorrow":"yesterday")):!0===t?(v=!0,""):ut("today"):u===o?ut("md")(c,s):ut("ymd")(u,c,s),b=d+(f<10?":0":":")+f;return!0===v||!0===r?p+" "+b:p}Object(y.l)(ct,ct);v.Component;var lt,ht=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props;return ot(e.date,!0,e.always)}}]),n}(v.Component),dt=function(){function e(){Object(u.a)(this,e)}return Object(o.a)(e,[{key:"setValues",value:function(e){}}]),e}(),ft=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(e){return Object(E.jsx)("div",{className:"",children:Object(E.jsx)("div",{className:"w-100",children:Object(E.jsx)("div",{style:{borderTop:"1px solid #f0f0f0"}})})},"_b_"+e)}}]),n}(dt),vt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this)).param=void 0,r.param=e,r}return Object(o.a)(n,[{key:"render",value:function(e){var t;switch(this.param){default:t="py-2";break;case"=":t="py-1";break;case"-":t="pb-1"}var n=j()(t);return Object(E.jsx)("div",{className:n},"_g_"+e)}}]),n}(dt),pt="justify-content-start",bt="justify-content-center",mt="justify-content-end",jt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r){var a;return Object(u.a)(this,n),(a=t.call(this)).gridProps=void 0,a._prop=void 0,a.content=void 0,a.col=void 0,a.gridProps=e,a._prop=r,a.col=!0===e.labelFixLeft?"col":"col-sm",a}return Object(o.a)(n,[{key:"prop",get:function(){return this._prop}},{key:"render",value:function(e){var t=this.prop,n=t.onClick,r=t.bk,a=j()({"cursor-pointer":void 0!==n,"bg-white":void 0===r,row:!0});return Object(E.jsxs)("div",{className:a,onClick:n,children:[this.renderLabel(),this.renderProp()]},e)}},{key:"renderLabel",value:function(){var e=this.prop.label;return void 0===e?null:Object(E.jsx)("label",{className:this.col+"-3 col-form-label",children:e})}},{key:"renderProp",value:function(){var e,t,n=this.prop.label;switch(this.gridProps.alignValue){case"left":e=pt;break;case"center":e=bt;break;case"right":e=mt}switch(this.prop.vAlign){case"top":t="align-items-start";break;default:case"center":t="align-items-center";break;case"bottom":t="align-items-end";break;case"stretch":t="align-items-stretch"}var r=this.col+(void 0===n?"-12":"-9"),a=j()(e,t,r,"d-flex");return Object(E.jsx)("div",{className:a,children:this.renderPropBody()})}},{key:"renderPropBody",value:function(){return Object(E.jsx)("div",{className:"form-control-plaintext",children:this.renderPropContent()})}},{key:"renderPropContent",value:function(){return this.content}}]),n}(dt),yt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"prop",get:function(){return this._prop}},{key:"setValues",value:function(e){this.content=void 0===e?void 0:e[this.prop.name]}}]),n}(jt),Ot=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"prop",get:function(){return this._prop}},{key:"setValues",value:function(e){this.content=void 0===e?void 0:e[this.prop.name]}}]),n}(jt),kt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"prop",get:function(){return this._prop}},{key:"setValues",value:function(e){if(void 0===e)this.content=void 0;else{var t=this.prop.list;this.content="string"===typeof t?e[t]:void 0}}},{key:"renderPropBody",value:function(){var e=this.prop,t=e.list,n=e.row,r="string"===typeof t?this.content:t;return void 0===r?Object(E.jsx)("div",{}):Object(E.jsx)("div",{className:"w-100",children:r.map((function(e,t){return Object(E.jsxs)(v.Fragment,{children:[0===t?null:Object(E.jsx)("div",{style:{width:"100%",borderBottom:"1px solid #f0f0f0"}}),v.createElement(n,e)]},t)}))})}}]),n}(jt),gt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"prop",get:function(){return this._prop}},{key:"renderPropBody",value:function(){return this.prop.component}},{key:"renderProp",value:function(){var e,t,n,r=this.prop,a=r.label,i=r.full;switch(this.gridProps.alignValue){case"left":e=pt;break;case"center":e=bt;break;case"right":e=mt}switch(this.prop.vAlign){case"top":t="align-items-start";break;default:case"center":t="align-items-center";break;case"bottom":t="align-items-end";break;case"stretch":t="align-items-stretch"}n=!0!==i?this.col+(void 0===a?"-12":"-9"):"w-100";var s=j()(e,t,n,"d-flex");return Object(E.jsx)("div",{className:s,children:this.renderPropBody()})}}]),n}(jt),xt=function(){function e(t,n){Object(u.a)(this,e),this.gridProps=void 0,this.props=void 0,this.rows=void 0,this.gridProps=t,this.props=n,this.buildRows()}return Object(o.a)(e,[{key:"buildRows",value:function(){this.rows=[];var e,t=!0,n=Object(s.a)(this.props);try{for(n.s();!(e=n.n()).done;){var r=e.value;if("string"===typeof r)this.rows.push(new vt(r)),t=!0;else{t||this.rows.push(new ft);var a=void 0;switch(r.type){default:continue;case"string":a=new yt(this.gridProps,r);break;case"number":a=new Ot(this.gridProps,r);break;case"list":a=new kt(this.gridProps,r);break;case"component":a=new gt(this.gridProps,r)}this.rows.push(a),t=!1}}}catch(i){n.e(i)}finally{n.f()}}},{key:"setValues",value:function(e){var t,n=Object(s.a)(this.rows);try{for(n.s();!(t=n.n()).done;){t.value.setValues(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"render",value:function(){return this.rows.map((function(e,t){return e.render(String(t))}))}}]),e}(),wt=Object(D.a)(lt=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.rows,r=e.values,a=new xt(this.props,n);a.setValues(r);var i=j()("container-fluid",t);return Object(E.jsx)("div",{className:i,children:a.render()})}}]),n}(v.Component))||lt,It=(v.Component,function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).input=void 0,e.button=void 0,e.key=null,e.onChange=function(t){e.key=t.target.value,void 0!==e.key&&(e.key=e.key.trim(),""===e.key&&(e.key=void 0)),console.log("key = "+e.key),!0===e.props.allowEmptySearch||(e.button.disabled=void 0===e.key||0===e.key.length)},e.onSubmit=function(){var t=Object(c.a)(f.a.mark((function t(n){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),null===e.key&&(e.key=e.props.initKey||""),!0===e.props.allowEmptySearch){t.next=7;break}if(e.key){t.next=5;break}return t.abrupt("return");case 5:e.input&&(e.input.disabled=!0),e.button&&(e.button.disabled=!0);case 7:return t.next=9,e.props.onSearch(e.key);case 9:e.input&&(e.input.disabled=!1),e.button&&(e.button.disabled=!1);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(o.a)(n,[{key:"clear",value:function(){this.input&&(this.input.value="")}},{key:"render",value:function(){var e,t,n=this,r=this.props,a=r.className,i=r.inputClassName,s=r.onFocus,c=r.label,u=r.placeholder,o=r.buttonText,l=r.maxLength;switch(r.size){default:case"sm":e="input-group-sm";break;case"md":e="input-group-md";break;case"lg":e="input-group-lg"}return!0===y.d.isMobile&&(t="off"),Object(E.jsx)("form",{className:a,onSubmit:this.onSubmit,autoComplete:t,children:Object(E.jsxs)("div",{className:j()("input-group",e),children:[c&&Object(E.jsx)("div",{className:"input-group-addon align-self-center me-2",children:c}),Object(E.jsx)("input",{ref:function(e){return n.input=e},onChange:this.onChange,type:"text",name:"key",onFocus:s,className:j()("form-control",i||"border-primary"),placeholder:u,defaultValue:this.props.initKey,maxLength:l}),Object(E.jsx)("div",{className:"input-group-append",children:Object(E.jsxs)("button",{ref:function(e){return n.button=e},className:"btn btn-primary",type:"submit",disabled:!0!==this.props.allowEmptySearch,children:[Object(E.jsx)("i",{className:"fa fa-search"}),Object(E.jsx)("i",{className:"fa"}),o]})})]})})}}]),n}(v.Component)),Ct=n(19),Nt=function(e){var t=e.href,n=e.children,r=e.className,a=e.onClick;if(!0===y.m.nav.isWebNav){var i=e.aClassName;if(!t)return Object(E.jsx)("span",{className:"text-danger",children:"Error: href not defined in Ax"});return Object(E.jsx)("a",Object(Ct.a)(Object(Ct.a)({},e),{},{className:j()(r,i),onClick:function(e){var n;return e.preventDefault(),a?n=a(e):(y.m.navigate(t),n=!1),n},children:n}))}var s=e.naClassName;return a||(a=function(){return!1===y.m.openSysPage(t)&&y.m.navigate(t),!1}),Object(E.jsx)("span",{className:j()(r,"cursor-pointer",s),onClick:a,children:n})};n(35);var _t=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).rules=[],r.value=null,r.input=void 0,r.requiredFlagElement=void 0,r.ruleMessage=null,Object(b.p)(Object(O.a)(r),{ruleMessage:b.q,onChange:b.g,onFocus:b.g,onBlur:b.g}),r.init(),r}return Object(o.a)(n,[{key:"placeholder",get:function(){}},{key:"max",get:function(){}},{key:"min",get:function(){}},{key:"maxLength",get:function(){}},{key:"className",get:function(){return this.props.className}},{key:"init",value:function(){var e=this.props,t=e.required,r=e.rules,a=e.requiredFlagElement,i=e.defaultValue;if(!0===t&&(void 0===a&&(a=n.defaultRequiredFlagElement),this.requiredFlagElement=a,this.rules.push(new S)),this.buildRules(),r){var c,u=Object(s.a)(r);try{for(u.s();!(c=u.n()).done;){var o=c.value;this.rules.push(new _(o))}}catch(l){u.e(l)}finally{u.f()}}this.value=i}},{key:"buildRules",value:function(){}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(e){var t=this.value;this.value=e,this.checkRules();var n=this.props.onValueChange;n&&e!==t&&n(e,t,this.ruleMessage)}},{key:"render",value:function(){var e=this,t=this.props,r=t.defaultValue,a=t.disabled,i=t.required,s=Object(E.jsx)("input",{ref:function(t){return e.input=t},className:this.className,type:this.type,placeholder:this.placeholder,defaultValue:r,defaultChecked:r,maxLength:this.maxLength,max:this.max,min:this.min,disabled:a,onChange:function(){return e.onChange()},onBlur:function(){return e.onBlur()},onFocus:function(){return e.onFocus()}});if(0===this.rules.length)return s;var c=this.props,u=c.containerClassName,o=c.ruleClassName;return Object(E.jsxs)("span",{className:u,children:[!0===i&&this.requiredFlagElement,s,p.a.createElement(Object(D.a)((function(){return Object(E.jsx)("span",{className:null!==o&&void 0!==o?o:n.defaultRuleClassName,children:e.ruleMessage})})))]})}},{key:"onChange",value:function(){var e=this.value,t=this.value=this.valueFromInput();this.checkRules();var n=this.props.onValueChange;n&&t!==e&&n(t,e,this.ruleMessage)}},{key:"valueFromInput",value:function(){}},{key:"checkRules",value:function(){var e,t=[],n=Object(s.a)(this.rules);try{for(n.s();!(e=n.n()).done;){e.value.check(t,this.value)}}catch(r){n.e(r)}finally{n.f()}this.ruleMessage=0===t.length?null:t[0]}},{key:"onBlur",value:function(){this.checkRules()}},{key:"onFocus",value:function(){this.ruleMessage=null}}]),n}(v.Component);_t.defaultRequiredFlagElement=Object(E.jsx)("span",{className:"mx-2 text-danger",children:"*"}),_t.defaultRuleClassName=" mx-2 text-danger ";var At=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"type",get:function(){return"number"}},{key:"max",get:function(){return this.props.max}},{key:"min",get:function(){return this.props.min}},{key:"className",get:function(){var e=this.props.className;return null===e?null:e||n.defaultClassName}},{key:"buildRules",value:function(){var e=this.props,t=e.max,n=e.min;this.rules.push(new q(void 0,n,t))}},{key:"parseValue",value:function(){return Number.parseFloat(this.input.value)}},{key:"valueFromInput",value:function(){var e=this.parseValue();if(!0!==isNaN(e))return e}}]),n}(_t);At.defaultClassName="form-control w-8c d-inline text-right";var St=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"type",get:function(){return"checkbox"}},{key:"className",get:function(){var e=this.props.className;return null===e?null:e||n.defaultClassName}},{key:"valueFromInput",value:function(){return this.input.checked}},{key:"onBlur",value:function(){}},{key:"onFocus",value:function(){}},{key:"setValue",value:function(e){Object(g.a)(Object(x.a)(n.prototype),"setValue",this).call(this,e),this.input.checked=e}}]),n}(_t);St.defaultClassName="form-check-input p-2"},,,function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return h})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var r=n(22),a=n.n(r),i=n(15),s="\x1b[41m%s\x1b[0m",c=0;function u(e,t,n,r){h("".concat(e.uqTsSrcPath,"/").concat(t,".").concat(n),r)}function o(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"ts",i=e.uqTsSrcPath,u="".concat(i,"/").concat(t,".").concat(r,".txt"),o="".concat(i,"/").concat(t,".").concat(r);a.a.existsSync(u)||a.a.existsSync(o)&&a.a.renameSync(o,u),a.a.writeFileSync(o,n),c=Date.now(),console.log(s,"".concat(o," is built"))}function l(e,t){a.a.writeFileSync(e,t),c=Date.now(),console.log(s,"".concat(e," is built"))}function h(e,t){!0!==a.a.existsSync(e)&&l(e,t)}function d(e){return Object(i.d)(e)}function f(e){var t,n,r=e.config;if(r){var a=r.dev,s=r.name,c=r.alias,u=a.name;t=a.alias||u,n=c||s}else{t=e.uqOwner,n=e.uqName}return{devName:Object(i.d)(t),uqName:Object(i.d)(n)}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return y}));var r=n(27),a=n(2),i=n(3),s=n(4),c=n(5),u=n(6),o=n(1),l=n.n(o),h=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).net=void 0,r.receiveHandlerId=void 0,r.dispose=function(){r.net.messageHub.unregisterReceiveHandler(r.receiveHandlerId),r.onDispose()},r.onMessageReceive=function(){var e=Object(a.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.onMessage(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r._resolve_$=void 0,r.net=e.net,r}return Object(s.a)(n,[{key:"onDispose",value:function(){}},{key:"internalStart",value:function(){var e=Object(a.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"user",get:function(){return this.tonwa.user}},{key:"isLogined",get:function(){var e=this.tonwa.user;return!!e&&e.id>0}},{key:"webNav",get:function(){}},{key:"getWebNav",value:function(){return this.webNav}},{key:"isWebNav",get:function(){return this.nav.isWebNav}},{key:"navigate",value:function(e){this.navigate(e)}},{key:"isMe",value:function(e){if(null===e)return!1;var t=this.user.id;switch(typeof e){default:return!1;case"string":return Number(e)===t;case"number":return e===t;case"object":return e.id===t}}},{key:"onMessage",value:function(e){}},{key:"beforeStart",value:function(){var e=Object(a.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"afterStart",value:function(){var e=Object(a.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"registerReceiveHandler",value:function(){this.receiveHandlerId=this.net.messageHub.registerReceiveHandler(this.onMessageReceive)}},{key:"start",value:function(){var e=Object(a.a)(l.a.mark((function e(t){var n,r,a,i=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.registerReceiveHandler(),e.next=3,this.beforeStart();case 3:if(!1!==e.sent){e.next=6;break}return e.abrupt("return");case 6:for(n=i.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=i[a];return e.next=9,this.internalStart.apply(this,[t].concat(r));case 9:return e.next=11,this.afterStart();case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isCalling",get:function(){return void 0!==this._resolve_$}},{key:"call",value:function(){var e=Object(a.a)(l.a.mark((function e(t){var n,r,i,s=this,c=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=c.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=c[i];return void 0===this._resolve_$&&(this._resolve_$=[]),e.abrupt("return",new Promise(function(){var e=Object(a.a)(l.a.mark((function e(n,a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s._resolve_$.push(n),e.next=3,s.start.apply(s,[t].concat(r));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"vCall",value:function(){var e=Object(a.a)(l.a.mark((function e(t,n){var r=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===this._resolve_$&&(this._resolve_$=[]),e.abrupt("return",new Promise(function(){var e=Object(a.a)(l.a.mark((function e(a,i){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r._resolve_$.push(a),e.next=3,new t(r).open(n);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"returnCall",value:function(e){if(void 0!==this._resolve_$){var t=this._resolve_$.pop();void 0!==t?t(e):alert("the Controller call already returned, or not called")}}}]),n}(r.a),d=n(8),f=n.n(d),v=n(11),p=n(18),b=n(9),m=n(0),j=function(){function e(t){Object(i.a)(this,e),this.tonwa=void 0,this.controller=void 0,this.nav=void 0,this.res=void 0,this.x=void 0,this.t=void 0;var n=t.getTonwa();this.tonwa=n,this.controller=t,this.nav=n.nav,this.t=t.t}return Object(s.a)(e,[{key:"isDev",get:function(){return b.d.isDevelopment}},{key:"isWebNav",get:function(){return this.nav.isWebNav}},{key:"navigate",value:function(e){this.tonwa.navigate(e)}},{key:"shallow",value:function(e){return this.controller.shallow(e)}},{key:"deep",value:function(e){return this.controller.deep(e)}},{key:"runInAction",value:function(e){return this.controller.runInAction(e)}},{key:"react",value:function(e){var t=Object(v.a)(e.bind(this));return Object(m.jsx)(t,{})}},{key:"renderVm",value:function(e,t){return new e(this.controller).render(t)}},{key:"openVPage",value:function(){var e=Object(a.a)(l.a.mark((function e(t,n,r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new t(this.controller).open(n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"event",value:function(){var e=Object(a.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.event(t,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"go",value:function(e,t,n){this.controller.go(e,t,n)}},{key:"openPage",value:function(e,t,n){var r=typeof t;"object"===r||"undefined"===r?this.controller.openPage(d.createElement(e,t),n):this.controller.openPage(Object(m.jsxs)(p.l,{header:"param type error",children:["View.openPage param must be object, but here is ",r]}),n)}},{key:"replacePage",value:function(e,t){this.controller.replacePage(d.createElement(e,t))}},{key:"openPageElement",value:function(e,t){this.controller.openPage(e,t)}},{key:"replacePageElement",value:function(e,t){this.controller.replacePage(e,t)}},{key:"backPage",value:function(){this.controller.backPage()}},{key:"closePage",value:function(e){this.controller.closePage(e)}},{key:"ceasePage",value:function(e){this.controller.ceasePage(e)}},{key:"removeCeased",value:function(){this.controller.removeCeased()}},{key:"regConfirmClose",value:function(e){this.controller.regConfirmClose(e)}},{key:"popToTopPage",value:function(){this.controller.popToTopPage()}}]),e}(),y=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).retOnClosePage=void 0,e}return Object(s.a)(n,[{key:"open",value:function(e,t){var n,r=this;this.init(e),void 0!==t&&(n=function(){return t(r.retOnClosePage)}),this.openPageElement(this.renderPage(),n)}},{key:"replaceOpen",value:function(e,t){var n,r=this;this.init(e),void 0!==t&&(n=function(){return t(r.retOnClosePage)}),this.replacePageElement(this.renderPage(),n)}},{key:"render",value:function(e){return this.init(e),this.renderPage()}},{key:"init",value:function(e){}},{key:"header",value:function(){return null}},{key:"right",value:function(){return null}},{key:"content",value:function(){return null}},{key:"footer",value:function(){return null}},{key:"logout",value:function(){return!1}},{key:"renderPage",value:function(){var e=this,t=this.header();t||(t=!1);var n=this.logout();return Object(m.jsx)(p.l,{header:t,right:this.right(),footer:this.footer(),onScroll:function(t){return e.onPageScroll(t)},onScrollTop:function(t){return e.onPageScrollTop(t)},onScrollBottom:function(t){return e.onPageScrollBottom(t)},back:this.back,headerClassName:this.headerClassName,className:this.className,afterBack:function(){return e.afterBack()},tabsProps:this.tabsProps,logout:n,webNav:this.controller.pageWebNav,children:this.content()})}},{key:"onPageScroll",value:function(e){}},{key:"onPageScrollTop",value:function(){var e=Object(a.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onPageScrollBottom",value:function(){var e=Object(a.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"afterBack",value:function(){}},{key:"back",get:function(){return"back"}},{key:"headerClassName",get:function(){return null}},{key:"className",get:function(){return null}},{key:"tabsProps",get:function(){return null}}]),n}(j),O=n(14),k=n(7);r.a},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r,a=n(3),i=n(4),s=n(5),c=n(6),u=n(8),o=n(11),l=n(40),h=n(41),d=n(30),f=n(9),v=n(0),p=Object(o.a)(r=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var r;Object(a.a)(this,n),(r=t.call(this,e)).tabsView=void 0;var i=e.tabsProps;return i&&(r.tabsView=new h.b(i)),r}return Object(i.a)(n,[{key:"renderHeader",value:function(e){var t=this.props,n=t.back,r=t.header,a=t.right,i=t.headerClassName,s=t.afterBack,c=t.logout;if(!1!==r){var u=!1,o={back:n,center:r,right:a,logout:c,className:i,afterBack:s};if(void 0!==e){u=!0;var h=e.renderPageHeader;if(h)return h(o)}else u=!1;return Object(l.a)(o,u)}}},{key:"renderFooter",value:function(e){var t=this.props.footer;if(t){var n=Object(v.jsx)("footer",{children:t});return e?n:Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("section",{className:"tv-page-footer",children:n}),n]})}}},{key:"componentDidCatch",value:function(e,t){}},{key:"render",value:function(){if(this.tabsView)return u.createElement(this.tabsView.content);var e,t=this.props,n=t.onScroll,r=t.onScrollTop,a=t.onScrollBottom,i=t.children,s=t.className,c=t.webNav;e=c||f.m.nav.pageWebNav;var o=Object(v.jsxs)(v.Fragment,{children:[this.renderHeader(e),Object(v.jsx)("main",{children:i}),this.renderFooter(e)]});return e?Object(v.jsx)(d.b,{onScroll:n,onScrollTop:r,onScrollBottom:a,className:s,webNav:e,children:o}):Object(v.jsx)(d.a,{onScroll:n,onScrollTop:r,onScrollBottom:a,className:s,children:o})}}]),n}(u.Component))||r},,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var r=n(38),a=n(32),i=function(){var t=function(){if(!e.window)return{};var t=/\+/g,n=/([^&=]+)=?([^&]*)/g,a=function(e){return decodeURIComponent(e.replace(t," "))},i=void 0;if(e.window){i=e.window.location.search.substring(1)}for(var s,c,u={};i;){var o=n.exec(i);if(!o)break;u[a(o[1])]=a(o[2])}var l,h,d=u.u||u.unit;if(d){var f=d.indexOf("-");if(f>=0){var v=d.charCodeAt(f+1),p="tT";s=v===p.charCodeAt(0)||v===p.charCodeAt(1),d=d.substr(0,f)}else s=!1;c="0"===d[0]?Number(d):Object(r.a)(d),!0===isNaN(c)&&(c=void 0)}else{var b;s=/(\btest\b)/i.test(document.location.href);var m=document.getElementById("unit");if(m)b=m.innerText;else if(m=document.getElementById("unit.json")){var j=m.innerHTML;if(j){var y=JSON.parse(j);b=null===y||void 0===y?void 0:y.unit}}b||(b="52"),b&&(c=Number.parseInt(b),!1===Number.isInteger(c)&&"\u767e\u7075\u5a01"===b&&(c=24)),c||(c=0)}var O=navigator.languages&&navigator.languages[0]||navigator.language;if(O){var k=O.split("-");l=k[0],k.length>1&&(h=k[1].toUpperCase())}else l="zh",h="CN";var g=-(new Date).getTimezoneOffset()/60,x=new RegExp("Android|webOS|iPhone|iPad|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile","i").test(navigator.userAgent);return{unit:c,testing:s,params:u,lang:l,district:h,timeZone:g,isMobile:x}}(),n=t.unit,i=t.testing,c=t.params,u=t.lang,o=t.district,l=t.timeZone,h=t.isMobile;return{unit:n,testing:i,buildingUq:!1,params:c,lang:u,district:o,timeZone:l,browser:s(),isDevelopment:!1,isMobile:h,localDb:new a.a(!0===i?"$$":"$"),setTimeout:function(t,n,r){for(var a,i=arguments.length,s=new Array(i>3?i-3:0),c=3;c<i;c++)s[c-3]=arguments[c];return(a=e).setTimeout.apply(a,[n,r].concat(s))},clearTimeout:function(t){e.clearTimeout(t)},setInterval:function(t,n){for(var r,a=arguments.length,i=new Array(a>2?a-2:0),s=2;s<a;s++)i[s-2]=arguments[s];return(r=e).setInterval.apply(r,[t,n].concat(i))},clearInterval:function(t){e.clearInterval(t)}}}();function s(){var t=e.navigator;if(t)return(t.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))>=0?"Opera":t.userAgent.indexOf("Chrome")>=0?"Chrome":t.userAgent.indexOf("Safari")>=0?"Safari":t.userAgent.indexOf("Firefox")>=0?"Firefox":t.userAgent.indexOf("MSIE")>=0||!0===!!document.documentMode?"IE":"Unknown"}}).call(this,n(31))},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),a=n(3),i=n(4),s=n(1),c=n.n(s),u=n(9),o=n(34),l=n(18),h=n(7),d=n(0),f=function(){function e(t){var n=this;Object(a.a)(this,e),this.tonwa=void 0,this.nav=void 0,this.res={},this.t=function(e){return n.internalT(e)||e},this.icon=void 0,this.label=void 0,this.isDev=u.d.isDevelopment,this.pageWebNav=void 0,this.topPageKey=void 0,this.tonwa=t,this.nav=t.nav}return Object(i.a)(e,[{key:"shallow",value:function(e){return Object(h.p)(e,this.buildReactiveProps(e,h.q.shallow))}},{key:"deep",value:function(e){return Object(h.p)(e,this.buildReactiveProps(e,h.q))}},{key:"buildReactiveProps",value:function(e,t){var n={};for(var r in e){switch(typeof e[r]){default:t=h.q;case"object":case"function":}n[r]=t}return n}},{key:"runInAction",value:function(e){return Object(h.s)(e)}},{key:"getTonwa",value:function(){return this.tonwa}},{key:"beforeInit",value:function(){}},{key:"afterInit",value:function(){}},{key:"internalInit",value:function(){this.beforeInit(),this.init.apply(this,arguments),this.pageWebNav=this.getPageWebNav(),this.afterInit()}},{key:"init",value:function(){}},{key:"internalT",value:function(e){var t,n;return null!==(t=null===(n=this.res)||void 0===n?void 0:n[e])&&void 0!==t?t:Object(o.a)(e)}},{key:"getPageWebNav",value:function(){}},{key:"setRes",value:function(e){if(void 0!==e){var t=u.j.$lang,n=u.j.$district;if(Object.assign(this.res,e),void 0!==t){var r=e[t];if(void 0!==r){Object.assign(this.res,r);var a=r[n];void 0!==a&&Object.assign(this.res,a)}}}}},{key:"getRes",value:function(){return this.res}},{key:"openVPage",value:function(){var e=Object(r.a)(c.a.mark((function e(t,n,r){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new t(this),e.next=3,a.open(n,r);case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"replaceVPage",value:function(){var e=Object(r.a)(c.a.mark((function e(t,n,r){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new t(this),e.next=3,a.replaceOpen(n,r);case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"renderView",value:function(e,t){return new e(this).render(t)}},{key:"event",value:function(){var e=Object(r.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onEvent(t,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEvent",value:function(){var e=Object(r.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"msg",value:function(e){alert(e)}},{key:"errorPage",value:function(e,t){this.openPage(Object(d.jsx)(l.l,{header:"App error!",children:Object(d.jsx)("pre",{children:"string"===typeof t?t:t.message})}))}},{key:"openPage",value:function(e,t){var n;void 0!==t&&(n=function(){t(void 0)}),this.nav.push(e,n)}},{key:"replacePage",value:function(e,t){this.nav.replace(e,t)}},{key:"backPage",value:function(){this.nav.back(!1)}},{key:"closePage",value:function(e){this.nav.pop(e)}},{key:"ceasePage",value:function(e){this.nav.ceaseTop(e)}},{key:"go",value:function(e,t,n){this.go(e,t,n)}},{key:"removeCeased",value:function(){this.nav.removeCeased()}},{key:"regConfirmClose",value:function(e){this.nav.regConfirmClose(e)}},{key:"startAction",value:function(){this.topPageKey=this.nav.topKey()}},{key:"TopKey",get:function(){return this.topPageKey}},{key:"SetTopKey",value:function(e){this.topPageKey=e}},{key:"popToTopPage",value:function(){this.nav.popTo(this.topPageKey)}},{key:"confirm",value:function(){var e=Object(r.a)(c.a.mark((function e(t){var n=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r.a)(c.a.mark((function e(a,i){var s,u,o,h,f,v,p,b;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=t.caption,u=t.message,o=t.ok,h=t.yes,f=t.no,v=t.classNames,p=function(e){n.closePage(),a(e)},b=[],void 0!==o&&b.push(Object(d.jsx)("button",{className:"btn btn-primary me-3",onClick:function(){return p("ok")},children:o},"ok")),void 0!==h&&b.push(Object(d.jsx)("button",{className:"btn btn-success me-3",onClick:function(){return p("yes")},children:h},"yes")),void 0!==f&&b.push(Object(d.jsx)("button",{className:"btn btn-outline-danger me-3",onClick:function(){return p("no")},children:f},"no")),n.openPage(Object(d.jsx)(l.l,{header:s||"\u8bf7\u786e\u8ba4",back:"close",children:Object(d.jsxs)("div",{className:v||"rounded bg-white m-5 p-3 border",children:[Object(d.jsx)("div",{className:"d-flex align-items-center justify-content-center",children:u}),Object(d.jsx)("div",{className:"mt-3 d-flex align-items-center justify-content-center",children:b})]})})),n.nav.regConfirmClose(Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(void 0),e.abrupt("return",!0);case 2:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}()},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var r=n(2),a=n(5),i=n(6),s=n(3),c=n(4),u=n(1),o=n.n(u),l=n(8),h=n.n(l),d=n(0),f=function(){function e(t){Object(s.a)(this,e),this.el=void 0,this.el=t}return Object(c.a)(e,[{key:"scrollToTop",value:function(){var e=this;setTimeout((function(){return e.el.scrollTo(0,0)}),20)}},{key:"scrollToBottom",value:function(){var e=this;setTimeout((function(){return e.el.scrollTo(0,e.el.scrollTop+e.el.offsetHeight)}),20)}}]),e}(),v=100,p=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).bottomTime=0,e.topTime=0,e.div=void 0,e.refDiv=function(t){t?(e.div=t,e.div.addEventListener("resize",e.onResize)):e.div&&e.div.removeEventListener("resize",e.onResize)},e.onResize=function(e){console.error("div resize")},e.onScroll=function(){var t=Object(r.a)(o.a.mark((function t(n){var r,a,i,s,c,u,l,h;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.props,a=r.onScroll,i=r.onScrollTop,s=r.onScrollBottom,a&&a(n),c=n.target,u=new f(c),c.scrollTop<30&&void 0!==i&&(l=(new Date).getTime())-e.topTime>v&&(e.topTime=l,i(u).then((function(e){if(!0===e){var t=c.scrollHeight,n=200;n>t&&(n=t),c.scrollTop=n}}))),c.scrollTop+c.offsetHeight>c.scrollHeight-30&&void 0!==s&&(h=(new Date).getTime())-e.bottomTime>v&&(e.bottomTime=h,s(u));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(c.a)(n,[{key:"eachChild",value:function(e,t){var n=this,r=e.props;if(void 0!==r){var a=r.children;void 0!==a&&h.a.Children.forEach(a,(function(e,r){var a=e._$scroll;a&&a(t),console.log(e.toString()),n.eachChild(e,t)}))}}}]),n}(h.a.Component),b=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.style;return Object(d.jsx)("div",{ref:this.refDiv,className:"tv-page",onScroll:this.onScroll,style:n,children:Object(d.jsx)("article",{className:t,children:this.props.children})})}}]),n}(p),m=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e,t,n=this.props,r=n.className,a=n.style,i=n.webNav,s=i.navHeader,c=i.navRawHeader,u=i.navFooter,o=i.navRawFooter;return c?e=c:s&&(e=Object(d.jsx)("header",{children:Object(d.jsx)("main",{children:s})})),o?t=o:u&&(t=Object(d.jsx)("footer",{children:Object(d.jsx)("main",{children:u})})),Object(d.jsxs)("div",{ref:this.refDiv,className:"tv-page-webnav",onScroll:this.onScroll,style:a,children:[e,Object(d.jsx)("article",{className:r,children:this.props.children}),t]})}}]),n}(p)},,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var r=n(10),a=n(5),i=n(6),s=n(3),c=n(4),u=new(function(){function t(){Object(s.a)(this,t),this.ls=void 0,this.ls=e.localStorage}return Object(c.a)(t,[{key:"getItem",value:function(e){var t;return this.ls?null===(t=this.ls)||void 0===t?void 0:t.getItem(e):null}},{key:"setItem",value:function(e,t){var n;null===(n=this.ls)||void 0===n||n.setItem(e,t)}},{key:"removeItem",value:function(e){var t;null===(t=this.ls)||void 0===t||t.removeItem(e)}}]),t}()),o=function(){function e(t,n){Object(s.a)(this,e),this.local=void 0,this.key=void 0,this.local=t,this.key=n}return Object(c.a)(e,[{key:"get",value:function(){try{var e=this.local.getItem(this.key);if(null===e)return;if(void 0===e)return;return JSON.parse(e)}catch(t){return void this.local.removeItem(this.key)}}},{key:"set",value:function(e){var t=JSON.stringify(e,(function(e,t){if("_tuid"!==e)return t}));this.local.setItem(this.key,t)}},{key:"remove",value:function(e){void 0===e?this.local.removeItem(this.key):this.local.removeLocal(e)}},{key:"child",value:function(e){return this.local.child(e)}},{key:"arr",value:function(e){return this.local.arr(e)}},{key:"map",value:function(e){return this.local.map(e)}}]),e}(),l=function(){function e(t){Object(s.a)(this,e),this.caches=void 0,this.locals=void 0,this.name=void 0,this.name=t,this.caches={},this.locals={}}return Object(c.a)(e,[{key:"getItem",value:function(e){var t=this.keyForGet(e);if(void 0!==t)return u.getItem(t)}},{key:"setItem",value:function(e,t){var n=this.keyForSet(e);u.setItem(n,t)}},{key:"removeItem",value:function(e){var t=this.keyForSet(e);void 0!==t&&localStorage.removeItem(t)}},{key:"arr",value:function(e){var t=String(e),n=this.locals[t];if(void 0===n){var r=this.keyForSet(e);this.locals[t]=n=new h(r)}return n}},{key:"map",value:function(e){var t=String(e),n=this.locals[t];if(void 0===n){var r=this.keyForSet(e);this.locals[t]=n=new d(r)}return n}},{key:"removeLocal",value:function(e){var t=e.name,n=this.keyForRemove(t);if(void 0!==n){var r=this.locals[t];void 0===r?r=new h(n):this.locals[t]=void 0,r.removeAll()}}},{key:"child",value:function(e){var t=String(e),n=this.caches[t];return void 0!==n?n:this.caches[t]=new o(this,e)}}]),e}(),h=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).index=void 0;var a=u.getItem(r.name);return r.index=null===a?[]:a.split("\n").map((function(e){return Number(e)})),r}return Object(c.a)(n,[{key:"saveIndex",value:function(){u.setItem(this.name,this.index.join("\n"))}},{key:"keyForGet",value:function(e){if(!(this.index.indexOf(e)<0))return"".concat(this.name,".").concat(e)}},{key:"keyForSet",value:function(e){var t=this.index.indexOf(e);return t<0?(this.index.unshift(e),this.index.length>500&&this.index.pop()):(this.index.splice(t,1),this.index.unshift(e)),this.saveIndex(),"".concat(this.name,".").concat(e)}},{key:"keyForRemove",value:function(e){var t=this.index.indexOf(e);if(!(t<0))return this.index.splice(t,1),this.saveIndex(),"".concat(this.name,".").concat(e)}},{key:"removeAll",value:function(){var e,t=Object(r.a)(this.index);try{for(t.s();!(e=t.n()).done;){var n=e.value;u.removeItem("".concat(this.name,".").concat(n))}}catch(a){t.e(a)}finally{t.f()}u.removeItem(this.name),this.index.splice(0)}},{key:"item",value:function(e){return this.child(e)}}]),n}(l),d=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).index=void 0,r.max=void 0,r.max=0,r.index={};var a=u.getItem(r.name);null!==a&&a.split("\n").forEach((function(e){var t=e.indexOf("\t");if(!(t<0)){var n=e.substr(0,t),a=Number(e.substr(t+1));!0!==isNaN(a)&&(r.index[n]=a,a>r.max&&(r.max=a))}}));return r}return Object(c.a)(n,[{key:"saveIndex",value:function(){var e=[];for(var t in this.index){var n=this.index[t];void 0!==n&&e.push("".concat(t,"\t").concat(n))}u.setItem(this.name,e.join("\n"))}},{key:"keyForGet",value:function(e){var t=this.index[e];if(void 0!==t)return"".concat(this.name,".").concat(t)}},{key:"keyForSet",value:function(e){var t=this.index[e];return void 0===t&&(++this.max,t=this.max,this.index[e]=t,this.saveIndex()),"".concat(this.name,".").concat(t)}},{key:"keyForRemove",value:function(e){var t=this.index[e];if(void 0!==t)return this.index[e]=void 0,this.saveIndex(),"".concat(this.name,".").concat(t)}},{key:"removeAll",value:function(){for(var e in this.index)u.removeItem("".concat(this.name,".").concat(this.index[e])),this.index[e]=void 0;u.removeItem(this.name),this.max=0}},{key:"item",value:function(e){return this.child(e)}}]),n}(l)}).call(this,n(31))},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(2),a=n(3),i=n(4),s=n(5),c=n(6),u=n(1),o=n.n(u),l=n(8),h=n(9),d=n(18),f=n(0),v=1,p=["IE"],b=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var i;Object(a.a)(this,n),(i=t.call(this,e)).stack=void 0,i.waitCount=0,i.waitTimeHandler=void 0,i.isWebNav=!1,i.isHistoryBack=!1,i.navBack=function(){var e=Date.now();i.isHistoryBack=!0,i.back(!0),i.isHistoryBack=!1,console.log("///\\\\ ".concat(Date.now()-e,"ms backbutton pressed - nav level: ").concat(i.stack.length))},i.back=Object(r.a)(o.a.mark((function e(){var t,n,r,a,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(s.length>0&&void 0!==s[0])||s[0],n=i.stack,0!==(r=n.length)){e.next=5;break}return e.abrupt("return");case 5:if(1!==r){e.next=8;break}return window.self!==window.top&&window.top.postMessage({type:"pop-app"},"*"),e.abrupt("return");case 8:if(a=n[r-1],!0!==t||!a.confirmClose){e.next=17;break}return e.next=12,a.confirmClose();case 12:if(e.t0=e.sent,!0!==e.t0){e.next=15;break}i.pop();case 15:e.next=18;break;case 17:i.pop();case 18:case"end":return e.stop()}}),e)}))),i.backIcon=Object(f.jsx)("i",{className:"fa fa-angle-left"}),i.closeIcon=Object(f.jsx)("i",{className:"fa fa-close"}),i.pageWebNav=void 0,i.stack=[];var s=h.d.browser,c=p.findIndex((function(e){return e===s}))>=0;return i.state={notSupportedBrowser:c,stack:i.stack,wait:0},i}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.state.notSupportedBrowser){e.next=2;break}return e.abrupt("return");case 2:window.addEventListener("popstate",this.navBack);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"level",get:function(){return this.stack.length}},{key:"show",value:function(e,t){return this.clear(),this.push(e,t)}},{key:"push",value:function(e,t){this.removeCeased(),this.stack.length>0&&window.history.pushState("forward",null,null);var n=v++;return this.stack.push({key:n,view:e,ceased:!1,disposer:t}),this.refresh(),n}},{key:"replace",value:function(e,t){var n=void 0,r=this.stack;r.length>0&&(n=r.pop());var a=v++;return this.stack.push({key:a,view:e,ceased:!1,disposer:t}),void 0!==n&&this.dispose(n.disposer),this.refresh(),a}},{key:"ceaseTop",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.stack.length-1,n=0;n<e&&!(t<0);n++,t--){var r=this.stack[t];r.ceased=!0}}},{key:"pop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.stack,n=t.length;if(!(e<=0||n<=1)){n<e&&(e=n);for(var r=0,a=0;a<e&&0!==t.length;a++)this.popAndDispose(),++r;r>=n&&r--,this.refresh(),this.isHistoryBack}}},{key:"popTo",value:function(e){if(void 0!==e&&void 0!==this.stack.find((function(t){return t.key===e})))for(;this.stack.length>0;){var t=this.stack.length;if(this.stack[t-1].key===e)break;this.pop()}}},{key:"topKey",value:function(){var e=this.stack.length;if(0!==e)return this.stack[e-1].key}},{key:"removeCeased",value:function(){for(;;){var e=this.stack.length-1;if(e<0)break;if(!1===this.stack[e].ceased)break;var t=this.stack.pop().disposer;this.dispose(t)}this.refresh()}},{key:"popAndDispose",value:function(){this.removeCeased();var e=this.stack.pop();if(void 0!==e){var t=e.disposer;return this.dispose(t),this.removeCeased(),e}}},{key:"dispose",value:function(e){void 0!==e&&(void 0===this.stack.find((function(t){return t.disposer===e}))&&e())}},{key:"clear",value:function(){for(this.stack.length;this.stack.length>0;)this.popAndDispose()}},{key:"regConfirmClose",value:function(e){var t=this.stack,n=t.length;0!==n&&(t[n-1].confirmClose=e)}},{key:"confirmBox",value:function(e){return window.confirm(e)}},{key:"render",value:function(){var e=this.state,t=e.notSupportedBrowser,n=e.wait;if(!0===t)return Object(f.jsxs)("div",{className:"p-3 text-danger",children:[h.d.browser," not supported !"]});var r=this.state.stack,a=r.length-1,i=null;switch(n){case 1:i=Object(f.jsx)("div",{className:"va-wait va-wait1"});break;case 2:i=Object(f.jsx)("div",{className:"va-wait va-wait2",children:Object(f.jsx)(d.j,{})})}var s=!0===h.d.testing&&Object(f.jsx)("span",{className:"cursor-pointer position-fixed",style:{top:0,left:"0.2rem",zIndex:90001},children:Object(f.jsx)(d.d,{className:"text-warning",name:"info-circle"})});return Object(f.jsxs)(f.Fragment,{children:[r.map((function(e,t){var n=e.key,r=e.view;return Object(f.jsx)("div",{style:t<a?{visibility:"hidden",position:"absolute"}:void 0,children:r},n)})),i,null,s]})}},{key:"refresh",value:function(){this.setState({stack:this.stack})}},{key:"setIsWebNav",value:function(){this.isWebNav=!0,this.backIcon=Object(f.jsx)("i",{className:"fa fa-arrow-left"}),this.closeIcon=Object(f.jsx)("i",{className:"fa fa-close"})}},{key:"renderNavView",value:function(e,t){throw new Error("renderNavView")}}]),n}(l.Component)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(9);function a(e){return r.h[e]||e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(2),a=n(1),i=n.n(a);function s(e){return c.apply(this,arguments)}function c(){return(c=Object(r.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(null,45));case 2:return r=e.sent,e.abrupt("return",new r.CLogin(t));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e){return o.apply(this,arguments)}function o(){return(o=Object(r.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(0).then(n.bind(null,55));case 2:r=e.sent,new r.CRegister(t).start();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return h.apply(this,arguments)}function h(){return(h=Object(r.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(0).then(n.bind(null,55));case 2:r=e.sent,new r.CForget(t).start();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",a=r.charCodeAt(0),i=r.charCodeAt(9),s=r.charCodeAt(10),c=r.charCodeAt(35),u=r.charCodeAt(36),o=r.charCodeAt(61);function l(e){if(null===e)return null;if(void 0!==e){if("string"!==typeof e)return Number.NaN;var t=e.length;if(0===t)return Number.NaN;for(var n=0,r=0;r<t;r++){var l=e.charCodeAt(r),h=void 0;if(l<a)return Number.NaN;if(l<=i)h=l-a;else{if(l<s)return Number.NaN;if(l<=c)h=l-s+10;else{if(l<u)return Number.NaN;if(!(l<=o))return Number.NaN;h=l-u+36}}n*=62,n+=h}return n}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(3),a=n(4),i=n(5),s=n(6),c=n(2),u=n(1),o=n.n(u),l=n(8),h=n(9),d=n(0);function f(e,t){var n=function(){var t=Object(c.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.m.nav.back(!1);case 2:(n=e.afterBack)&&n();case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),r=h.m.nav.level>1||window.self!==window.top,a=e.back,i=e.right,s=e.center,u=e.logout,l=e.className,f=e.ex;if(!0!==t||a||i||s){var v,p;if(void 0!==u&&window.self===window.top&&("boolean"===typeof u&&!0===u||"function"===typeof u)){var b=h.m.user;if(void 0!==b){var m=b.nick,j=b.name;p=Object(d.jsxs)("div",{className:"d-flex align-items-center",children:[Object(d.jsx)("small",{className:"text-light",children:m||j}),Object(d.jsx)("div",{className:"ms-2 py-2 px-3 cursor-pointer",role:"button",onClick:function(){var t=function(){var t=Object(c.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"!==typeof(n=e.logout)){t.next=4;break}return t.next=4,n();case 4:return t.next=6,h.m.logout(void 0);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();h.m.showLogout(t)},children:Object(d.jsx)("i",{className:"fa fa-sign-out fa-lg"})})]})}}if(r)switch(e.back){case"none":v=void 0;break;default:case"back":v=Object(d.jsx)("nav",{onClick:n,children:h.m.nav.backIcon});break;case"close":v=Object(d.jsx)("nav",{onClick:n,children:h.m.nav.closeIcon})}window.self!==window.top&&console.log(document.location.href),void 0===v&&"string"===typeof s&&(s=Object(d.jsx)("div",{className:"px-3",children:s}));var y=(i||p)&&Object(d.jsxs)("aside",{children:[i," ",p]}),O=Object(d.jsxs)("header",{className:l,children:[Object(d.jsxs)("nav",{children:[v,Object(d.jsx)("div",{children:s}),y]}),f]});return!0===t?O:Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("section",{className:"tv-page-header",children:O}),O]})}}l.Component},function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return k}));var r,a,i=n(5),s=n(6),c=n(2),u=n(3),o=n(4),l=n(1),h=n.n(l),d=n(8),f=n(7),v=n(11),p=n(12),b=n.n(p),m=(n(65),n(30)),j=n(0),y=function(){function e(){Object(u.a)(this,e),this.loaded=!1,this.selected=!1,this.name=void 0,this.caption=void 0,this.contentBuilder=void 0,this.page=void 0,this.notify=void 0,this.load=void 0,this.onShown=void 0,this.onScroll=void 0,this.onScrollTop=void 0,this.onScrollBottom=void 0,this.className=void 0,this._content=void 0,Object(f.p)(this,{loaded:f.q,selected:f.q})}return Object(o.a)(e,[{key:"content",get:function(){return this.load&&!1===this.loaded?null:(!1===this.selected||this._content||(void 0!==this.contentBuilder?this._content=this.contentBuilder():void 0!==this.page?this._content=this.page.content():this._content=Object(j.jsx)("div",{className:"p-5",children:"tab \u5e94\u8be5\u5b9a\u4e49content\u6216\u8005page"})),this._content)}},{key:"shown",value:function(){var e=Object(c.a)(h.a.mark((function e(){var t=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.onShown){e.next=3;break}return e.next=3,this.onShown();case 3:if(void 0===this.load){e.next=8;break}if(!1!==this.loaded){e.next=8;break}return e.next=7,this.load();case 7:Object(f.s)((function(){t.loaded=!0}));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),O=function(e,t,n){return Object(j.jsxs)("div",{className:"d-flex justify-content-center align-items-center flex-column cursor-pointer "+n,children:[Object(j.jsx)("div",{children:Object(j.jsx)("i",{className:"fa fa-lg fa-"+t})}),Object(j.jsx)("small",{children:e})]})},k=function(){function e(t){var n=this;Object(u.a)(this,e),this.props=void 0,this.size=void 0,this.tabBg=void 0,this.sep=void 0,this.selectedTab=void 0,this.tabArr=void 0,this.tabClick=function(){var e=Object(c.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=8;break}if(void 0!==(t=n.selectedTab)){e.next=8;break}if(void 0!==n.tabArr){e.next=5;break}return e.abrupt("return");case 5:if(0!==n.tabArr.length){e.next=7;break}return e.abrupt("return");case 7:t=n.tabArr[0];case 8:return Object(f.s)((function(){n.selectedTab.selected=!1,t.selected=!0,n.selectedTab=t})),e.next=11,t.shown();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.tabs=Object(v.a)((function(){var e,t,r=n.props,a=r.tabPosition,i=r.borderColor;i&&(e={borderColor:i,borderStyle:"solid",borderTopWidth:1,borderLeftWidth:1,borderRightWidth:1,borderBottomWidth:1},t={borderColor:i,borderStyle:"solid",borderTopWidth:1,borderBottomWidth:1,borderLeftWidth:0,borderRightWidth:0,cursor:"pointer"},"top"===a?(e.borderBottomWidth=0,e.borderTopLeftRadius=10,e.borderTopRightRadius=10,t.borderTopWidth=0):(e.borderTopWidth=0,e.borderBottomLeftRadius=10,e.borderBottomRightRadius=10,t.borderBottomWidth=0));var s=b()("tv-tabs",n.tabBg,n.sep,"tv-tabs-"+n.size);return Object(j.jsx)("div",{className:s,children:n.tabArr.map((function(r,a){var i,s=r.selected,c=r.caption,u=r.notify;if(void 0!==u){var o="number"===typeof u?u:u.get();void 0!==o&&(o>0?i=Object(j.jsx)("u",{children:o>99?"99+":o}):o<0&&(i=Object(j.jsx)("u",{className:"dot"})))}return Object(j.jsx)("div",{onClick:function(){return n.tabClick(r)},style:!0===s?e:t,children:Object(j.jsxs)("div",{children:[i,c(s)]})},a)}))})})),this.content=Object(v.a)((function(){var e={visibility:"hidden"};return Object(j.jsx)(j.Fragment,{children:n.tabArr.map((function(t,r){var a,i,s,c,u=n.props.tabPosition,o=t.content,l=t.page,h=t.onScroll,f=t.onScrollTop,v=t.onScrollBottom,p=t.className,b=d.createElement(n.tabs);void 0!==l&&(a=l.header(),i=l.footer());var y,O={visibility:"hidden"};return"top"===u?(s=Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("section",{className:"tv-page-header",children:Object(j.jsxs)("header",{children:[b,a]})}),Object(j.jsxs)("header",{style:O,children:[b,a]})]}),void 0!==i&&(c=Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("footer",{style:O,children:i}),Object(j.jsx)("section",{className:"tv-page-footer",children:Object(j.jsx)("footer",{children:i})})]}))):(void 0!==a&&(s=Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("section",{className:"tv-page-header",children:Object(j.jsx)("header",{children:a})}),Object(j.jsx)("header",{style:O,children:a})]})),c=Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("footer",{style:O,children:[i,b]}),Object(j.jsx)("section",{className:"tv-page-footer",children:Object(j.jsxs)("footer",{children:[i,b]})})]})),!1===t.selected&&(y=e),Object(j.jsxs)(m.a,{className:p,style:y,onScroll:h,onScrollTop:f,onScrollBottom:v,children:[s,o,c]},r)}))})})),this.props=t;var r=t.size,a=t.tabs,i=t.tabBg,s=t.sep,o=t.selected;this.size=r||"md",this.tabArr=a.map((function(e){var t=new y,r=e.name,a=e.caption,i=e.content,s=e.page,c=e.notify,u=e.load,l=e.onShown,h=e.isSelected,d=e.onScroll,f=e.onScrollTop,v=e.onScrollBottom,p=e.className;return t.name=r,!0!==h&&r!==o||(n.selectedTab=t),t.selected=!1,t.caption=a,void 0!==i?t.contentBuilder=i:void 0!==s&&(t.page=s),t.notify=c,t.load=u,t.onShown=l,t.onScroll=d,t.onScrollTop=f,t.onScrollBottom=v,t.className=p,t})),this.tabBg=i,this.sep=s,void 0===this.selectedTab&&(this.selectedTab=this.tabArr[0]),this.selectedTab.selected=!0,Object(f.p)(this,{selectedTab:f.q,tabArr:f.q}),setTimeout((function(){n.tabClick(n.selectedTab)}),100)}return Object(o.a)(e,[{key:"render",value:function(){var e,t,n=this.props.tabPosition,r=d.createElement(this.tabs),a={display:"none"};return"top"===n?e=Object(j.jsx)("header",{children:r}):t=Object(j.jsx)("footer",{children:r}),Object(j.jsxs)(j.Fragment,{children:[e,this.tabArr.map((function(e,t){var n;return!1===e.selected&&(n=a),Object(j.jsx)("div",{className:b()(e.className),style:n,children:e.content},t)})),t]})}}]),e}();Object(v.a)(r=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).tabsView=void 0,r.tabsView=new k(e),r}return Object(o.a)(n,[{key:"render",value:function(){return this.tabsView.render()}}]),n}(d.Component)),Object(v.a)(a=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).tabsView=void 0,r.tabsView=new k(e),r}return Object(o.a)(n,[{key:"render",value:function(){return d.createElement(this.tabsView.content)}}]),n}(d.Component))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t){var n,a,i,s=e.name;switch(e.type){case"id":n="FieldItemId",a="id";break;case"char":n="FieldItemString",a="string",i="string";break;case"smallint":case"int":case"bigint":n="FieldItemInt",a="integer",i="updown";break;case"dec":case"float":case"double":n="FieldItemNumber",a="number",i="number"}return{name:s,type:a,isKey:t,widget:i,label:Object(r.d)(s),$FieldItemType:n}}},,function(e,t,n){"use strict";n.r(t),n.d(t,"CLogin",(function(){return I}));var r=n(2),a=n(3),i=n(4),s=n(5),c=n(6),u=n(1),o=n.n(u),l=n(13),h=n(23),d=n(0),f=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onLogout=void 0,e}return Object(i.a)(n,[{key:"init",value:function(e){this.onLogout=e}},{key:"header",value:function(){return!0!==this.isWebNav&&"\u5b89\u5168\u9000\u51fa"}},{key:"footer",value:function(){return Object(d.jsx)("div",{className:"mt-5 text-center justify-content-center",children:Object(d.jsx)("button",{className:"btn btn-outline-warning",onClick:this.tonwa.resetAll,children:"\u5347\u7ea7\u8f6f\u4ef6"})})}},{key:"back",get:function(){return"close"}},{key:"content",value:function(){return Object(d.jsxs)("div",{className:"m-5 border border-info bg-white rounded-3 p-5 text-center",children:[Object(d.jsx)("div",{children:"\u9000\u51fa\u5f53\u524d\u8d26\u53f7\u4e0d\u4f1a\u5220\u9664\u4efb\u4f55\u5386\u53f2\u6570\u636e\uff0c\u4e0b\u6b21\u767b\u5f55\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528\u672c\u8d26\u53f7"}),Object(d.jsx)("div",{className:"mt-5 text-center",children:Object(d.jsx)("button",{className:"btn btn-danger",onClick:this.onLogout,children:"\u5b89\u5168\u9000\u51fa"})})]})}}]),n}(h.b),v=n(18),p=n(46),b=n(9),m=[{name:"username",type:"string",required:!0,maxLength:100},{name:"password",type:"string",required:!0,maxLength:100},{name:"login",type:"submit"}],j=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).onLogin=void 0,e.withBack=void 0,e.uiSchema={items:{username:{placeholder:"\u624b\u673a/\u90ae\u7bb1/\u7528\u6237\u540d",label:"\u767b\u5f55\u8d26\u53f7"},password:{widget:"password",placeholder:"\u5bc6\u7801",label:"\u5bc6\u7801"},login:{widget:"button",className:"btn btn-primary btn-block mt-3",label:"\u767b\u5f55"}}},e.onSubmit=function(){var t=Object(r.a)(o.a.mark((function t(n,r){var a,i,s,c,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.form.data,i=a.username,void 0!==(s=a.password)){t.next=5;break}return t.abrupt("return","something wrong, pwd is undefined");case 5:return t.next=7,e.onLogin(i,s);case 7:if(!0!==t.sent){t.next=10;break}return t.abrupt("return");case 10:return c=Object(p.b)(i),u=void 0!==c?c.caption:"\u7528\u6237\u540d",t.abrupt("return",u+"\u6216\u5bc6\u7801\u9519\uff01");case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.onEnter=function(){var t=Object(r.a)(o.a.mark((function t(n,r){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("password"!==n){t.next=4;break}return t.next=3,e.onSubmit("login",r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(i.a)(n,[{key:"init",value:function(e){var t=e.onLogin,n=e.withBack;this.onLogin=t,this.withBack=n}},{key:"header",value:function(){return!0===this.withBack&&"\u767b\u5f55"}},{key:"content",value:function(){return Object(d.jsxs)("div",{className:"d-flex p-5 flex-column justify-content-center align-items-center",children:[Object(d.jsx)("div",{className:"flex-fill"}),Object(d.jsxs)("div",{className:"w-20c",children:[this.tonwa.loginTop(p.a),Object(d.jsx)("div",{className:"h-2c"}),Object(d.jsx)(v.e,{schema:m,uiSchema:this.uiSchema,onButtonClick:this.onSubmit,onEnter:this.onEnter,requiredFlag:!1}),Object(d.jsxs)("div",{className:"text-center",children:[Object(d.jsx)(v.a,{className:"btn btn-link",href:"/forget",children:"\u5fd8\u8bb0\u5bc6\u7801"}),Object(d.jsx)(v.a,{href:"/register",className:"btn btn-link",children:"\u6ce8\u518c\u8d26\u53f7"})]}),b.m.privacyEntry()]}),Object(d.jsx)("div",{className:"flex-fill"}),Object(d.jsx)("div",{className:"flex-fill"})]})}}]),n}(h.b),y=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).schema=[{name:"orgPassword",type:"string",maxLength:60,required:!0},{name:"newPassword",type:"string",maxLength:60,required:!0},{name:"newPassword1",type:"string",maxLength:60,required:!0},{name:"submit",type:"submit"}],e.uiSchema={items:{orgPassword:{widget:"password",label:"\u539f\u5bc6\u7801",placeholder:"\u8f93\u5165\u539f\u6765\u7684\u5bc6\u7801"},newPassword:{widget:"password",label:"\u65b0\u5bc6\u7801",placeholder:"\u8f93\u5165\u65b0\u8bbe\u7684\u5bc6\u7801"},newPassword1:{widget:"password",label:"\u786e\u8ba4\u5bc6\u7801",placeholder:"\u518d\u6b21\u8f93\u5165\u65b0\u8bbe\u5bc6\u7801"},submit:{widget:"button",label:"\u63d0\u4ea4",className:"btn btn-primary"}}},e.onChange=void 0,e.onSubmit=function(){var t=Object(r.a)(o.a.mark((function t(n,r){var a,i,s,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.data,i=a.orgPassword,s=a.newPassword,c=a.newPassword1,s===c){t.next=4;break}return r.setError("newPassword1","\u65b0\u5bc6\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"),t.abrupt("return");case 4:return t.next=6,e.onChange(i,s);case 6:if(!1!==t.sent){t.next=10;break}return r.setError("orgPassword","\u539f\u5bc6\u7801\u9519\u8bef"),t.abrupt("return");case 10:return b.m.nav.replace(Object(d.jsx)(v.l,{header:"\u4fee\u6539\u5bc6\u7801",back:"close",children:Object(d.jsx)("div",{className:"m-3  text-success",children:"\u5bc6\u7801\u4fee\u6539\u6210\u529f\uff01"})})),t.abrupt("return");case 12:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(i.a)(n,[{key:"init",value:function(e){this.onChange=e}},{key:"header",value:function(){return"\u4fee\u6539\u5bc6\u7801"}},{key:"content",value:function(){return Object(d.jsx)(v.e,{className:"m-3",schema:this.schema,uiSchema:this.uiSchema,onButtonClick:this.onSubmit,fieldLabelSize:2})}}]),n}(h.b),O="\u4e00\u5c0f\u65f6",k=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"button1Caption",get:function(){}},{key:"button2Caption",get:function(){}},{key:"renderButton1",value:function(){var e=this,t=this.button1Caption;return null===t?null:Object(d.jsx)("button",{className:"btn btn-primary",onClick:function(){return e.onClickButton1()},children:null!==t&&void 0!==t?t:"\u4e0d\u6ce8\u9500"})}},{key:"renderButton2",value:function(){var e=this,t=this.button2Caption;return null===t?null:Object(d.jsx)("button",{className:"btn btn-outline-info ms-3",onClick:function(){return e.onClickButton2()},children:null!==t&&void 0!==t?t:"\u786e\u8ba4\u6ce8\u9500"})}},{key:"header",value:function(){return"\u6ce8\u9500\u8d26\u53f7"}},{key:"content",value:function(){return Object(d.jsxs)("div",{className:"border border-danger rounded mx-auto m-3 w-max-30c bg-white ",children:[Object(d.jsx)("div",{className:"p-4 border-bottom",children:this.note}),Object(d.jsxs)("div",{className:"p-3 text-center",children:[this.renderButton1(),this.renderButton2()]})]})}},{key:"onClickButton1",value:function(){this.closePage()}},{key:"onClickButton2",value:function(){}}]),n}(h.b),g=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"note",get:function(){return Object(d.jsxs)(d.Fragment,{children:["\u6ce8\u610f\uff1a\u8d26\u53f7\u6ce8\u9500\u540e\uff0c\u8d26\u53f7\u7ed1\u5b9a\u624b\u673a\u3001\u90ae\u4ef6\u7b49\u76f8\u5173\u4fe1\u606f\u5c06\u88ab\u91ca\u653e\u3002\u8d26\u53f7\u65e0\u6cd5\u5c06\u767b\u5f55\u3002",Object(d.jsx)("br",{}),"\u8bf7\u786e\u8ba4\uff01"]})}},{key:"button2Caption",get:function(){return"\u6211\u5df2\u4e86\u89e3\uff0c\u4ecd\u7136\u6ce8\u9500"}},{key:"onClickButton2",value:function(){this.openVPage(x)}}]),n}(k),x=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"note",get:function(){return Object(d.jsxs)(d.Fragment,{children:["\u8d26\u53f7\u6ce8\u9500\u540e\uff0c\u5982\u679c\u5728",O,"\u5185\u5bb9\u91cd\u65b0\u767b\u5f55\u8d26\u53f7\uff0c\u8d26\u53f7\u81ea\u52a8\u6062\u590d\u3002",O,"\u4e4b\u540e\uff0c\u8d26\u53f7\u7ed1\u5b9a\u624b\u673a\u3001\u90ae\u4ef6\u7b49\u76f8\u5173\u4fe1\u606f\u5c06\u88ab\u91ca\u653e\u3002\u8d26\u53f7\u65e0\u6cd5\u5c06\u767b\u5f55\u3002",Object(d.jsx)("br",{}),"\u8bf7\u518d\u6b21\u786e\u8ba4\uff01"]})}},{key:"button2Caption",get:function(){return"\u786e\u8ba4\u6ce8\u9500"}},{key:"onClickButton1",value:function(){this.closePage(2)}},{key:"onClickButton2",value:function(){var e=Object(r.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new l.a(this.controller.net,"tv/"),e.next=3,t.userQuit();case 3:this.openVPage(w);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(k),w=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"header",value:function(){return"\u6ce8\u9500\u5df2\u8d26\u53f7"}},{key:"back",get:function(){return"none"}},{key:"note",get:function(){return Object(d.jsxs)(d.Fragment,{children:["\u8d26\u53f7\u5c06\u5728",O,"\u540e\u5f7b\u5e95\u6ce8\u9500\u3002",Object(d.jsx)("br",{}),"\u5982\u679c\u5728",O,"\u5185\u5bb9\u91cd\u65b0\u767b\u5f55\u8d26\u53f7\uff0c\u6ce8\u9500\u64cd\u4f5c\u81ea\u52a8\u53d6\u6d88\u3002",O,"\u4e4b\u540e\uff0c\u8d26\u53f7\u7ed1\u5b9a\u624b\u673a\u3001\u90ae\u4ef6\u7b49\u76f8\u5173\u4fe1\u606f\u5c06\u88ab\u91ca\u653e\u3002\u8d26\u53f7\u65e0\u6cd5\u5c06\u767b\u5f55\u3002"]})}},{key:"button1Caption",get:function(){return"\u9000\u51fa"}},{key:"button2Caption",get:function(){return null}},{key:"onClickButton1",value:function(){this.tonwa.logout()}}]),n}(k),I=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"internalStart",value:function(){var e=Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"showLogin",value:function(){var e=Object(r.a)(o.a.mark((function e(t,n){var a,i=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=function(){var e=Object(r.a)(o.a.mark((function e(n,r){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.net.userApi.login({user:n,pwd:r,guest:i.tonwa.guest});case 2:if(void 0!==(a=e.sent)){e.next=5;break}return e.abrupt("return",!1);case 5:return console.log("onLoginSubmit: user=%s pwd:%s",a.name,a.token),e.next=8,i.tonwa.userLogined(a,t);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.openVPage(j,{onLogin:a,withBack:n});case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"showLogout",value:function(){var e=Object(r.a)(o.a.mark((function e(t){var n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openVPage(f,(function(){n.tonwa.logout(t)}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getVChangePassword",value:function(){return y}},{key:"showChangePassword",value:function(){var e=Object(r.a)(o.a.mark((function e(){var t,n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.getVChangePassword(),this.openVPage(t,function(){var e=Object(r.a)(o.a.mark((function e(t,r){var a,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new l.a(n.net,"tv/"),e.next=3,a.changePassword({orgPassword:t,newPassword:r});case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showUserQuit",value:function(){var e=Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openVPage(g);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(h.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u}));var r=n(9),a=n.p+"static/media/logo.2d27ead7.svg",i=n(0),s=Object(i.jsxs)("div",{className:"d-flex align-items-center position-relative",children:[Object(i.jsx)("img",{className:"App-logo h-3c position-absolute",src:a,alt:"img"}),Object(i.jsxs)("div",{className:"h3 flex-fill text-center",children:[Object(i.jsx)("span",{className:"text-primary me-3",children:"\u540c"}),Object(i.jsx)("span",{className:"text-danger",children:"\u82b1"})]})]}),c=[{type:"mobile",caption:"\u624b\u673a\u53f7",regex:r.g},{type:"email",caption:"\u90ae\u7bb1",regex:r.c}];function u(e){return c.find((function(t){return!0===t.regex.test(e)}))}},,function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return x}));var r,a=n(5),i=n(6),s=n(2),c=n(3),u=n(4),o=n(10),l=n(1),h=n.n(l),d="https://tv.jkchemical.com",f=null!==(r="https://dev.tonwa.ca")?r:d,v=null!==f&&void 0!==f?f:d,p="localhost:3015",b={centerhost:{value:"localhost:3000",local:!1},reshost:{value:"localhost:3015",local:!1},uqhost:{value:p,local:!1},unitxhost:{value:p,local:!1},"uq-build":{value:"localhost:3009",local:!1}},m=["https://","http://"];function j(e){return!0===function(e){var t,n=Object(o.a)(m);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!0===e.startsWith(r))return!0}}catch(a){n.e(a)}finally{n.f()}return!1}(e)?e.endsWith("/")?e:e+"/":"http://".concat(e,"/")}function y(e){return j(e)}function O(e){var t="https://";return!0===e.startsWith(t)?(!0===(e=e.substr(t.length)).endsWith("/")&&(e=e.substr(0,e.length-1)),"wss://"+e+"/tv/"):"ws://".concat(e,"/tv/")}function k(e){if(e)return j(e)+"res/"}var g={method:"GET",mode:"no-cors",headers:{"Content-Type":"text/plain"}},x=function(){function t(){Object(c.a)(this,t),this.testing=void 0,this.url=void 0,this.ws=void 0,this.resHost=void 0,this.hash=void 0}return Object(u.a)(t,[{key:"start",value:function(){var t=Object(s.a)(h.a.mark((function t(n){var r,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.document,this.hash=r?r.location.hash:"",this.testing=n,t.next=6,this.tryLocal();case 6:a=this.getCenterHost(),this.url=y(a),this.ws=O(a),this.resHost=this.getResHost();case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"tryLocal",value:function(){var e=Object(s.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getCenterHost",value:function(){var e=b.centerhost.value;return!0===this.hash.includes("sheet_debug")?e:f}},{key:"getResHost",value:function(){var e=b.reshost.value;return!0===this.hash.includes("sheet_debug")?e:v}},{key:"getUrlOrDebug",value:function(e){return e}},{key:"getUrlOrTest",value:function(e,t,n){var r;return n?t||(t=n):(n=t)||console.error("no server set for "+e),!0===this.testing?("-"!==n&&(t=n),r="test"):r="prod",!1===(t=this.getUrlOrDebug(t)).endsWith("/")&&(t+="/"),"".concat(t,"uq/").concat(r,"/").concat(e,"/")}},{key:"localCheck",value:function(){var e=Object(s.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"createHost",value:function(e){return!0===e?new w:new t}}]),t}(),w=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"debugHostUrl",value:function(e){return"http://".concat(e,"/hello")}},{key:"tryLocal",value:function(){var e=Object(s.a)(h.a.mark((function e(){var t,n,r,a,i,s,c,u,o,l,d,f,v,p,m;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=[],n=[],r=function(e){var t=b[e].value;n.findIndex((function(e){return e===t}))<0&&n.push(t)},b)r(a);for(i=0,s=n;i<s.length;i++)c=s[i],u=this.debugHostUrl(c),t.push(C(u));return e.next=7,Promise.all(t);case 7:for(o=e.sent,l=n.length,d=0;d<l;d++)for(p in f=o[d],v=n[d],b)(m=b[p]).value===v&&(m.local=f);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCenterHost",value:function(){var e=b.centerhost,t=e.value,n=e.local;return!0===this.hash.includes("sheet_debug")||!0===n?t:f}},{key:"getResHost",value:function(){var e=b.reshost,t=e.value,n=e.local;return!0===this.hash.includes("sheet_debug")||!0===n?t:v}},{key:"getUrlOrDebug",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"uqhost",n=b[t];if(void 0===n)return e;var r=n.value,a=n.local;return!1===a?e:"http://".concat(r,"/")}}]),n}(x);function I(e){return new Promise((function(t,n){fetch(e,g).then((function(e){e.text().then(t).catch(n)})).catch(n);var r=new Error("Connection timed out");setTimeout(n,2e3,r)}))}function C(e){return N.apply(this,arguments)}function N(){return(N=Object(s.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I(t);case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}}).call(this,n(31))},function(e){e.exports=JSON.parse('{"devs":{"bz":{"name":"bizdev","alias":"bz"}},"uqs":[{"dev":"bz","name":"workshop","alias":"Workshop"},{"dev":"bz","name":"workshop-bus-test","alias":"WorkshopBusTest"}]}')},function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c}));var r={lang:void 0,$lang:void 0,district:void 0,$district:void 0};function a(e){var t=r.lang,n=r.district,a={};if(void 0===e)return a;Object.assign(a,e._);var i=e[t];if(void 0===i)return a;Object.assign(a,i._);var s=i[n];if(void 0===s)return a;Object.assign(a,s);var c=a.entity;if(void 0!==c)for(var u in c)c[u.toLowerCase()]=c[u];return a}!function(){var t=e.navigator;if(t){var n,a,i=t.languages&&t.languages[0]||t.language;if(i){var s=i.split("-");n=s[0],s.length>1&&(a=s[1].toUpperCase())}else n="zh",a="CN";!function(e,t){r.lang=e,r.$lang="$"+e,r.district=t,r.$district="$"+t}(n,a)}}();var i={};function s(e,t){if(void 0!==t){var n=r.$lang,a=r.$district;if(Object.assign(e,t),void 0!==n){var i=t[n];if(void 0!==i){Object.assign(e,i);var s=i[a];void 0!==s&&Object.assign(e,s)}}return function(t){return e[t]||t}}}function c(e){s(i,e)}}).call(this,n(31))},,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return TsUqFolder}));var C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20),C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10),C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_classCallCheck_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3),C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_createClass_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(4),fs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(22),fs__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_4__),_tool__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(15),_TsUQ__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(54),_buildFieldItem__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(43),_tools__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(21),fieldItemReplaceProps=["label","placeholder","widget","type"],TsUqFolder=function(){function TsUqFolder(e,t,n,r){Object(C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_classCallCheck_js__WEBPACK_IMPORTED_MODULE_2__.a)(this,TsUqFolder),this.buildContext=void 0,this.uq=void 0,this.uqsFolder=void 0,this.uqAlias=void 0,this.buildContext=e,this.uq=t,this.uqsFolder=n,this.uqAlias=r}return Object(C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_createClass_js__WEBPACK_IMPORTED_MODULE_3__.a)(TsUqFolder,[{key:"build",value:function(){var e=this.uqsFolder+"/"+this.uqAlias;!1===fs__WEBPACK_IMPORTED_MODULE_4___default.a.existsSync(e)&&fs__WEBPACK_IMPORTED_MODULE_4___default.a.mkdirSync(e);var t=this.buildContext.tsTemplate.tsHeader;t+=new _TsUQ__WEBPACK_IMPORTED_MODULE_6__.a(this.buildContext,this.uq,this.uqAlias).build(),Object(_tools__WEBPACK_IMPORTED_MODULE_8__.d)("".concat(e,"/").concat(this.uqAlias,".ts"),t),this.saveTuidAndIDTsIndexAndRender(e)}},{key:"saveTuidAndIDTsIndexAndRender",value:function(e){var t,n="",r="",a=this.uq,i=a.idArr,s=a.idxArr,c=a.tuidArr,u={},o=Object(C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper_js__WEBPACK_IMPORTED_MODULE_1__.a)(c);try{for(o.s();!(t=o.n()).done;){var l=t.value,h=l.sName;u[h.toLowerCase()]=l;var d=Object(_tool__WEBPACK_IMPORTED_MODULE_5__.d)(h);if("$"!==d[0]){n+="\nimport * as ".concat(d," from './").concat(d,".ui';"),r+="\n\tassign(uq, '".concat(d,"', ").concat(d,");");var f="/* eslint-disable */\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, FieldItemInt, UI, TFunc } from 'tonwa-".concat(this.buildContext.uiPlatform,'\';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { uqStringify } from "tonwa-uq";\nimport { Res, setRes } from "tonwa-core";\nimport { Tuid').concat(d,' } from "./').concat(this.uqAlias,'";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|').concat(this.buildContext.element,"): string|").concat(this.buildContext.element," => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: Tuid").concat(d,"):").concat(this.buildContext.element," {\n\treturn <>{uqStringify(item)}</>;\n};\n"),v="".concat(e,"/").concat(d,".ui.tsx");Object(_tools__WEBPACK_IMPORTED_MODULE_8__.h)(v,f)}}}catch(P){o.e(P)}finally{o.f()}for(var p=0,b=[].concat(Object(C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_0__.a)(i),Object(C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_0__.a)(s));p<b.length;p++){var m=b[p],j=m.sName,y=Object(_tool__WEBPACK_IMPORTED_MODULE_5__.d)(j);if("$"!==y[0]){u[y.toLocaleLowerCase()]=m,n+="\nimport * as ".concat(y," from './").concat(y,".ui';"),r+="\n\tassign(uq, '".concat(y,"', ").concat(y,");");var O="// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, FieldItemInt, UI, TFunc } from 'tonwa-".concat(this.buildContext.uiPlatform,'\';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, uqStringify, setRes } from "tonwa-core";\nimport { ').concat(y,' } from "./').concat(this.uqAlias,'";\n\n/*--fields--*/\nconst fields = {\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n];\n\nexport const ui: UI = {\n\tlabel: "').concat(y,'",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|').concat(this.buildContext.element,"): string|").concat(this.buildContext.element," => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ").concat(y,"):").concat(this.buildContext.element," {\n\treturn <>{uqStringify(item)}</>;\n};\n"),k="".concat(e,"/").concat(y,".ui.tsx");Object(_tools__WEBPACK_IMPORTED_MODULE_8__.h)(k,O);var g=this.buildFields(m),x=this.buildFieldArr(m);this.replaceTsFileFields(k,g);var w="import { FieldItem, ",I=' } from "tonwa-'.concat(this.buildContext.uiPlatform,'";');this.replaceTsFileString(k,{begin:w,end:I,content:"import { FieldItem, FieldItemInt, FieldItemNumber, FieldItemString, FieldItemId"+I}),this.replaceTsFileString(k,{begin:"\nconst fieldArr: FieldItem[] = [\n",end:"\n];\n",content:x})}}var C="import { UqExt as Uq, assign } from './".concat(this.uqAlias,"';").concat(n,"\n\t\nexport function setUI(uq: Uq) {").concat(r,"\n}\nexport * from './").concat(this.uqAlias,"';\n");Object(_tools__WEBPACK_IMPORTED_MODULE_8__.d)("".concat(e,"/index.ts"),C);var N,_=fs__WEBPACK_IMPORTED_MODULE_4___default.a.readdirSync(e),A=".ui.tsx",S=Object(C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper_js__WEBPACK_IMPORTED_MODULE_1__.a)(_);try{for(S.s();!(N=S.n()).done;){var q=N.value;if(!1!==q.endsWith(A)){var T=q.length-A.length,D=q.substring(0,T);if(void 0===u[D.toLocaleLowerCase()]||"$"===D[0]){var E="".concat(e,"/").concat(q);fs__WEBPACK_IMPORTED_MODULE_4___default.a.unlinkSync(E)}}}}catch(P){S.e(P)}finally{S.f()}}},{key:"buildFields",value:function(e){switch(e.typeName){case"id":return this.buildIDFields(e);case"idx":return this.buildIDXFields(e);case"ix":return this.buildIXFields(e)}}},{key:"buildIDFields",value:function(e){var t,n={},r=e.schema,a=r.keys,i=r.fields,s=Object(C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper_js__WEBPACK_IMPORTED_MODULE_1__.a)(i);try{var c=function(){var e=t.value,r=e.name,i=(null===a||void 0===a?void 0:a.findIndex((function(e){return e.name===r})))>=0;n[r]=Object(_buildFieldItem__WEBPACK_IMPORTED_MODULE_7__.a)(e,i)};for(s.s();!(t=s.n()).done;)c()}catch(u){s.e(u)}finally{s.f()}return n}},{key:"buildIDXFields",value:function(e){var t,n={},r=e.schema,a=r.keys,i=r.fields,s=Object(C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper_js__WEBPACK_IMPORTED_MODULE_1__.a)(i);try{var c=function(){var e=t.value,r=e.name,i=(null===a||void 0===a?void 0:a.findIndex((function(e){return e.name===r})))>=0;n[r]=Object(_buildFieldItem__WEBPACK_IMPORTED_MODULE_7__.a)(e,i)};for(s.s();!(t=s.n()).done;)c()}catch(u){s.e(u)}finally{s.f()}return n}},{key:"buildIXFields",value:function(e){var t,n={},r=e.schema,a=r.keys,i=r.fields,s=Object(C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper_js__WEBPACK_IMPORTED_MODULE_1__.a)(i);try{var c=function(){var e=t.value,r=e.name,i=(null===a||void 0===a?void 0:a.findIndex((function(e){return e.name===r})))>=0;n[r]=Object(_buildFieldItem__WEBPACK_IMPORTED_MODULE_7__.a)(e,i)};for(s.s();!(t=s.n()).done;)c()}catch(u){s.e(u)}finally{s.f()}return n}},{key:"buildFieldArr",value:function(e){var t="\nconst fieldArr: FieldItem[] = [\n\t";switch(e.typeName){case"id":t+=this.buildIDFieldArr(e);break;case"idx":t+=this.buildIDXFieldArr(e);break;case"ix":t+=this.buildIXFieldArr(e)}return t+"\n];\n"}},{key:"buildIDFieldArr",value:function(e){var t,n=e.schema,r="",a=Object(C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper_js__WEBPACK_IMPORTED_MODULE_1__.a)(n.fields);try{for(a.s();!(t=a.n()).done;){var i=t.value.name;"id"!==i&&(r+="fields.".concat(i,", "))}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"buildIDXFieldArr",value:function(e){var t,n=e.schema,r="",a=Object(C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper_js__WEBPACK_IMPORTED_MODULE_1__.a)(n.fields);try{for(a.s();!(t=a.n()).done;){var i=t.value.name;"id"!==i&&(r+="fields.".concat(i,", "))}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"buildIXFieldArr",value:function(e){var t,n=e.schema,r="",a=Object(C_Users_liaoh_Documents_Tonwa_timeschange_workshop_class_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper_js__WEBPACK_IMPORTED_MODULE_1__.a)(n.fields);try{for(a.s();!(t=a.n()).done;){var i=t.value.name;"ix"!==i&&("id"!==i&&(r+="fields.".concat(i,", ")))}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"replaceTsFileFields",value:function(e,t){var n=fs__WEBPACK_IMPORTED_MODULE_4___default.a.readFileSync(e).toString(),r="\n/*--fields--*/",a=n.indexOf(r);if(a>0){var i=n.indexOf("\n/*==fields==*/\n",a+r.length);if(i>0){var s=n.indexOf("{",a+r.length),c=n.lastIndexOf("}",i),u=n.substring(s,c+1),o=this.buildFieldsFromOldText(t,u);n=n.substring(0,a)+r+"\nconst fields = {"+o+"\n};"+n.substring(i),fs__WEBPACK_IMPORTED_MODULE_4___default.a.writeFileSync(e,n)}}}},{key:"buildFieldsFromOldText",value:function(e,t){var n="";for(var r in e){var a=e[r];this.setFieldOldProp(a,t),n+=this.buildFieldText(a)}return n}},{key:"setFieldOldProp",value:function setFieldOldProp(field,text){var fieldStart=field.name+":",start=text.indexOf("\t"+fieldStart);if(start<0&&(start=text.indexOf("\n"+fieldStart)),start<0&&(start=text.indexOf(" "+fieldStart)),!(start<0)){++start;var end=text.indexOf("}",start+fieldStart.length);if(!(end<0)){var fieldText=text.substring(start+fieldStart.length,end+1),obj=eval("("+fieldText+")");fieldItemReplaceProps.forEach((function(e){var t=obj[e];t&&"type"!==e&&(field[e]=t)}))}}}},{key:"buildFieldText",value:function(e){var t=e.$FieldItemType;delete e.$FieldItemType;var n="\n\t"+e.name+": ",r=JSON.stringify(e,null,"\t\t");return(n+=r=r.replace("}","\t}"))+" as "+t+","}},{key:"replaceTsFileString",value:function(e,t){var n=fs__WEBPACK_IMPORTED_MODULE_4___default.a.readFileSync(e).toString(),r=t.begin,a=t.end,i=t.content,s=n.indexOf(r);if(!(s<0)){var c=n.indexOf(a,s+r.length-1);c<0||(n=n.substring(0,s)+i+n.substr(c+a.length),fs__WEBPACK_IMPORTED_MODULE_4___default.a.writeFileSync(e,n))}}}]),TsUqFolder}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(10),a=n(3),i=n(4),s=n(15),c=n(21),u={char:"string",text:"string",id:"number",textid:"string",int:"number",bigint:"number",smallint:"number",tinyint:"number",dec:"number",float:"number",double:"number"},o=["id","main","row","no","$create","$update","$owner"],l=function(){function e(t,n,i){var o=this;Object(a.a)(this,e),this.buildContext=void 0,this.uq=void 0,this.uqAlias=void 0,this.buildTuid=function(e){return"\t".concat(Object(c.a)(e.sName),": UqTuid<Tuid").concat(Object(s.d)(e.sName),">&{tv:(id:number, render?:Render<any>)=>").concat(o.buildContext.element,"};")},this.buildTuidInterface=function(e){var t="export interface Tuid".concat(Object(s.d)(e.sName)," {");return t+="\n\tid?: number;",t+=o.buildFields(e.fields),t+="\n}"},this.buildAction=function(e){return"\t".concat(Object(c.a)(e.sName),": UqAction<Param").concat(Object(s.d)(e.sName),", Result").concat(Object(s.d)(e.sName),">;")},this.buildActionInterface=function(e){var t="export interface Param".concat(Object(s.d)(e.sName)," {");return t+=o.buildFields(e.fields),t+=o.buildArrs(e.arrFields),t+="\n}\n",t+=o.buildReturns(e,e.returns)},this.buildEnumInterface=function(e){var t=e.schema;if(t){var n=t.values,r="export enum ".concat(Object(s.d)(e.sName)," {"),a=!0;for(var i in n){!1===a?r+=",":a=!1;var c=n[i];r+="\n\t"+i+" = ",r+="string"===typeof c?'"'+c+'"':c}return r+"\n}"}},this.buildQuery=function(e){var t=e.sName;return"\t".concat(Object(c.a)(t),": UqQuery<Param").concat(Object(s.d)(t),", Result").concat(Object(s.d)(t),">;")},this.buildQueryInterface=function(e){var t="export interface Param".concat(Object(s.d)(e.sName)," {");return t+=o.buildFields(e.fields),t+="\n}\n",t+=o.buildReturns(e,e.returns)},this.buildSheet=function(e){var t=e.sName,n=e.verify,r=Object(s.d)(t),a=n?"Verify".concat(r):"any";return"\t".concat(Object(c.a)(t),": UqSheet<Sheet").concat(r,", ").concat(a,">;")},this.buildSheetInterface=function(e){var t=e.sName,n=e.fields,a=e.arrFields,i=e.verify,c="export interface Sheet".concat(Object(s.d)(t)," {");if(c+=o.buildFields(n),c+=o.buildArrs(a),c+="}",i){var u=i.returns;c+="\nexport interface Verify".concat(Object(s.d)(t)," {");var l,h=Object(r.a)(u);try{for(h.s();!(l=h.n()).done;){var d=l.value,f=d.name,v=d.fields;c+="\n\t"+f+": {",c+=o.buildFields(v,!1,2),c+="\n\t}[];"}}catch(p){h.e(p)}finally{h.f()}c+="\n}"}return c},this.buildBook=function(e){var t=e.sName;return"\t".concat(Object(c.a)(t),": UqBook<Param").concat(Object(s.d)(t),", Result").concat(Object(s.d)(t),">;")},this.buildBookInterface=function(e){var t=e.sName,n=e.fields,r=e.returns,a="export interface Param".concat(Object(s.d)(t)," {");return a+=o.buildFields(n),a+="\n}\n",a+=o.buildReturns(e,r)},this.buildMap=function(e){var t=e.sName;return"\t".concat(Object(c.a)(t),": UqMap;")},this.buildMapInterface=function(e){return""},this.buildHistory=function(e){var t=e.sName;return"\t".concat(Object(c.a)(t),": UqHistory<Param").concat(Object(s.d)(t),", Result").concat(Object(s.d)(t),">;")},this.buildHistoryInterface=function(e){var t=e.sName,n=e.fields,r=e.returns,a="export interface Param".concat(Object(s.d)(t)," {");return a+=o.buildFields(n),a+="\n}\n",a+=o.buildReturns(e,r)},this.buildPending=function(e){var t=e.sName;return"\t".concat(Object(c.a)(t),": UqPending<any, any>;")},this.buildPendingInterface=function(e){return""},this.buildID=function(e){var t=e.sName;return"\t".concat(Object(c.a)(t),": UqID<any> & IDXEntity<any>;")},this.buildIDX=function(e){var t=e.sName;return"\t".concat(Object(c.a)(t),": UqIDX<any>;")},this.buildIX=function(e){var t=e.sName;return"\t".concat(Object(c.a)(t),": UqIX<any>;")},this.buildIDInterface=function(e){var t,n=e.sName,a=e.fields,i=e.schema.keys,c=[],u=[],l=Object(r.a)(a);try{var h=function(){var e=t.value,n=e.name;if("id"===n)return"continue";i.find((function(e){return e.name===n}))?c.push(e):u.push(e)};for(l.s();!(t=l.n()).done;)h()}catch(f){l.e(f)}finally{l.f()}var d="export interface ".concat(Object(s.d)(n)," {");return d+="\n\tid?: number;",d+=o.buildFields(c,!0),d+=o.buildFields(u,!0),d+="\n}"},this.buildIDXInterface=function(e){var t,n=e.sName,a=e.fields,i="export interface ".concat(Object(s.d)(n)," {"),c=Object(r.a)(a);try{for(c.s();!(t=c.n()).done;){var o=t.value,l=o.name,h=o.type,d=u[h];d||(d="any"),i+="\n".concat("\t".repeat(1)).concat(l),"id"!==l&&(i+="?"),i+=": ".concat(d,";")}}catch(f){c.e(f)}finally{c.f()}return i+="\n\t$act?: number;",i+="\n}"},this.buildIDXActParamInterface=function(e){var t,n=e.sName,a=e.fields,i="export interface ActParam".concat(Object(s.d)(n)," {"),c=Object(r.a)(a);try{for(c.s();!(t=c.n()).done;){var o=t.value,l=o.name,h=o.type,d=u[h];d||(d="any"),i+="\n".concat("\t".repeat(1)).concat(l),"id"!==l&&(i+="?"),i+=": ".concat(d,"|IDXValue;")}}catch(f){c.e(f)}finally{c.f()}return i+="\n\t$act?: number;",i+="\n}"},this.buildIXInterface=function(e){var t=e.sName,n=e.fields,r="export interface ".concat(Object(s.d)(t)," {");return r+=o.buildFields(n),r+="\n}"},this.buildContext=t,this.uq=n,this.uqAlias=i}return Object(i.a)(e,[{key:"build",value:function(){var e=this,t="\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { IDXValue, Uq",n="\n\n";n+="\n//===============================",n+="\n//======= UQ ".concat(this.uq.name," ========"),n+="\n//===============================",n+="\n";var r=this.uq,a=r.enumArr,i=r.tuidArr,s=r.actionArr,c=r.sheetArr,u=r.queryArr,o=r.bookArr,l=r.mapArr,h=r.historyArr,d=r.pendingArr,f=r.idArr,v=r.idxArr,p=r.ixArr;function b(e,r,a){if(0!==e.length){var i=n.length;e.forEach((function(e){return n+=a(e)})),n.length-i>0&&(t+=", Uq"+r)}}return a.forEach((function(t){return n+=e.uqEntityInterface(t,e.buildEnumInterface)})),i.forEach((function(t){return n+=e.uqEntityInterface(t,e.buildTuidInterface)})),s.forEach((function(t){return n+=e.uqEntityInterface(t,e.buildActionInterface)})),c.forEach((function(t){return n+=e.uqEntityInterface(t,e.buildSheetInterface)})),u.forEach((function(t){return n+=e.uqEntityInterface(t,e.buildQueryInterface)})),o.forEach((function(t){return n+=e.uqEntityInterface(t,e.buildBookInterface)})),l.forEach((function(t){return n+=e.uqEntityInterface(t,e.buildMapInterface)})),h.forEach((function(t){return n+=e.uqEntityInterface(t,e.buildHistoryInterface)})),d.forEach((function(t){return n+=e.uqEntityInterface(t,e.buildPendingInterface)})),f.forEach((function(t){return n+=e.uqEntityInterface(t,e.buildIDInterface)})),v.forEach((function(t){return n+=e.uqEntityInterface(t,e.buildIDXInterface)})),v.forEach((function(t){return n+=e.uqEntityInterface(t,e.buildIDXActParamInterface)})),p.forEach((function(t){return n+=e.uqEntityInterface(t,e.buildIXInterface)})),n+=this.buildActsInterface(this.uq),n+="\n\nexport interface UqExt extends Uq {\n\tActs(param:ParamActs): Promise<any>;\n\tSQL: Uq;\n\tIDRender(id:number):".concat(this.buildContext.element,";\n\tIDLocalRender(id:number):").concat(this.buildContext.element,";\n"),b(i,"Tuid",(function(t){return e.uqBlock(t,e.buildTuid)})),b(s,"Action",(function(t){return e.uqBlock(t,e.buildAction)})),b(c,"Sheet",(function(t){return e.uqBlock(t,e.buildSheet)})),b(o,"Book",(function(t){return e.uqBlock(t,e.buildBook)})),b(u,"Query",(function(t){return e.uqBlock(t,e.buildQuery)})),b(l,"Map",(function(t){return e.uqBlock(t,e.buildMap)})),b(h,"History",(function(t){return e.uqBlock(t,e.buildHistory)})),b(d,"Pending",(function(t){return e.uqBlock(t,e.buildPending)})),b(f,"ID",(function(t){return e.uqBlock(t,e.buildID)})),b(v,"IDX",(function(t){return e.uqBlock(t,e.buildIDX)})),b(p,"IX",(function(t){return e.uqBlock(t,e.buildIX)})),n+="\n}\n",n+="\nexport function assign(uq: any, to:string, from:any): void {\n\tlet hasEntity = uq.hasEntity(to);\n\tif (hasEntity === false) {\n\t\treturn;\n\t}\n\tObject.assign((uq as any)[to], from);\n}\n",(t+=' } from "tonwa-core";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Render, IDXEntity } from "tonwa-'.concat(this.buildContext.uiPlatform,'";'))+n}},{key:"uqEntityInterface",value:function(e,t){if(e.name.indexOf("$")>0)return"";var n=t(e);return n?"\n"+n+"\n":""}},{key:"uqBlock",value:function(e,t){if(e.name.indexOf("$")>0)return"";var n=t(e);return n?"\n"+n:""}},{key:"buildFields",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!e)return"";var a,i="",s=Object(r.a)(e);try{for(s.s();!(a=s.n()).done;){var c=a.value;i+=this.buildField(c,t,n)}}catch(u){s.e(u)}finally{s.f()}return i}},{key:"buildField",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e.name,a=e.type,i=u[a];i||(i="any");var s=!0===t&&o.indexOf(r)>=0?"?":"";return"\n".concat("\t".repeat(n)).concat(r).concat(s,": ").concat(i,";")}},{key:"buildArrs",value:function(e){if(!e)return"";var t,n="\n",a=Object(r.a)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;n+="\t".concat(Object(s.c)(i.name),": {"),n+=this.buildFields(i.fields,!1,2),n+="\n\t}[];\n"}}catch(c){a.e(c)}finally{a.f()}return n}},{key:"buildReturns",value:function(e,t){if(t){var n=e.sName;n=Object(s.d)(n);var a,i="",c=Object(r.a)(t);try{for(c.s();!(a=c.n()).done;){var u=a.value,o=Object(s.d)(u.name);i+="export interface Return".concat(n).concat(o," {"),i+=this.buildFields(u.fields),i+="\n}\n"}}catch(v){c.e(v)}finally{c.f()}i+="export interface Result".concat(n," {\n");var l,h=Object(r.a)(t);try{for(h.s();!(l=h.n()).done;){var d=l.value,f=Object(s.d)(d.name);i+="\t".concat(d.name,": Return").concat(n).concat(f,"[];\n")}}catch(v){h.e(v)}finally{h.f()}return i+="}"}}},{key:"buildActsInterface",value:function(e){var t="\nexport interface ParamActs {";return e.idArr.forEach((function(e){var n=e.sName;t+="\n\t".concat(Object(s.c)(n),"?: ").concat(Object(s.d)(n),"[];")})),e.idxArr.forEach((function(e){var n=e.sName;t+="\n\t".concat(Object(s.c)(n),"?: ActParam").concat(Object(s.d)(n),"[];")})),e.ixArr.forEach((function(e){var n=e.sName;t+="\n\t".concat(Object(s.c)(n),"?: ").concat(Object(s.d)(n),"[];")})),t+="\n}\n"}}]),e}()},,,function(e,t,n){},,,,,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"ui",(function(){return D})),n.d(r,"t",(function(){return P})),n.d(r,"render",(function(){return F}));var a={};n.r(a),n.d(a,"ui",(function(){return L})),n.d(a,"t",(function(){return B})),n.d(a,"render",(function(){return M}));var i={};n.r(i),n.d(i,"ui",(function(){return W})),n.d(i,"t",(function(){return K})),n.d(i,"render",(function(){return z}));var s={};n.r(s),n.d(s,"ui",(function(){return X})),n.d(s,"t",(function(){return Q})),n.d(s,"render",(function(){return J}));var c={};n.r(c),n.d(c,"ui",(function(){return Y})),n.d(c,"t",(function(){return ee})),n.d(c,"render",(function(){return te}));var u={};n.r(u),n.d(u,"ui",(function(){return re})),n.d(u,"t",(function(){return ie})),n.d(u,"render",(function(){return se}));var o={};n.r(o),n.d(o,"ui",(function(){return ue})),n.d(o,"t",(function(){return le})),n.d(o,"render",(function(){return he}));var l={};n.r(l),n.d(l,"ui",(function(){return fe})),n.d(l,"t",(function(){return pe})),n.d(l,"render",(function(){return be}));var h={};n.r(h),n.d(h,"ui",(function(){return je})),n.d(h,"t",(function(){return Oe})),n.d(h,"render",(function(){return ke}));var d={};n.r(d),n.d(d,"ui",(function(){return xe})),n.d(d,"t",(function(){return Ie})),n.d(d,"render",(function(){return Ce}));var f={};n.r(f),n.d(f,"ui",(function(){return _e})),n.d(f,"t",(function(){return Se})),n.d(f,"render",(function(){return qe}));var v={};n.r(v),n.d(v,"ui",(function(){return De})),n.d(v,"t",(function(){return Pe})),n.d(v,"render",(function(){return Fe}));var p={};n.r(p),n.d(p,"ui",(function(){return Le})),n.d(p,"t",(function(){return Be})),n.d(p,"render",(function(){return Me}));var b={};n.r(b),n.d(b,"ui",(function(){return We})),n.d(b,"t",(function(){return Ke})),n.d(b,"render",(function(){return ze}));var m={};n.r(m),n.d(m,"ui",(function(){return Xe})),n.d(m,"t",(function(){return Qe})),n.d(m,"render",(function(){return Je}));var j={};n.r(j),n.d(j,"ui",(function(){return Ze})),n.d(j,"t",(function(){return tt})),n.d(j,"render",(function(){return nt}));var y={};n.r(y),n.d(y,"ui",(function(){return at})),n.d(y,"t",(function(){return st})),n.d(y,"render",(function(){return ct}));var O={};n.r(O),n.d(O,"ui",(function(){return ot})),n.d(O,"t",(function(){return ht})),n.d(O,"render",(function(){return dt}));var k={};n.r(k),n.d(k,"ui",(function(){return pt})),n.d(k,"t",(function(){return mt})),n.d(k,"render",(function(){return jt}));var g={};n.r(g),n.d(g,"ui",(function(){return Ot})),n.d(g,"t",(function(){return gt})),n.d(g,"render",(function(){return xt}));var x={};n.r(x),n.d(x,"ui",(function(){return It})),n.d(x,"t",(function(){return Nt})),n.d(x,"render",(function(){return _t}));var w={};n.r(w),n.d(w,"ui",(function(){return St})),n.d(w,"t",(function(){return Tt})),n.d(w,"render",(function(){return Dt}));var I,C,N;n(56),n(57);function _(e,t,n){!1!==e.hasEntity(t)&&Object.assign(e[t],n)}!function(e){e[e.a=1]="a",e[e.b=2]="b"}(I||(I={})),function(e){e[e.female=0]="female",e[e.male=1]="male"}(C||(C={})),function(e){e[e.staff=10]="staff",e[e.counselor=11]="counselor",e[e.volunteer=12]="volunteer",e[e.board=13]="board",e[e.client=20]="client",e[e.donator=30]="donator"}(N||(N={}));var A=n(13),S=n(9),q=n(0),T={id:{name:"id",type:"id",isKey:!1,label:"Id"},entity:{name:"entity",type:"integer",isKey:!1,widget:"updown",label:"Entity"},content:{name:"content",isKey:!1,label:"Content"}},D={label:"Draft",fieldArr:[T.entity,T.content],fields:T},E={};Object(S.l)(E,{$zh:{},$en:{}});var P=function(e){var t;return null!==(t=E[e])&&void 0!==t?t:e};function F(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var R={id:{name:"id",type:"id",isKey:!1,label:"Id"},value:{name:"value",type:"number",isKey:!1,widget:"number",label:"Value"},stamp:{name:"stamp",isKey:!1,label:"Stamp"}},L={label:"Biz",fieldArr:[R.value,R.stamp],fields:R},V={};Object(S.l)(V,{$zh:{},$en:{}});var B=function(e){var t;return null!==(t=V[e])&&void 0!==t?t:e};function M(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var U={id:{name:"id",type:"id",isKey:!1,label:"Id"},stamp:{name:"stamp",isKey:!1,label:"Stamp"}},W={label:"BizPack",fieldArr:[U.stamp],fields:U},$={};Object(S.l)($,{$zh:{},$en:{}});var K=function(e){var t;return null!==(t=$[e])&&void 0!==t?t:e};function z(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var H={id:{name:"id",type:"id",isKey:!1,label:"Id"},biz:{name:"biz",type:"id",isKey:!1,label:"Biz"},type:{name:"type",isKey:!1,label:"Type"},value:{name:"value",type:"number",isKey:!1,widget:"number",label:"Value"},stamp:{name:"stamp",isKey:!1,label:"Stamp"}},X={label:"Op",fieldArr:[H.biz,H.type,H.value,H.stamp],fields:H},G={};Object(S.l)(G,{$zh:{},$en:{}});var Q=function(e){var t;return null!==(t=G[e])&&void 0!==t?t:e};function J(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var Y={label:"Item",fieldArr:[],fields:{id:{name:"id",type:"id",isKey:!1,label:"Id"}}},Z={};Object(S.l)(Z,{$zh:{},$en:{}});var ee=function(e){var t;return null!==(t=Z[e])&&void 0!==t?t:e};function te(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var ne={id:{name:"id",type:"id",isKey:!1,label:"Id"},opType:{name:"opType",isKey:!0,label:"OpType"},post:{name:"post",type:"id",isKey:!0,label:"Post"},postItem:{name:"postItem",type:"id",isKey:!0,label:"PostItem"},item:{name:"item",type:"id",isKey:!0,label:"Item"},ratio:{name:"ratio",type:"number",isKey:!1,widget:"number",label:"Ratio"},start:{name:"start",isKey:!1,label:"Start"},span:{name:"span",type:"integer",isKey:!1,widget:"updown",label:"Span"},ratioInit:{name:"ratioInit",type:"number",isKey:!1,widget:"number",label:"RatioInit"},memo:{name:"memo",type:"integer",isKey:!1,widget:"updown",label:"Memo"}},re={label:"OpiBooking",fieldArr:[ne.opType,ne.post,ne.postItem,ne.item,ne.ratio,ne.start,ne.span,ne.ratioInit,ne.memo],fields:ne},ae={};Object(S.l)(ae,{$zh:{},$en:{}});var ie=function(e){var t;return null!==(t=ae[e])&&void 0!==t?t:e};function se(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var ce={id:{name:"id",type:"id",isKey:!1,label:"Id"},object:{name:"object",type:"id",isKey:!0,label:"Object"},post:{name:"post",type:"id",isKey:!0,label:"Post"},item:{name:"item",type:"id",isKey:!0,label:"Item"}},ue={label:"Opi",fieldArr:[ce.object,ce.post,ce.item],fields:ce},oe={};Object(S.l)(oe,{$zh:{},$en:{}});var le=function(e){var t;return null!==(t=oe[e])&&void 0!==t?t:e};function he(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var de={id:{name:"id",type:"id",isKey:!1,label:"Id"},op:{name:"op",type:"id",isKey:!0,label:"Op"},item:{name:"item",type:"id",isKey:!0,label:"Item"},value:{name:"value",type:"number",isKey:!1,widget:"number",label:"Value"}},fe={label:"ItemHistory",fieldArr:[de.op,de.item,de.value],fields:de},ve={};Object(S.l)(ve,{$zh:{},$en:{}});var pe=function(e){var t;return null!==(t=ve[e])&&void 0!==t?t:e};function be(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var me={id:{name:"id",type:"id",isKey:!1,label:"Id"},opi:{name:"opi",type:"id",isKey:!1,label:"Opi"},itemHistory:{name:"itemHistory",type:"id",isKey:!1,label:"ItemHistory"},value:{name:"value",type:"number",isKey:!1,widget:"number",label:"Value"},booking:{name:"booking",type:"id",isKey:!1,label:"Booking"}},je={label:"OpiHistory",fieldArr:[me.opi,me.itemHistory,me.value,me.booking],fields:me},ye={};Object(S.l)(ye,{$zh:{},$en:{}});var Oe=function(e){var t;return null!==(t=ye[e])&&void 0!==t?t:e};function ke(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var ge={id:{name:"id",type:"id",isKey:!1,label:"Id"},staff:{name:"staff",type:"id",isKey:!1,label:"Staff"},client:{name:"client",type:"id",isKey:!1,label:"Client"},note:{name:"note",isKey:!1,label:"Note"},sensitive:{name:"sensitive",isKey:!1,label:"Sensitive"}},xe={label:"Note",fieldArr:[ge.staff,ge.client,ge.note,ge.sensitive],fields:ge},we={};Object(S.l)(we,{$zh:{},$en:{}});var Ie=function(e){var t;return null!==(t=we[e])&&void 0!==t?t:e};function Ce(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var Ne={id:{name:"id",type:"id",isKey:!1,label:"Id"},no:{name:"no",type:"string",isKey:!0,widget:"string",label:"No"},name:{name:"name",type:"string",isKey:!1,widget:"string",label:"Name"},vice:{name:"vice",type:"string",isKey:!1,widget:"string",label:"Vice"},firstName:{name:"firstName",type:"string",isKey:!1,widget:"string",label:"FirstName"},lastName:{name:"lastName",type:"string",isKey:!1,widget:"string",label:"LastName"},middleName:{name:"middleName",type:"string",isKey:!1,widget:"string",label:"MiddleName"},gender:{name:"gender",isKey:!1,label:"Gender"},year:{name:"year",type:"integer",isKey:!1,widget:"updown",label:"Year"},month:{name:"month",isKey:!1,label:"Month"},day:{name:"day",isKey:!1,label:"Day"},email:{name:"email",type:"string",isKey:!1,widget:"string",label:"Email"},mobile:{name:"mobile",type:"string",isKey:!1,widget:"string",label:"Mobile"},mobileCountry:{name:"mobileCountry",type:"string",isKey:!1,widget:"string",label:"MobileCountry"}},_e={label:"Person",fieldArr:[Ne.no,Ne.name,Ne.vice,Ne.firstName,Ne.lastName,Ne.middleName,Ne.gender,Ne.year,Ne.month,Ne.day,Ne.email,Ne.mobile,Ne.mobileCountry],fields:Ne},Ae={};Object(S.l)(Ae,{$zh:{},$en:{}});var Se=function(e){var t;return null!==(t=Ae[e])&&void 0!==t?t:e};function qe(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var Te={id:{name:"id",type:"id",isKey:!1,label:"Id"},client:{name:"client",type:"id",isKey:!1,label:"Client"}},De={label:"ClientSurvey",fieldArr:[Te.client],fields:Te},Ee={};Object(S.l)(Ee,{$zh:{},$en:{}});var Pe=function(e){var t;return null!==(t=Ee[e])&&void 0!==t?t:e};function Fe(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var Re={id:{name:"id",type:"id",isKey:!1,label:"Id"},name:{name:"name",type:"string",isKey:!0,widget:"string",label:"Name"}},Le={label:"TagGroup",fieldArr:[Re.name],fields:Re},Ve={};Object(S.l)(Ve,{$zh:{},$en:{}});var Be=function(e){var t;return null!==(t=Ve[e])&&void 0!==t?t:e};function Me(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var Ue={id:{name:"id",type:"id",isKey:!1,label:"Id"},name:{name:"name",type:"string",isKey:!0,widget:"string",label:"Name"},vice:{name:"vice",type:"string",isKey:!1,widget:"string",label:"Vice"},single:{name:"single",isKey:!1,label:"Single"}},We={label:"Tag",fieldArr:[Ue.name,Ue.vice,Ue.single],fields:Ue},$e={};Object(S.l)($e,{$zh:{},$en:{}});var Ke=function(e){var t;return null!==(t=$e[e])&&void 0!==t?t:e};function ze(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var He={id:{name:"id",type:"id",isKey:!1,label:"Id"},name:{name:"name",type:"string",isKey:!0,widget:"string",label:"Name"}},Xe={label:"TagItem",fieldArr:[He.name],fields:He},Ge={};Object(S.l)(Ge,{$zh:{},$en:{}});var Qe=function(e){var t;return null!==(t=Ge[e])&&void 0!==t?t:e};function Je(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var Ye={id:{name:"id",type:"id",isKey:!1,label:"Id"},no:{name:"no",type:"string",isKey:!0,widget:"string",label:"No"},name:{name:"name",type:"string",isKey:!1,widget:"string",label:"Name"},vice:{name:"vice",isKey:!1,label:"Vice"},staff:{name:"staff",type:"id",isKey:!1,label:"Staff"}},Ze={label:"Workshop",fieldArr:[Ye.no,Ye.name,Ye.vice,Ye.staff],fields:Ye},et={};Object(S.l)(et,{$zh:{},$en:{}});var tt=function(e){var t;return null!==(t=et[e])&&void 0!==t?t:e};function nt(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var rt={id:{name:"id",type:"id",isKey:!1,label:"Id"},workshop:{name:"workshop",type:"id",isKey:!1,label:"Workshop"},date:{name:"date",isKey:!1,label:"Date"},vice:{name:"vice",type:"string",isKey:!1,widget:"string",label:"Vice"},time:{name:"time",isKey:!1,label:"Time"},span:{name:"span",type:"integer",isKey:!1,widget:"updown",label:"Span"}},at={label:"Session",fieldArr:[rt.workshop,rt.date,rt.vice,rt.time,rt.span],fields:rt},it={};Object(S.l)(it,{$zh:{},$en:{}});var st=function(e){var t;return null!==(t=it[e])&&void 0!==t?t:e};function ct(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var ut={id:{name:"id",type:"id",isKey:!1,label:"Id"},session:{name:"session",type:"id",isKey:!0,label:"Session"},person:{name:"person",type:"id",isKey:!0,label:"Person"},workshop:{name:"workshop",type:"id",isKey:!1,label:"Workshop"},deleted:{name:"deleted",isKey:!1,label:"Deleted"}},ot={label:"SessionPerson",fieldArr:[ut.session,ut.person,ut.workshop,ut.deleted],fields:ut},lt={};Object(S.l)(lt,{$zh:{},$en:{}});var ht=function(e){var t;return null!==(t=lt[e])&&void 0!==t?t:e};function dt(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}function ft(e,t,n){!1!==e.hasEntity(t)&&Object.assign(e[t],n)}var vt={id:{name:"id",type:"id",isKey:!1,label:"Id"},name:{name:"name",type:"string",isKey:!1,widget:"string",label:"Name"}},pt={label:"Id1",fieldArr:[vt.name],fields:vt},bt={};Object(S.l)(bt,{$zh:{},$en:{}});var mt=function(e){var t;return null!==(t=bt[e])&&void 0!==t?t:e};function jt(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var yt={id:{name:"id",type:"id",isKey:!1,label:"Id"},name:{name:"name",type:"string",isKey:!1,widget:"string",label:"Name"}},Ot={label:"Id2",fieldArr:[yt.name],fields:yt},kt={};Object(S.l)(kt,{$zh:{},$en:{}});var gt=function(e){var t;return null!==(t=kt[e])&&void 0!==t?t:e};function xt(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var wt={id:{name:"id",type:"id",isKey:!1,label:"Id"},name:{name:"name",type:"string",isKey:!1,widget:"string",label:"Name"}},It={label:"Id3",fieldArr:[wt.name],fields:wt},Ct={};Object(S.l)(Ct,{$zh:{},$en:{}});var Nt=function(e){var t;return null!==(t=Ct[e])&&void 0!==t?t:e};function _t(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}var At={id:{name:"id",type:"id",isKey:!1,label:"Id"},name:{name:"name",type:"string",isKey:!1,widget:"string",label:"Name"}},St={label:"Id4",fieldArr:[At.name],fields:At},qt={};Object(S.l)(qt,{$zh:{},$en:{}});var Tt=function(e){var t;return null!==(t=qt[e])&&void 0!==t?t:e};function Dt(e){return Object(q.jsx)(q.Fragment,{children:Object(A.k)(e)})}function Et(e){var t;_(t=e.BzWorkshop,"Draft",r),_(t,"Biz",a),_(t,"BizPack",i),_(t,"Op",s),_(t,"Item",c),_(t,"OpiBooking",u),_(t,"Opi",o),_(t,"ItemHistory",l),_(t,"OpiHistory",h),_(t,"Note",d),_(t,"Person",f),_(t,"ClientSurvey",v),_(t,"TagGroup",p),_(t,"Tag",b),_(t,"TagItem",m),_(t,"Workshop",j),_(t,"Session",y),_(t,"SessionPerson",O),function(e){ft(e,"Id1",k),ft(e,"Id2",g),ft(e,"Id3",x),ft(e,"Id4",w)}(e.BzWorkshopBusTest)}var Pt=n(2),Ft=n(1),Rt=n.n(Ft),Lt=n(49),Vt={version:"0.1.0",uqs:function(){var e=Lt.devs;return Lt.uqs.map((function(t){var n=t.dev,r=t.name,a=t.alias;return{dev:e[n],name:r,alias:a}}))}(),noUnit:!0,oem:void 0,htmlTitle:"Timeschange Workshop"};var Bt=n(8),Mt=n.n(Bt),Ut=n(39),Wt=n.n(Ut),$t=n(18),Kt=n(3),zt=n(4),Ht=n(14),Xt=n(5),Gt=n(6),Qt=n(7),Jt=(Bt.Component,n(45),n(23)),Yt=(Jt.b,Jt.b,function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).page=function(t){return Object(q.jsx)($t.l,{header:"ERROR",children:Object(q.jsxs)("div",{className:"m-3",children:[Object(q.jsx)("div",{className:"p-3 d-flex justify-content-center align-items-center",children:Object(q.jsx)("button",{className:"btn btn-danger",onClick:e.tonwa.resetAll,children:"\u91cd\u542f\u7f51\u9875"})}),Object(q.jsx)("div",{children:"Load Uqs \u53d1\u751f\u9519\u8bef\uff1a"}),t.errors.map((function(e,t){return Object(q.jsx)("div",{children:e},t)}))]})})},e}return Object(zt.a)(n,[{key:"open",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page,{errors:t});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Jt.b)),Zt=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).page=function(e){var t=e.error;return Object(q.jsx)($t.l,{header:"App start error!",children:Object(q.jsx)("pre",{children:"string"===typeof t?t:t.message})})},e}return Object(zt.a)(n,[{key:"open",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page,{error:t});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Jt.b),en=n(10),tn=n(11),nn=function(){function e(t){var n=this;Object(Kt.a)(this,e),this.$_uqMan=void 0,this.$_uqSql=void 0,this.IDRender=function(e,t){return void 0===e||null===e?null:Mt.a.createElement(Object(tn.a)((function(){var r=n.$_uqMan.idCache.getValue(e);if(void 0===r)return Mt.a.createElement("span",{props:{className:"text-muted"},children:["id="+e]});var a=r.$type;if(!a)return n.renderIDUnknownType(e);var i=n.$_uqMan.ids[a];return i?(null!==t&&void 0!==t?t:i.render)(r):n.renderIDUnknownType(e)})))},this.IDV=function(e){return n.$_uqMan.idCache.getValue(e)},this.IDLocalV=function(e){return n.IDV(-e)},this.IDLocalRender=function(e,t){return void 0===e||null===e?null:n.IDRender(-e,t)},this.$_uqMan=t,this.$_uqSql=this.$_createUqSqlProxy()}return Object(zt.a)(e,[{key:"$_createProxy",value:function(){var e=this;return new Proxy(this.$_uqMan.entities,{get:function(t,n,r){if("$"===n)return e;if("SQL"===n)return e.$_uqSql;var a=t[n.toLowerCase()];if(void 0!==a)return a;var i=e.$_uqMan[n];return void 0!==i||void 0!==(i=e[n])?i:void e.errUndefinedEntity(String(n))}})}},{key:"$_createUqSqlProxy",value:function(){var e=this;return new Proxy(this.$_uqMan,{get:function(t,n,r){var a=t["$"+n];if(void 0!==a)return a;e.errUndefinedEntity(String(n))}})}},{key:"errUndefinedEntity",value:function(e){var t="entity ".concat(this.$_uqMan.name,".").concat(e," not defined"),n=new Error(t);throw n.name=A.i.undefined_entity,n}},{key:"renderIDUnknownType",value:function(e){return Mt.a.createElement("span",{props:{className:"text-muted"},children:["id=".concat(e," type undefined")]})}}]),e}();function rn(e){A.f.prototype.tv=function(e,t){var n=this,r=Object(tn.a)((function(){var r,a=n.valueFromId(e);return void 0===a?(n.useId(e),Object(q.jsxs)(q.Fragment,{children:[n.sName,":",e]})):(t?r=t:n.render?r=n.render:(console.log("render",t,"this.render",n.render),r=function(e){return Object(q.jsxs)(q.Fragment,{children:[n.sName,":",Object(A.k)(e)]})}),r(a))}));return Object(q.jsx)(q.Fragment,{children:Object(q.jsx)(r,{})})},A.e.prototype.tv=function(e,t){var n;return null===(n=this.tuidLocal)||void 0===n?void 0:n.tv(e,t)};var t={};function n(e,n){if(e){var r=e.toLowerCase();t[e]=n,r!==e&&(t[r]=n)}}var r,a=Object(en.a)(e.uqMans);try{for(a.s();!(r=a.n()).done;){var i=r.value,s=new nn(i).$_createProxy();n(i.getUqKey(),s),n(i.getUqKeyWithConfig(),s)}}catch(c){a.e(c)}finally{a.f()}return new Proxy(t,{get:function(e,n,r){var a=e[n.toLowerCase()];if(void 0!==a)return a;console.error("controller.uqs.".concat(String(n)," undefined")),function(e){for(var n in t)t[n].localMap.removeAll();console.error("uq proxy ".concat(e," error"))}(String(n))}})}var an=n(34),sn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e,r){var a;if((Object(Kt.a)(this,n),(a=t.call(this,e)).appConfig=void 0,a.uqsMan=void 0,a._uqs=void 0,a.net=void 0,a.timezone=void 0,a.unitTimezone=void 0,a.unitBizMonth=void 0,a.unitBizDate=void 0,a.uqsUser="",a.net=e.net,a.appConfig=r||e.navSettings,a.appConfig)&&void 0===a.appConfig.uqs)throw new Error("uqs must be defined in AppConfig");return a}return Object(zt.a)(n,[{key:"uqs",get:function(){return this._uqs}},{key:"internalT",value:function(e){return Object(an.a)(e)}},{key:"setRes",value:function(e){Object(S.k)(e)}},{key:"afterBuiltUQs",value:function(e){}},{key:"loadUnitTime",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n,r,a,i,s,c;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.query({});case 2:s=e.sent,c=s.ret[0],this.timezone=null!==(n=c.timezone)&&void 0!==n?n:8,this.unitTimezone=null!==(r=c.unitTimeZone)&&void 0!==r?r:8,this.unitBizMonth=(null!==(a=c.unitBizMonth)&&void 0!==a?a:1)-1,this.unitBizDate=null!==(i=c.unitBizDate)&&void 0!==i?i:1;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"bizDate",value:function(e){var t,n,r;t=e.getFullYear(),n=e.getMonth(),r=e.getDate();var a=this.unitBizMonth,i=this.unitBizDate;return i<0?r<-i&&--n:r>=i&&++n,a<0?(n<-a&&--t,n=(n-a)%12):(n>=a&&++t,n=(n+a)%12),new Date(t,n,1)}},{key:"initUQs",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t,n,r,a,i,s;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.appConfig){e.next=2;break}return e.abrupt("return");case 2:if((t=this.tonwa.user)!==this.uqsUser){e.next=5;break}return e.abrupt("return");case 5:return this.uqsUser=t,this.net.logoutApis(),n=this.appConfig,r=n.version,a=n.uqs,i=new A.g(this.tonwa.net,r,a),e.next=11,i.build();case 11:return s=e.sent,this.uqsMan=i.uqsMan,this._uqs=rn(i.uqsMan),this.afterBuiltUQs(this._uqs),e.abrupt("return",s);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"beforeStart",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.onNavRoutes(),e.next=4,this.initUQs();case 4:if(void 0===(t=e.sent)){e.next=8;break}return this.openVPage(Yt,t),e.abrupt("return",!1);case 8:return e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(0),this.openVPage(Zt,e.t0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"afterStart",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t=this;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.tonwa.resolveRoute(),this.tonwa.onChangeLogin=function(e){return t.onChangeLogin(e)},this.onChangeLogin(this.user);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"userFromId",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.net.centerApi.userFromId(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"userFromName",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.net.centerApi.userFromKey(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"on",value:function(){return this.tonwa.on(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},{key:"onNavRoutes",value:function(){}},{key:"getUqRoles",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n,r,a,i;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.tonwa.user){e.next=3;break}return e.abrupt("return",null);case 3:if(r=n.roles,a=t.toLowerCase(),r&&(i=r[a]),!i){e.next=8;break}return e.abrupt("return",i);case 8:return e.next=10,this.uqsMan.getUqUserRoles(a);case 10:return(i=e.sent)||(i=null),this.tonwa.setUqRoles(a,i),e.abrupt("return",i);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onChangeLogin",value:function(e){}}]),n}(Jt.a);function cn(e,t,n,r){return un.apply(this,arguments)}function un(){return(un=Object(Pt.a)(Rt.a.mark((function e(t,n,r,a){var i,s,c,u;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r&&((i=r.htmlTitle)&&(document.title=i),s=document.getElementsByTagName("html"),(c=s[0])&&(null===c||void 0===c?void 0:c.getAttribute("data-version"))),u=new t(n,r),e.next=4,u.start(a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var on=n(17),ln=n(16);Jt.a;A.h,n(27).a;var hn,dn=n(33),fn=n(12),vn=n.n(fn),pn=function(){function e(t,n){var r=this;Object(Kt.a)(this,e),this.net=void 0,this.loader=void 0,this.onLoaded=void 0,this.map=Object(Qt.q)(new Map),this.net=t,void 0===n&&(n=function(e){return r.net.userApi.user(e)}),this.loader=n}return Object(zt.a)(e,[{key:"use",value:function(e,t){e&&("object"===typeof e&&(e=e.id),e&&(this.onLoaded=t,e=Number(e),void 0===this.map.get(e)&&this.map.set(e,e)))}},{key:"getValue",value:function(e){var t=this;if(e){if("object"===typeof e)if(!(e=e.id))return;var n=this.map.get(e);if(n)return"number"===typeof n?(n<0||(this.map.set(e,-e),this.loader(e).then((function(n){n||(n=null),t.map.set(e,n),t.onLoaded&&t.onLoaded(n)})).catch((function(e){console.error(e)}))),e):n}}}]),e}();function bn(e){return void 0===hn&&(hn=new pn(e,void 0)),hn}Object(tn.a)((function(e){var t=e.className,n=e.style,r=e.id,a=e.altImage,i=e.noneImage,s=bn(e.net).getValue(r);switch(typeof s){case"undefined":case"number":return Object(q.jsx)("div",{className:vn()(t,"image-none"),style:n,children:i||Object(q.jsx)("i",{className:"fa fa-file-o"})})}var c=s.icon;return c?(!0===c.startsWith(":")&&(c=S.m.resUrl+c.substr(1)),Object(q.jsx)("img",{src:c,className:t,alt:"img",style:n,onError:function(e){e.currentTarget.src=a||"https://tv.jkchemical.com/imgs/0001.png"}})):Object(q.jsx)("div",{className:vn()(t,"image-none"),style:n,children:Object(q.jsx)("i",{className:"fa fa-file-o"})})})),Object(tn.a)((function(e){var t=e.net,n=e.id,r=e.user,a=e.render,i=e.onLoaded;if(null===r)return Object(q.jsx)(q.Fragment,{children:"null"});var s=bn(t);switch(typeof r){case"undefined":r=s.getValue(n);break;case"object":var c=r.id;mn(t,c,i),r=s.getValue(c);break;case"number":mn(t,r,i),r=s.getValue(r);break;case"string":mn(t,Number(r),i),r=s.getValue(Number(r));break;default:r=void 0}switch(typeof r){case"undefined":case"number":return Object(q.jsx)(q.Fragment,{children:r})}return a(r)}));function mn(e,t,n){t&&("object"===typeof t&&(t=t.id),bn(e).use(t,n))}var jn=n(20),yn=(n(29),n(51),n(70),n(71),n(72),n(37)),On=n(24),kn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;Object(Kt.a)(this,n),(r=t.call(this,e)).timerHandler=void 0,r.reload=function(){clearInterval(r.timerHandler),S.m.reload()};var a=e.seconds;return void 0===a?Object(yn.a)(r):(r.state={seconds:a},a<=0?Object(yn.a)(r):(r.timerHandler=setInterval((function(){var e=r.state.seconds;--e<=0?r.reload():r.setState({seconds:e})}),1e3),r))}return Object(zt.a)(n,[{key:"render",value:function(){var e,t;return this.state.seconds>0?(e="\u7a0b\u5e8f\u5347\u7ea7\u4e2d...",t=this.state.seconds+"\u79d2\u949f\u4e4b\u540e\u81ea\u52a8\u91cd\u542f\u52a8"):(e="\u7a0b\u5e8f\u9700\u8981\u5347\u7ea7",t="\u8bf7\u70b9\u51fb\u4e0b\u9762\u6309\u94ae\u91cd\u542f"),Object(q.jsx)(On.a,{header:!1,children:Object(q.jsxs)("div",{className:"text-center p-5",children:[Object(q.jsxs)("div",{className:"text-info py-5",children:[Object(q.jsx)("span",{className:"text-danger",children:e}),Object(q.jsx)("br",{}),t,Object(q.jsx)("br",{}),Object(q.jsx)("span",{className:"small text-muted",children:this.props.message})]}),Object(q.jsx)("button",{className:"btn btn-danger",onClick:this.reload,children:"\u7acb\u523b\u91cd\u542f"})]})})}}]),n}(Bt.Component),gn=function(e){return Object(q.jsx)(On.a,{header:"\u5347\u7ea7\u8f6f\u4ef6",back:"close",children:Object(q.jsxs)("div",{className:"py-5 px-3 my-5 mx-2 border bg-white rounded",children:[Object(q.jsx)("div",{className:"text-center text-info",children:"\u5347\u7ea7\u5c06\u6e05\u9664\u6240\u6709\u672c\u673a\u7f13\u51b2\u533a\u5185\u5bb9\uff0c\u5e76\u4ece\u670d\u52a1\u5668\u91cd\u65b0\u5b89\u88c5\u7a0b\u5e8f\uff01"}),Object(q.jsx)("div",{className:"text-center mt-5",children:Object(q.jsx)("button",{className:"btn btn-danger me-3",onClick:function(){return e.confirm(!0)},children:"\u786e\u8ba4\u5347\u7ea7"})})]})})},xn=n(35),wn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;return Object(Kt.a)(this,n),(e=t.call(this)).navView=void 0,e.windowOnError=function(e,t,n,r,a){console.error("windowOnError"),console.error(a)},e.windowOnUnhandledRejection=function(e){console.error("windowOnUnhandledRejection"),console.error(e.reason)},e.showPrivacyPage=function(){var t=e.getPrivacyContent();t?e.privacyPage(t):e.navView.push(Object(q.jsx)($t.l,{header:"\u9690\u79c1\u653f\u7b56",children:Object(q.jsx)("div",{className:"p-3",children:"AppConfig \u4e2d\u6ca1\u6709\u5b9a\u4e49 privacy\u3002\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u5b57\u7b26\u4e32\uff0c\u6216\u8005url\u3002markdown\u683c\u5f0f"})}))},e.privacyPage=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){var r;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r={__html:n},e.navView.push(Object(q.jsx)($t.l,{header:"\u9690\u79c1\u653f\u7b56",children:Object(q.jsx)("div",{className:"p-3",dangerouslySetInnerHTML:r})}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.resetAll=function(){e.navView.push(Object(q.jsx)(gn,{confirm:function(t){!0===t?(e.showReloadPage("\u5f7b\u5e95\u5347\u7ea7"),localStorage.clear()):e.navView.pop()}}))},e.upgradeUq=function(){e.start()},Object(Qt.p)(Object(Ht.a)(e),{user:Qt.q}),e.setCreateLogin(xn.a),e}return Object(zt.a)(n,[{key:"createWeb",value:function(){var e={unit:S.d.unit,testing:S.d.testing};return new Cn(e)}},{key:"createObservableMap",value:function(){return Qt.q.map({},{deep:!1})}},{key:"set",value:function(e){this.navView=e}},{key:"nav",get:function(){return this.navView}},{key:"renderNavView",value:function(e,t,n){var r=this;return Object(q.jsx)(dn.a,{ref:function(e){return r.navView=e},onLogined:e,notLogined:t,userPassword:n})}},{key:"beforeStart",value:function(){window.onerror=this.windowOnError,window.onunhandledrejection=this.windowOnUnhandledRejection,window.onfocus=this.reloadUser}},{key:"showAppView",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(n=this.navView.props.onLogined)){e.next=4;break}return this.navView.push(Object(q.jsx)("div",{children:"NavView has no prop onLogined"})),e.abrupt("return");case 4:return this.nav.clear(),e.next=7,n(t);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"privacyEntry",value:function(){if(this.getPrivacyContent())return Object(q.jsx)("div",{className:"text-center",children:Object(q.jsx)("button",{className:"btn btn-sm btn-link",onClick:this.showPrivacyPage,children:Object(q.jsx)("small",{className:"text-muted",children:"\u9690\u79c1\u653f\u7b56"})})})}},{key:"getPrivacyContent",value:function(){if(this.navSettings)return this.navSettings.privacy}},{key:"showRegister",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(xn.c)(this);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showForget",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(xn.b)(this);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showReloadPage",value:function(e){this.navView.push(Object(q.jsx)(kn,{message:e,seconds:-1}))}},{key:"showUpgradeUq",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t,n){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.navView.show(Object(q.jsx)($t.l,{header:!1,children:Object(q.jsxs)("div",{children:["UQ\u5347\u7ea7\u4e86\uff0c\u8bf7\u70b9\u51fb\u6309\u94ae\u5347\u7ea7 ",Object(q.jsx)("br",{}),Object(q.jsxs)("small",{className:"text-muted",children:[t," ver-",n]}),Object(q.jsx)("button",{className:"btn btn-primary",onClick:this.upgradeUq,children:"\u5347\u7ea7"})]})}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(S.a),In=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"getItem",value:function(e){return localStorage.getItem(e)}},{key:"setItem",value:function(e,t){localStorage.setItem(e,t)}},{key:"removeItem",value:function(e){localStorage.removeItem(e)}}]),n}(A.b),Cn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"createLocalDb",value:function(){return new In}},{key:"createObservableMap",value:function(){return new Qt.b}}]),n}(A.d),Nn=n(25),_n=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;Object(Kt.a)(this,e),this.controller=void 0,this.props=void 0,this.controller=t,this.props=n}return Object(zt.a)(e,[{key:"render",value:function(){return null}},{key:"react",value:function(e){var t=Object(Nn.c)(e);return Object(q.jsx)(t,{})}},{key:"res",value:function(e){return e}},{key:"confirm",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.confirm(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderAdmin",value:function(e){return"function"===typeof e&&(e=e()),this.controller.app.renderAdmin(e)}},{key:"renderRole",value:function(e){var t;"function"===typeof e&&(e=e());for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=this.controller.app).renderRole.apply(t,[e].concat(r))}},{key:"renderAdminOrRole",value:function(e){var t;"function"===typeof e&&(e=e());for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=this.controller.app).renderAdminOrRole.apply(t,[e].concat(r))}},{key:"waitingEvent",value:function(e,t,n){var r=this,a=this.beforeWaiting(e.currentTarget);try{t(n).then((function(){r.afterWaiting(a)})).catch((function(e){r.afterWaiting(a),r.controller.app.setError(e)}))}catch(i){this.controller.app.setError(i)}}},{key:"beforeWaiting",value:function(e){var t=e.offsetWidth,n=e.offsetHeight,r=e.disabled,a=e.getAttribute("style");e.disabled=!0,e.setAttribute("style",(null!==a&&void 0!==a?a:"")+" position: relative;");var i=document.createElement("div");return i.setAttribute("style","display:flex; position: absolute; opacity:0.5; left: 0; top: 0; width:".concat(t,"px; height:").concat(n,"px;align-items:center;justify-content:center;")),i.innerHTML='<i class="fa fa-spinner fa-spin" />',e.appendChild(i),{target:e,el:i,disabled:r}}},{key:"afterWaiting",value:function(e){var t=e.target,n=e.el,r=e.disabled;t.disabled=r,t.removeChild(n)}}]),e}(),An=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).callValue=void 0,e}return Object(zt.a)(n,[{key:"header",value:function(){return null}},{key:"right",value:function(){return null}},{key:"content",value:function(){return Object(q.jsx)("div",{className:"p-3",children:this.header})}},{key:"footer",value:function(){return null}},{key:"logout",value:function(){return!1}},{key:"render",value:function(){var e=this,t=this.header();t||(t=!1);var n=this.logout();return Object(q.jsxs)($t.l,{header:t,right:this.right(),footer:this.footer(),onScroll:function(t){return e.onPageScroll(t)},onScrollTop:function(t){return e.onPageScrollTop(t)},onScrollBottom:function(t){return e.onPageScrollBottom(t)},back:this.back,headerClassName:this.headerClassName,className:this.className,tabsProps:this.tabsProps,logout:n,children:[this.renderError(),this.content()]})}},{key:"renderError",value:function(){var e=this;return this.react((function(){var t=e.controller.app,n=t.shallow.error;if(!n)return null;var r=n.name,a=n.message;return Object(q.jsxs)($t.h,{className:"border-bottom bg-light align-items-center text-muted mb-3",left:Object(q.jsx)("div",{className:"cursor-pointer px-3 py-2",onClick:function(){return t.setError(null)},children:Object(q.jsx)($t.d,{name:"times-circle",className:"text-danger",size:"lg"})}),right:Object(q.jsx)("div",{className:"cursor-pointer px-3 py-2",onClick:e.controller.openError,children:Object(q.jsx)($t.d,{name:"angle-right"})}),children:[r," ",a]})}))}},{key:"onPageScroll",value:function(e){}},{key:"onPageScrollTop",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onPageScrollBottom",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"back",get:function(){return"back"}},{key:"headerClassName",get:function(){return null}},{key:"className",get:function(){return null}},{key:"tabsProps",get:function(){return null}}]),n}(_n),Sn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return this.props.name}},{key:"headerClassName",get:function(){return"text-danger bg-warning bg-gradient"}},{key:"back",get:function(){return"close"}},{key:"content",value:function(){var e=this.props,t=e.message,n=e.stack;return Object(q.jsxs)("div",{className:"p-3",children:[Object(q.jsx)("div",{children:t}),Object(q.jsx)("div",{children:n})]})}}]),n}(An),qn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return"..."}},{key:"headerClassName",get:function(){return"bg-secondary"}},{key:"back",get:function(){return"none"}},{key:"content",value:function(){return Object(q.jsx)("div",{className:"p-5 text-center",children:Object(q.jsx)($t.d,{name:"spinner",size:"lg",className:"text-info",spin:!0})})}}]),n}(An);function Tn(e,t){var n={};for(var r in e){switch(typeof e[r]){default:t=Qt.q;case"object":case"function":}n[r]=t}return n}function Dn(e){return Object(Qt.p)(e,Tn(e,Qt.q))}function En(e){return Object(Qt.p)(e,Tn(e,Qt.q.shallow))}function Pn(e){return Object(Qt.s)(e)}function Fn(e){var t=Object(Nn.c)(e);return Mt.a.createElement(t)}var Rn,Ln=function(){function e(t){var n=this;Object(Kt.a)(this,e),this.app=void 0,this.openError=function(){var e=n.app.shallow.error;e&&Pn((function(){n.app.shallow.error=null,n.open(Sn,e)}))},this.app=t}return Object(zt.a)(e,[{key:"waiting",get:function(){}},{key:"res",value:function(e){return e}},{key:"open",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n[0];if("object"===typeof a&&"function"===typeof a.then){var i=!1;return setTimeout((function(){var t,n;void 0!==i&&(e.open(null!==(t=null!==(n=e.waiting)&&void 0!==n?n:e.app.waiting)&&void 0!==t?t:qn),i=!0)}),100),void a.then((function(){!0===i&&e.close(),i=void 0;var t=n[1],r=n[2],a=n[3],s=new t(e,r);e.app.open(s.render(),(function(){return null===a||void 0===a?void 0:a(s)}))}))}var s=a,c=n[1],u=n[2],o=new s(this,c);this.app.open(o.render(),(function(){return null===u||void 0===u?void 0:u(o)}))}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.app.close(e)}},{key:"render",value:function(e,t){return new e(this,t).render()}},{key:"call",value:function(e,t){var n=this;return new Promise(function(){var r=Object(Pt.a)(Rt.a.mark((function r(a,i){return Rt.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n.open(e,t,(function(e){a(e.callValue)}));case 1:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())}},{key:"callReturn",value:function(e,t){e.callValue=t}},{key:"waitFor",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){setTimeout((function(){e()}),t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetch",value:function(e){var t=this;return new Promise((function(n,r){e.then(n).catch((function(e){t.app.setError(e),r(e)}))}))}}]),e}(),Vn=function(){function e(){Object(Kt.a)(this,e),this.shallow=En({error:null})}return Object(zt.a)(e,[{key:"open",value:function(e,t){this.nav.open(e,t)}},{key:"close",value:function(e){this.nav.close(e)}},{key:"waiting",get:function(){return null}},{key:"renderAdmin",value:function(e){return null}},{key:"renderRole",value:function(e){return null}},{key:"renderAdminOrRole",value:function(e){return null}},{key:"setError",value:function(e){var t=this;Pn((function(){t.shallow.error=e?{name:e.name,message:e.message,stack:e.stack}:null}))}}]),e}(),Bn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return this.controller.cId.caption}},{key:"back",get:function(){return"close"}},{key:"right",value:function(){var e;return!1===(null===(e=this.props)||void 0===e?void 0:e.search)?null:Object(q.jsx)($t.n,{className:"me-2",onSearch:this.controller.search})}}]),n}(An),Mn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderItem=function(t,n){var r,a,i,s=e.controller.cId,c=null===(r=e.props)||void 0===r?void 0:r.valueRender;return a=void 0!==c?c(t):s.renderItemOnSelect(t),s.icon&&(i=Object(q.jsx)($t.d,{name:"user-o",className:"me-3 text-primary ",fixWidth:!0})),Object(q.jsxs)("div",{className:"px-3 py-2 align-items-center",children:[i,a]})},e.onItemClick=function(t){e.controller.callReturn(Object(Ht.a)(e),t),e.controller.close()},e}return Object(zt.a)(n,[{key:"content",value:function(){var e,t,n=this;return!1!==(null===(e=this.props)||void 0===e?void 0:e.allowNew)&&(t=Object(q.jsxs)("div",{className:"px-3 py-2 align-items-center cursor-pointer mb-3 bg-white",onClick:this.controller.onNew,children:[Object(q.jsx)($t.d,{name:"plus",className:"me-3 text-warning",fixWidth:!0}),"New ",this.controller.cId.caption]})),this.react((function(){return Object(q.jsxs)("div",{className:"",children:[t,Object(q.jsx)($t.i,{items:n.controller.shallowData.items,item:{render:n.renderItem,onClick:n.onItemClick}})]})}))}}]),n}(Bn),Un=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;return Object(Kt.a)(this,n),(r=t.call(this,e.app)).cId=void 0,r.shallowData=En({items:null}),r.search=function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.cId.search(null!==t&&void 0!==t?t:"");case 2:n=e.sent,Pn((function(){r.shallowData.items=n}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.onNew=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.cId.setAfterAdd(function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.cId.loadItemsFromIds(t);case 2:n=e.sent,Pn((function(){var e;(e=r.shallowData.items).unshift.apply(e,Object(jn.a)(n))}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=3,r.cId.onAdd();case 3:case"end":return e.stop()}}),e)}))),r.cId=e,r}return Object(zt.a)(n,[{key:"select",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1===(null===t||void 0===t?void 0:t.listAll)){e.next=3;break}return e.next=3,this.search(void 0);case 3:return e.next=5,this.call(this.VSelect,t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Ln),Wn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"VSelect",get:function(){return Mn}}]),n}(Un),$n=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onSave=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n,r){var a;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.data,t.next=3,e.controller.onSaveId(a);case 3:e.controller.close(),e.controller.open(Kn);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(zt.a)(n,[{key:"header",value:function(){return"New "+this.controller.caption}},{key:"renderForm",value:function(){var e=this.controller,t=e.schema,n=e.uiSchema;return t=[].concat(Object(jn.a)(t),[{name:"submit",type:"submit"}]),Object(q.jsx)($t.e,{schema:t,uiSchema:n,fieldLabelSize:2,onButtonClick:this.onSave})}},{key:"content",value:function(){return Object(q.jsx)("div",{className:"p-3",children:this.renderForm()})}}]),n}(An),Kn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onNext=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.controller.close(),t.next=3,e.controller.onAdd();case 3:case"end":return t.stop()}}),t)}))),e.onExit=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.controller.close();case 1:case"end":return t.stop()}}),t)}))),e}return Object(zt.a)(n,[{key:"header",value:function(){return"Saved"}},{key:"back",get:function(){return"close"}},{key:"content",value:function(){return Object(q.jsx)("div",{children:Object(q.jsxs)("div",{className:"m-5 border border-warning rounded-3 bg-white w-30c p-5 mx-auto",children:[Object(q.jsx)("div",{className:"text-center",children:"Saved OK! "}),Object(q.jsxs)("div",{className:"mt-5 text-center",children:[Object(q.jsx)("button",{className:"btn btn-primary me-3",onClick:this.onNext,children:"Continue Input"}),Object(q.jsx)("button",{className:"btn btn-outline-primary",onClick:this.onExit,children:"Exit"})]})]})})}}]),n}(An),zn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderItem=function(t,n){var r,a=e.controller,i=a.icon,s=a.iconClass;i&&(r=Object(q.jsx)($t.d,{name:i,className:"me-4 "+(null!==s&&void 0!==s?s:"text-primary"),fixWidth:!0,size:"lg"}));var c=Object(q.jsx)($t.d,{name:"angle-right"});return Object(q.jsx)($t.h,{className:"px-3 py-2 align-items-center",left:r,right:c,children:Object(q.jsx)("div",{children:e.controller.renderItemInList(t)})})},e}return Object(zt.a)(n,[{key:"header",value:function(){return this.controller.caption}},{key:"right",value:function(){return Object(q.jsx)("button",{className:"btn btn-sm btn-success me-2",onClick:this.controller.onAdd,children:Object(q.jsx)($t.d,{name:"plus"})})}},{key:"content",value:function(){var e=this;return this.react((function(){return Object(q.jsx)($t.i,{items:e.controller.deepData.list,item:{render:e.renderItem,onClick:e.controller.onEditItem}})}))}}]),n}(An),Hn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).propValueSave=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n,r){var a;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.controller.deepData,t.next=3,e.controller.savePropValue(a.currentItem.id,n,r);case 3:Pn((function(){a.currentItem[n]=r}));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(zt.a)(n,[{key:"header",value:function(){return this.controller.caption+" "+this.controller.deepData.currentItem.no}},{key:"renderProps",value:function(){var e=this;return this.react((function(){var t=e.controller,n=t.schema,r=t.uiSchema,a=t.deepData.currentItem;r||(r={items:{}});var i=n.map((function(t,n){var i,s,c,u,o=t.name,l=r.items[o];l?(i=null!==(u=l.label)&&void 0!==u?u:o,s=l.readOnly,c=l.pick):(i=o,s=!1);var h,d=a[o],f=pr(e.controller.app,{pick:c,itemSchema:t,uiItem:l,value:d,onChanged:e.propValueSave}),v=f.renderEditIcon(),p="mb-3 row bg-white align-items-center ";return!0===s?h=void 0:(h=f.onEdit,p+="cursor-pointer "),Object(q.jsxs)("div",{onClick:h,className:p,children:[Object(q.jsx)("label",{className:"col-sm-2 col-form-label",children:i}),Object(q.jsx)("div",{className:"col-sm-10",children:Object(q.jsx)($t.h,{right:!0!==s&&v,children:f.renderRef()})})]},n)}));return Object(q.jsx)("div",{className:"container",children:i})}))}},{key:"content",value:function(){return Object(q.jsxs)("div",{className:"py-3",children:[this.renderProps(),this.renderTagInput()]})}},{key:"renderTagInput",value:function(){var e=this.controller.renderTagInput();return e?Object(q.jsxs)("div",{className:"my-3 border rounded-3 pt-2",children:[Object(q.jsx)("div",{className:"px-3 pb-2 small text-muted",children:"Tags"}),e]}):null}}]),n}(An),Xn=function(){function e(t){Object(Kt.a)(this,e),this.shallowData=En({cache:new Map}),this.cId=void 0,this.cId=t}return Object(zt.a)(e,[{key:"getValue",value:function(e){var t=this.shallowData.cache.get(e);return null===t?null:(void 0===t&&this.loadValue(e),t)}},{key:"loadValue",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.cId.loadValue(t);case 3:n=e.sent,this.setCache(t,n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.setCache(t,null);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setCache",value:function(e,t){var n=this;Pn((function(){return n.shallowData.cache.set(e,t)}))}}]),e}();function Gn(e){return Object(q.jsx)("small",{className:"text-muted",children:e})}!function(e){e[e.listAll=0]="listAll",e[e.search=1]="search",e[e.listAndSearch=2]="listAndSearch"}(Rn||(Rn={}));var Qn={},Jn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).cache=void 0,e.ID=void 0,e.initNO=void 0,e.deepData=Dn({list:null,currentItem:null}),e.addedIds=void 0,e.afterAddCallback=void 0,e.onAdd=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.addedIds=[],t.next=3,e.initAdd();case 3:e.open(e.VAdd,e.afterAdded);case 4:case"end":return t.stop()}}),t)}))),e.afterAdded=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.afterAddCallback){t.next=6;break}return t.next=3,e.afterAddCallback(e.addedIds);case 3:e.afterAddCallback=void 0,t.next=8;break;case 6:return t.next=8,e.loadToList();case 8:case"end":return t.stop()}}),t)}))),e.onEditItem=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Pn(Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.deepData.currentItem=n,e.open(e.beforeEdit(),e.VEdit);case 2:case"end":return t.stop()}}),t)}))));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(zt.a)(n,[{key:"initID",value:function(){this.ID=this.getID();var e=this.ID.name;this.cache=Qn[e],void 0===this.cache&&(this.cache=new Xn(this),Qn[e]=this.cache)}},{key:"icon",get:function(){return null}},{key:"iconClass",get:function(){}},{key:"isGlobal",get:function(){return this.ID.isGlobal}},{key:"getIdValue",value:function(e){return this.cache.getValue(e)}},{key:"setIDDeepList",value:function(e){this.deepData.list=e}},{key:"initAdd",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t,n=this;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.ID)){e.next=6;break}return e.next=4,this.uq.IDNO({ID:t});case 4:this.initNO=e.sent,Pn((function(){n.deepData.currentItem=null}));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setAfterAdd",value:function(e){this.afterAddCallback=e}},{key:"VAdd",get:function(){return $n}},{key:"ids",get:function(){return this.addedIds}},{key:"loadValue",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uq.ID({IDX:this.ID,id:t});case 2:if(0!==(n=e.sent).length){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",n[0]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadToList",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t,n=this;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadList();case 2:t=e.sent,Pn((function(){n.setIDDeepList(t)}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onSaveId",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveId(t);case 2:n=e.sent,this.addedIds.push(n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"savePropValue",value:function(e,t,n){}},{key:"search",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"VStart",get:function(){return zn}},{key:"openMain",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.open(this.VStart),e.next=3,this.loadToList();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"VEdit",get:function(){return Hn}},{key:"beforeEdit",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"renderItemInList",value:function(e){return this.renderIdValue(e)}},{key:"renderItemOnSelect",value:function(e){return this.renderItemInList(e)}},{key:"renderId",value:function(e){var t=this;return Fn((function(){var n=t.getIdValue(e);return null===n||void 0===n?Gn(e):t.renderIdValue(n)}))}}]),n}(Ln),Yn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"render",value:function(){var e=this.controller,t=e.shallowValue,n=e.props.pick;return n?n.ref():this.react((function(){var e=t.value;return Object(q.jsx)("div",{children:null!==e&&void 0!==e?e:Object(q.jsx)("small",{className:"text-muted",children:" - "})})}))}}]),n}(_n),Zn=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"render",value:function(){return Object(q.jsx)($t.d,{name:"pencil-square-o",className:"text-primary"})}}]),n}(_n),er=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e,r){var a;return Object(Kt.a)(this,n),(a=t.call(this,e)).props=void 0,a.shallowValue=void 0,a.onEdit=function(){a.open(a.Page)},a.props=r,a.shallowValue=En({value:r.value}),a}return Object(zt.a)(n,[{key:"renderRef",value:function(){return this.render(Yn)}},{key:"label",get:function(){var e,t=this.props,n=t.itemSchema,r=t.uiItem;return null!==(e=null===r||void 0===r?void 0:r.label)&&void 0!==e?e:n.name}},{key:"renderEditIcon",value:function(){return this.render(Zn)}},{key:"verifyValue",value:function(e){var t=this.props.uiItem;if(void 0!==t){var n=t.rules;if(void 0!==n){if(!Array.isArray(n))return s(n,e);var r,a=Object(en.a)(n);try{for(a.s();!(r=a.n()).done;){var i=s(r.value,e);if(void 0!==i)return i}}catch(c){a.e(c)}finally{a.f()}}}function s(e,t){var n=e(t);if(void 0!==n)return"object"!==typeof n?n:JSON.stringify(n)}}},{key:"Page",get:function(){}}]),n}(Ln),tr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e,r){var a;return Object(Kt.a)(this,n),(a=t.call(this,e,r)).onChange=function(e){var t=e.target.checked,n=a.props;(0,n.onChanged)(n.itemSchema.name,t),Pn((function(){a.shallowValue.value=t}))},a.onEdit=void 0,a}return Object(zt.a)(n,[{key:"renderRef",value:function(){return Object(q.jsx)("label",{className:"form-check-inline w-100 h-100",children:Object(q.jsx)("input",{type:"checkbox",className:"ms-1",defaultChecked:this.shallowValue.value,onChange:this.onChange})})}},{key:"renderEditIcon",value:function(){return null}}]),n}(er),nr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n)}(er),rr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).shallowData=En({isChanged:!1,error:null}),e.value=void 0,e.onSave=Object(Pt.a)(Rt.a.mark((function t(){var n,r,a;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.controller.props,r=n.onChanged,a=n.itemSchema,r(a.name,e.value),e.controller.close();case 3:case"end":return t.stop()}}),t)}))),e.onChange=function(t){Pn((function(){e.value=t.target.value,e.shallowData.isChanged=e.value!==e.controller.shallowValue.value}))},e.onBlur=function(t){Pn((function(){e.shallowData.error=e.controller.verifyValue(e.value)}))},e.onFocus=function(){Pn((function(){e.shallowData.error=void 0}))},e}return Object(zt.a)(n,[{key:"header",value:function(){return this.controller.label}},{key:"right",value:function(){var e=this;return this.react((function(){return Object(q.jsx)("button",{className:"btn btn-sm btn-success align-self-center me-2",disabled:!e.shallowData.isChanged,onClick:e.onSave,children:e.res("Save")})}))}},{key:"content",value:function(){var e=this,t=this.shallowData.error,n=this.controller.props,r=n.uiItem,a=n.exView;return Object(q.jsxs)("div",{className:"m-3",children:[Object(q.jsx)("input",{type:this.InputType,onChange:this.onChange,onKeyDown:function(t){!1!==e.shallowData.isChanged&&"Enter"===t.key&&e.onSave()},onBlur:this.onBlur,onFocus:this.onFocus,className:"form-control",defaultValue:this.controller.shallowValue.value}),Object(q.jsx)("div",{className:"small muted m-2",children:null===r||void 0===r?void 0:r.placeholder}),t&&Object(q.jsx)("div",{className:"text-danger",children:t}),a]})}}]),n}(An),ar=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"Page",get:function(){return ir}}]),n}(nr),ir=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"InputType",get:function(){return"text"}}]),n}(rr),sr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"Page",get:function(){return cr}}]),n}(nr),cr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"InputType",get:function(){return"date"}}]),n}(rr),ur=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"Page",get:function(){return or}}]),n}(nr),or=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"InputType",get:function(){return"datetime"}}]),n}(rr),lr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"Page",get:function(){return hr}}]),n}(nr),hr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"InputType",get:function(){return"time"}}]),n}(rr),dr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"Page",get:function(){return fr}}]),n}(er),fr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return this.controller.label}},{key:"content",value:function(){return Object(q.jsx)("div",{children:"select id"})}}]),n}(An),vr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onEdit=Object(Pt.a)(Rt.a.mark((function t(){var n,r,a,i,s;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.props.pick){t.next=4;break}return alert("pick not defined in CPickEdit"),t.abrupt("return");case 4:return t.next=6,n.pick();case 6:if(r=t.sent,!(a=e.props.onChanged)){t.next=15;break}if(i=e.shallowValue.value,r===i){t.next=15;break}return s=e.props.itemSchema,t.next=14,a(s.name,r);case 14:e.shallowValue.value=r;case 15:case"end":return t.stop()}}),t)}))),e}return Object(zt.a)(n,[{key:"renderRef",value:function(){var e=this.props.pick;return e?e.ref():Object(q.jsx)("span",{children:"pick is not defined"})}}]),n}(er);function pr(e,t){var n=t.itemSchema,r=t.uiItem;if(void 0===r)return n.type,new ar(e,t);switch(r.widget){case"date":return new sr(e,t);case"datetime":return new ur(e,t);case"time":return new lr(e,t);case"id":return new dr(e,t);case"pick":return new vr(e,t);case"checkbox":return new tr(e,t);default:return new ar(e,t)}}var br,mr=n(19),jr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onSave=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n,r){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.onSaveTag(r.data);case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(zt.a)(n,[{key:"header",value:function(){return"Add tag"}},{key:"content",value:function(){var e={items:{name:{widget:"text",label:"Name"},vice:{widget:"text",label:"Discription"},single:{widget:"checkbox",label:"Singular",defaultValue:0,trueValue:1,falseValue:0},submit:{widget:"button",label:Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)($t.d,{name:"floppy-o"})," Submit"]}),className:"btn btn-primary"}}};return Object(q.jsx)("div",{className:"p-3",children:Object(q.jsx)($t.e,{schema:[{name:"name",type:"string",maxLength:50,required:!0},{name:"vice",type:"string",maxLength:100},{name:"single",type:"number"},{name:"submit",type:"submit"}],uiSchema:e,fieldLabelSize:2,onButtonClick:this.onSave})})}}]),n}(An),yr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onSave=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n,r){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.onSaveTagItem(r.data);case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(zt.a)(n,[{key:"header",value:function(){return"Add tag"}},{key:"content",value:function(){var e={items:{name:{widget:"text",label:"Name"},submit:{widget:"button",label:Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)($t.d,{name:"floppy-o"})," Submit"]}),className:"btn btn-primary"}}};return Object(q.jsx)("div",{className:"p-3",children:Object(q.jsx)($t.e,{schema:[{name:"name",type:"string",maxLength:50,required:!0},{name:"submit",type:"submit"}],uiSchema:e,fieldLabelSize:2,onButtonClick:this.onSave})})}}]),n}(An),Or=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onClick=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.stopPropagation(),!0!==window.confirm("Do you really want to delete?")){t.next=4;break}return t.next=4,e.props();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(zt.a)(n,[{key:"render",value:function(){return Object(q.jsx)("div",{className:"mt-4 d-flex justify-content-end",children:Object(q.jsxs)("div",{onClick:this.onClick,className:"px-3 py-2 cursor-pointer text-primary",children:[Object(q.jsx)($t.d,{name:"trash"})," Delete the item"]})})}}]),n}(_n),kr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onRemoveTag=Object(Pt.a)(Rt.a.mark((function t(){var n,r;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.controller.deep.currentTag,r=n.name,t.next=4,e.confirm("Do you really want to remove tag '".concat(r,"'?"));case 4:if(!0!==t.sent){t.next=8;break}return t.next=8,e.controller.removeTag(n);case 8:case"end":return t.stop()}}),t)}))),e.renderItem=function(e,t){var n=e.name,r=Object(q.jsx)($t.d,{className:"text-info me-3",name:"square-o"});return Object(q.jsx)($t.h,{className:"px-3 py-2 align-items-center",left:r,children:n})},e.onItemClick=function(t){e.controller.onEditTagItem(t)},e}return Object(zt.a)(n,[{key:"header",value:function(){return"Edit "+this.controller.deep.currentTag.name}},{key:"right",value:function(){return Object(q.jsx)("button",{className:"btn btn-sm btn-light me-2",onClick:this.onRemoveTag,children:Object(q.jsx)($t.d,{name:"trash"})})}},{key:"content",value:function(){var e=this,t=Object(q.jsxs)("button",{className:"btn btn-sm btn-success",onClick:this.controller.onAddTagItem,children:[Object(q.jsx)($t.d,{name:"plus"})," Item"]});return this.react((function(){return Object(q.jsxs)("div",{children:[e.renderProps(),Object(q.jsx)($t.h,{className:"mt-4 mb-1 px-3",right:t,children:"Items"}),Object(q.jsx)($t.i,{items:e.controller.deep.items,item:{render:e.renderItem,onClick:e.onItemClick}})]})}))}},{key:"renderProps",value:function(){var e=this;return this.react((function(){var t=e.controller.deep,n={items:{name:{label:"Name"},vice:{label:"Discription"},single:{widget:"checkbox",label:"Singular",defaultValue:0,trueValue:1,falseValue:0}}},r=t.currentTag;n||(n={items:{}});var a=[{name:"name",type:"string",required:!0},{name:"vice",type:"string"},{name:"single",type:"number"}].map((function(t,a){var i,s,c,u=t.name,o=n.items[u];o?(i=null!==(c=o.label)&&void 0!==c?c:u,s=o.readOnly):(i=u,s=!1);var l,h=r[u],d=pr(e.controller.app,{itemSchema:t,uiItem:o,value:h,onChanged:e.controller.tagPropSave}),f=d.renderEditIcon(),v="mb-1 row bg-white align-items-center ";return!0===s?l=void 0:(l=d.onEdit,v+="cursor-pointer "),Object(q.jsxs)("div",{onClick:l,className:v,children:[Object(q.jsx)("label",{className:"col-sm-2 col-form-label",children:i}),Object(q.jsx)("div",{className:"col-sm-10",children:Object(q.jsx)($t.h,{right:!0!==s&&f,children:d.renderRef()})})]},a)}));return Object(q.jsx)("div",{className:"container",children:a})}))}}]),n}(An),gr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return"Tags admin"}},{key:"content",value:function(){var e=this,t=this.controller,n=t.icon,r=t.iconClass;return Object(q.jsx)("div",{className:"",children:this.controller.groups.map((function(t,a){var i=t.name,s=t.vice,c=Object(q.jsx)($t.d,{name:n,className:r+" me-3",size:"lg"}),u=Object(q.jsx)($t.d,{name:"angle-right"});return Object(q.jsx)($t.h,{onClick:function(){return e.controller.openTagGroup(t)},className:"px-3 py-2 cursor-pointer mb-1 bg-white align-items-center",left:c,right:u,children:null!==s&&void 0!==s?s:i},a)}))})}}]),n}(An),xr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderTag=function(t,n){var r=t.name,a=t.vice,i=Object(q.jsx)($t.d,{name:e.controller.icon,className:"text-info me-3"}),s=Object(q.jsx)($t.d,{name:"angle-right"});return Object(q.jsxs)($t.h,{className:"px-3 py-2 align-items-center",left:i,right:s,children:[Object(q.jsx)("div",{children:r}),Object(q.jsx)("div",{className:"small text-muted",children:a})]})},e.onTagClick=function(t){e.controller.onEditTag(t)},e}return Object(zt.a)(n,[{key:"header",value:function(){var e=this.controller.currentGroup,t=e.name,n=e.vice;return null!==n&&void 0!==n?n:t}},{key:"right",value:function(){return Object(q.jsxs)("button",{className:"btn btn-sm btn-success me-2",onClick:this.controller.onAddTag,children:[Object(q.jsx)($t.d,{name:"plus"})," Tag"]})}},{key:"content",value:function(){var e=this;return this.react((function(){return Object(q.jsx)("div",{className:"",children:Object(q.jsx)($t.i,{items:e.controller.deep.tags,item:{render:e.renderTag,onClick:e.onTagClick}})})}))}}]),n}(An),wr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).currentGroup=void 0,e.tagGroups={},e.deep=Dn({tags:null,items:null,currentTag:null}),e.groupsLoaded=!1,e.onAddTag=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.open(e.VAddTag);case 1:case"end":return t.stop()}}),t)}))),e.onSaveTag=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){var r;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.uq.ActIX({IX:e.IxTag,ID:e.Tag,values:[{ix:e.currentGroup.id,xi:n}]});case 2:r=t.sent,n.id=r[0],e.close(),Pn((function(){e.deep.tags.push(n),e.resetGroups()}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onEditTag=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){var r;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Pn((function(){e.deep.currentTag=n,e.open(e.VEditTag)})),t.next=3,e.uq.IX({IX:e.IxTag,ix:n.id,IDX:[e.TagItem]});case 3:r=t.sent,Pn((function(){e.deep.items=r}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onAddTagItem=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.open(e.VAddTagItem);case 1:case"end":return t.stop()}}),t)}))),e.onSaveTagItem=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){var r;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.uq.ActIX({IX:e.IxTag,ID:e.TagItem,values:[{ix:e.deep.currentTag.id,xi:n}]});case 2:r=t.sent,n.id=r[0],e.close(),Pn((function(){e.resetGroups(),e.deep.items.push(n)}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onEditTagItem=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){var r,a;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=function(){var t=Object(Pt.a)(Rt.a.mark((function t(r,a){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.name=a,t.next=3,e.uq.ActIDProp(e.TagItem,n.id,"name",a);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),a=function(){var t=Object(Pt.a)(Rt.a.mark((function t(){var r,a,i;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.deep,a=r.currentTag,i=r.items,t.next=3,e.uq.ActIX({IX:e.IxTag,values:[{ix:a.id,xi:-n.id}]});case 3:e.close(),Pn((function(){var e=i.findIndex((function(e){return e===n}));e>=0&&i.splice(e,1)}));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),new ar(e.app,{itemSchema:{name:"name",type:"string",maxLength:50,required:!0},uiItem:{widget:"text",label:"Edit tag item"},onChanged:r,value:n.name,exView:e.render(Or,a)}).onEdit();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.tagPropSave=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n,r){var a,i;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Object(Ht.a)(e),i=a.deep,t.next=3,e.uq.ActIDProp(e.Tag,i.currentTag.id,n,r);case 3:Pn((function(){i.currentTag[n]=r,e.resetGroups()}));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(zt.a)(n,[{key:"VStart",get:function(){return gr}},{key:"resetGroups",value:function(){for(var e in this.tagGroups){this.tagGroups[e].tick=0}this.groupsLoaded=!1}},{key:"loadGroups",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t,n,r,a;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.groupsLoaded){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.uq.ID({IDX:this.TagGroup,id:void 0});case 4:t=e.sent,n=Object(en.a)(this.groups);try{for(a=function(){var e=r.value,n=t.find((function(t){return t.name===e.name}));if(!n)throw Error("".concat(e.name," is not defined in UQ"));e.id=n.id},n.s();!(r=n.n()).done;)a()}catch(i){n.e(i)}finally{n.f()}this.groupsLoaded=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"openMain",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadGroups();case 2:this.open(this.VStart);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"VTagGroup",get:function(){return xr}},{key:"openTagGroup",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n,r=this;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentGroup=t,e.next=3,this.uq.IX({IX:this.IxTag,ix:t.id,IDX:[this.Tag]});case 3:n=e.sent,this.open(this.VTagGroup),Pn((function(){r.deep.tags=n}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"VAddTag",get:function(){return jr}},{key:"VEditTag",get:function(){return kr}},{key:"removeTag",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n=this;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uq.ActIX({IX:this.IxTag,values:[{ix:this.currentGroup.id,xi:-t.id}]});case 2:this.close(),Pn((function(){n.resetGroups();var e=n.deep.tags,r=e.findIndex((function(e){return e===t}));r>=0&&e.splice(r,1)}));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"VAddTagItem",get:function(){return yr}},{key:"loadGroup",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n,r,a,i,s,c,u,o,l,h,d,f,v,p,b,m;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(n=this.tagGroups[t])){e.next=7;break}if(r=n.tick,!(Date.now()-r<36e5)){e.next=5;break}return e.abrupt("return",n);case 5:n=void 0,this.tagGroups[t]=void 0;case 7:return e.next=9,this.loadGroups();case 9:if(void 0!==(a=this.groups.find((function(e){return e.name===t})))){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,this.uq.IX({IX:this.IxTag,ix:a.id,IDX:[this.Tag]});case 14:return i=e.sent,e.next=17,this.uq.IX({IX:this.IxTag,IX1:this.IxTag,ix:a.id,IDX:[this.TagItem]});case 17:s=e.sent,c={},u=[],o=Object(en.a)(i);try{for(o.s();!(l=o.n()).done;)h=l.value,d=Object(mr.a)({items:[]},h),c[h.id]=d,u.push(d)}catch(j){o.e(j)}finally{o.f()}f=Object(en.a)(s),e.prev=23,f.s();case 25:if((v=f.n()).done){e.next=34;break}if(p=v.value,b=p.ix,m=c[b]){e.next=31;break}return e.abrupt("continue",32);case 31:m.items.push(p);case 32:e.next=25;break;case 34:e.next=39;break;case 36:e.prev=36,e.t0=e.catch(23),f.e(e.t0);case 39:return e.prev=39,f.f(),e.finish(39);case 42:return n={name:a.name,tick:Date.now(),tags:u},e.abrupt("return",this.tagGroups[t]=n);case 44:case"end":return e.stop()}}),e,this,[[23,36,39,42]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(Ln),Ir=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderTagItem=function(t,n,r){var a,i,s=e.controller.shallow,c=t.single,u=t.name;return 1===c?(a="radio",i="tag-radio-"+u):a="checkbox",Object(q.jsx)(Mt.a.Fragment,{children:e.react((function(){var r=n.id,c=n.name,u=s.tagMap.get(r);return Object(q.jsxs)("label",{className:"w-min-8c me-3 my-2",children:[Object(q.jsx)("input",{className:"form-check-input",type:a,name:i,defaultChecked:u,value:r,onChange:function(r){return e.controller.onCheckChange(t,n,r.currentTarget.checked)}})," ",c]})}))},r)},e}return Object(zt.a)(n,[{key:"render",value:function(){var e=this,t=this.controller.tagGroup;return t?0===t.tags.length?null:Object(q.jsx)("div",{className:"container",children:t.tags.map((function(t,n){var r=t.name,a=t.items;return Object(q.jsxs)("div",{className:"row mb-1 py-2 bg-white",children:[Object(q.jsx)("div",{className:"col-2 ps-3 pt-1",children:r}),Object(q.jsx)("div",{className:"col-10",children:a.map((function(n,r){return e.renderTagItem(t,n,r)}))})]},n)}))}):null}}]),n}(_n),Cr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e,r,a){var i;return Object(Kt.a)(this,n),(i=t.call(this,e.app)).cTag=void 0,i.cId=void 0,i.IxID=void 0,i.tagGroup=void 0,i.id=void 0,i.shallow=En({tagMap:new Map}),i.onCheckChange=function(){var e=Object(Pt.a)(Rt.a.mark((function e(t,n,r){var a,s,c,u,o,l,h;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i.shallow.tagMap,s=n.id,c=[],1!==t.single){e.next=28;break}u=Object(en.a)(t.items),e.prev=5,u.s();case 7:if((o=u.n()).done){e.next=15;break}if((l=o.value)!==n){e.next=11;break}return e.abrupt("continue",13);case 11:h=l.id,!0===a.get(h)&&c.push({ix:i.id,xi:-h});case 13:e.next=7;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),u.e(e.t0);case 20:return e.prev=20,u.f(),e.finish(20);case 23:if(!1!==r){e.next=25;break}throw Error("radio should not be false");case 25:c.push({ix:i.id,xi:s}),e.next=29;break;case 28:c.push({ix:i.id,xi:!0===r?s:-s});case 29:return e.next=31,i.cTag.uq.ActIX({IX:i.IxID,values:c});case 31:Pn((function(){var e,t=Object(en.a)(c);try{for(t.s();!(e=t.n()).done;){var n=e.value.xi,r=void 0,i=void 0;n<0?(r=-n,i=!1):(r=n,i=!0),a.set(r,i)}}catch(s){t.e(s)}finally{t.f()}}));case 32:case"end":return e.stop()}}),e,null,[[5,17,20,23]])})));return function(t,n,r){return e.apply(this,arguments)}}(),i.cTag=e,i.cId=r,i.IxID=a,i}return Object(zt.a)(n,[{key:"beforeEdit",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t,n){var r,a=this;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cTag.loadGroup(t);case 2:return this.tagGroup=e.sent,this.id=n,e.next=6,this.cId.uq.IX({IX:this.IxID,ix:n});case 6:r=e.sent,Pn((function(){var e=a.shallow.tagMap;e.clear();var t,n=Object(en.a)(r);try{for(n.s();!(t=n.n()).done;){var i=t.value.xi;e.set(i,!0)}}catch(p){n.e(p)}finally{n.f()}var s,c=Object(en.a)(a.tagGroup.tags);try{for(c.s();!(s=c.n()).done;){var u=s.value,o=u.single,l=u.items;if(1===o){var h,d=!1,f=Object(en.a)(l);try{for(f.s();!(h=f.n()).done;){var v=h.value.id;!0===d?!0===e.get(v)&&e.set(v,!1):!0===e.get(v)&&(d=!0)}}catch(p){f.e(p)}finally{f.f()}}}}catch(p){c.e(p)}finally{c.f()}}));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"InputView",get:function(){return Ir}},{key:"renderInput",value:function(){return this.render(this.InputView)}}]),n}(Ln),Nr=" px-3 py-2 ",_r=" bg-white ",Ar=" my-2 ",Sr=" small text-muted ",qr=Object(q.jsx)($t.d,{className:"text-primary me-3 mt-1",name:"info-circle",size:"lg"}),Tr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return"System admin"}},{key:"content",value:function(){switch(this.controller.deep.meAdmin.role){default:return null;case-1:return this.renderQuiting();case 1:return this.renderAm()}}},{key:"renderQuiting",value:function(){var e=this.controller.deep.meAdmin.update,t=new Date(1e3*e),n=new Date(1e3*(e+86400));return Object(q.jsxs)("div",{children:[Object(q.jsxs)($t.h,{className:Nr+_r+Ar+" text-danger cursor-pointer",onClick:this.controller.showMeSysAdmin,children:[Object(q.jsxs)("div",{className:"d-flex justify-content-center p-3",children:[qr,Object(q.jsx)("b",{children:"I am quiting system admim"})]}),Object(q.jsxs)("div",{className:Sr+" my-3 d-flex justify-content-center ",children:["You quit at ",t.toLocaleDateString()," ",t.toLocaleTimeString(),", can restore before ",n.toLocaleDateString()," ",n.toLocaleTimeString()]})]}),Object(q.jsx)("div",{className:"pt-3",children:Object(q.jsx)("div",{className:"d-flex justify-content-center my-3",children:Object(q.jsx)("button",{className:"btn btn-outline-primary",onClick:this.controller.onMeSystemAdmin,children:"Restore system admin"})})})]})}},{key:"renderAm",value:function(){return Object(q.jsxs)("div",{children:[Object(q.jsx)($t.h,{className:Nr+_r+Ar+" text-danger cursor-pointer",onClick:this.controller.showMeSysAdmin,children:Object(q.jsxs)("div",{className:"d-flex justify-content-center p-3",children:[qr,Object(q.jsx)("b",{children:"I am a system admim"})]})}),Object(q.jsxs)("div",{className:"pt-3",children:[Object(q.jsx)("div",{className:"d-flex justify-content-center my-3",children:Object(q.jsx)("button",{className:"btn btn-outline-primary",disabled:0===this.controller.deep.sysAdmins.length,onClick:this.controller.onMeSystemAdmin,children:"Quit system admin"})}),Object(q.jsx)("div",{className:"d-flex justify-content-center my-3",children:Object(q.jsx)("div",{className:Sr,children:"You can restore in 24 hours after quiting"})})]})]})}}]),n}(An),Dr=Object(q.jsx)($t.d,{className:"text-primary me-3",name:"info-circle",size:"lg"}),Er=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderAdminItem=function(t,n){var r=t.id,a=t.assigned;return e.controller.app.cUser.renderUser(r,(function(e){var t=e.name,n=e.nick,i=e.icon,s=Object(q.jsx)($t.d,{name:"angle-right",className:"cursor-pointer"});return Object(q.jsxs)($t.h,{className:" px-3 py-2  my-1  bg-white ",left:Object(q.jsx)($t.g,{src:i,className:"me-4 align-self-start w-2-5c h-2-5c"}),right:s,children:[a&&Object(q.jsxs)("div",{children:[Object(q.jsx)("small",{className:"text-muted me-3",children:"Remark:"}),a]}),Object(q.jsxs)("div",{children:[Object(q.jsx)("small",{className:"text-muted me-3",children:"Name:"}),t]}),Object(q.jsxs)("div",{children:[Object(q.jsx)("small",{className:"text-muted me-3",children:"Nick:"}),n]})]},r)}))},e}return Object(zt.a)(n,[{key:"header",value:function(){return"Admin"}},{key:"content",value:function(){var e=this;return this.react((function(){return Object(q.jsxs)("div",{children:[e.renderMe(),e.renderSysAdmins(),e.renderAdmins()]})}))}},{key:"renderMe",value:function(){switch(this.controller.deep.meAdmin.role){default:return null;case br.nSys:return this.renderMeSystemAdmin(!0);case br.sys:return this.renderMeSystemAdmin(!1);case br.admin:return Object(q.jsxs)("div",{className:" px-3 py-2  bg-white  my-2 ",children:[Dr," I am an admin"]})}}},{key:"renderMeSystemAdmin",value:function(e){var t=Object(q.jsx)($t.d,{name:"angle-right"}),n=!0===e?"I am quiting system admin":"I am a system admin";return Object(q.jsxs)($t.h,{className:" px-3 py-2  bg-white  my-2  text-danger cursor-pointer",onClick:this.controller.showMeSysAdmin,right:t,children:[Dr,Object(q.jsx)("b",{children:n})]})}},{key:"renderSysAdmins",value:function(){var e=this.controller.deep;switch(e.meAdmin.role){case br.nSys:case br.admin:return null}var t=e.sysAdmins;return Object(q.jsxs)("div",{className:"mt-3",children:[Object(q.jsx)("div",{className:" px-3 py-2  small ",children:Object(q.jsxs)($t.h,{right:this.renderAdd(br.sys),className:"align-items-end",children:[Object(q.jsx)("div",{children:"System admins"}),Object(q.jsx)("div",{className:"small text-muted",children:"System admin is an admin, and can add or delete admin"})]})}),Object(q.jsx)($t.i,{items:t,item:{render:this.renderAdminItem,onClick:this.controller.onUser}})]})}},{key:"renderAdmins",value:function(){var e=this.controller.deep;switch(e.meAdmin.role){case br.nSys:case br.admin:return null}var t=e.admins;return Object(q.jsxs)("div",{className:"mt-3",children:[Object(q.jsx)("div",{className:" px-3 py-2  small",children:Object(q.jsxs)($t.h,{right:this.renderAdd(br.admin),className:"align-items-end",children:[Object(q.jsx)("div",{children:"Admins"}),Object(q.jsx)("div",{className:"small text-muted",children:"Admin can define user roles"})]})}),Object(q.jsx)($t.i,{items:t,item:{render:this.renderAdminItem,onClick:this.controller.onUser}})]})}},{key:"renderAdd",value:function(e){var t=this;return Object(q.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:function(){return t.controller.onAddAdmin(e)},children:Object(q.jsx)($t.d,{name:"plus"})})}}]),n}(An),Pr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onDelAdmin=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.confirm("do you really want to delete the admin?");case 2:!0===t.sent&&(e.controller.onDelAdmin(e.props),e.controller.close());case 4:case"end":return t.stop()}}),t)}))),e}return Object(zt.a)(n,[{key:"header",value:function(){return" "}},{key:"content",value:function(){var e,t=this,n=this.props,r=n.id,a=n.role,i=n.operator,s=n.update;return this.controller.app.cUser.renderUser(r,(function(n){var r=n.name,c=n.nick,u=n.icon;return(a===br.sys&&Date.now()/1e3-s<86400||i===t.controller.me||a===br.admin)&&(e=Object(q.jsxs)("button",{className:"btn btn-sm btn-outline-secondary",onClick:t.onDelAdmin,children:["Remove ",a===br.sys?"system admin":"admin"]})),Object(q.jsxs)("div",{children:[Object(q.jsxs)("div",{className:"d-flex border m-3 rounded-3 bg-white px-5 py-4",children:[Object(q.jsx)($t.g,{src:u,className:"me-4 w-2-5c h-2-5c"}),Object(q.jsxs)("div",{children:[Object(q.jsxs)("div",{className:"cursor-pointer",onClick:function(){return t.controller.onEditRemark(t.props)},children:[Object(q.jsx)("small",{className:"text-muted me-3",children:"Remark:"}),t.react((function(){var e=t.props.assigned;return Object(q.jsx)(q.Fragment,{children:null!==e&&void 0!==e?e:"-"})})),Object(q.jsx)("span",{className:"ms-3",children:Object(q.jsx)($t.d,{name:"pencil-square-o",className:"text-primary"})})]}),Object(q.jsxs)("div",{children:[Object(q.jsx)("small",{className:"me-3 text-muted",children:"Name:"})," ",r]}),Object(q.jsxs)("div",{children:[Object(q.jsx)("small",{className:"me-3 text-muted",children:"Nick:"})," ",c]})]})]}),Object(q.jsx)("div",{className:"d-flex m-3 mt-4 justify-content-end",children:e})]})}))}}]),n}(An);!function(e){e[e.sys=1]="sys",e[e.admin=2]="admin",e[e.nSys=-1]="nSys",e[e.nAdmin=-2]="nAdmin"}(br||(br={}));var Fr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).adminsChanged=!0,e.onAdmin=void 0,e.deep=Dn({meAdmin:null,admins:[],sysAdmins:[]}),e.showMeSysAdmin=function(){e.open(Tr)},e.onMeSystemAdmin=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setMeAdmin();case 2:Pn((function(){var t=e.deep.meAdmin,n=t.role;t.role=-n,t.update=Date.now()/1e3,e.adminsChanged=!0})),e.close();case 4:case"end":return t.stop()}}),t)}))),e.onDelAdmin=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){var r;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.role,t.next=3,e.setAdmin(n.id,-r,null);case 3:Pn((function(){var t=1===r?e.deep.sysAdmins:e.deep.admins;e.removeAdmin(t,n),e.adminsChanged=!0}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onUser=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.open(Pr,n);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onEditRemark=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){var r;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=new ar(e.app,{itemSchema:{name:"remark",type:"string",required:!0},uiItem:{widget:"text",maxLength:100,label:"Remark"},value:n.assigned,onChanged:function(){var t=Object(Pt.a)(Rt.a.mark((function t(r,a){var i,s,c;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.assigned=a,i=n.id,s=n.role,c=n.assigned,t.next=4,e.setAdmin(i,s,c);case 4:e.adminsChanged=!0;case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}),r.onEdit();case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(zt.a)(n,[{key:"load",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t,n,r,a,i,s,c,u,o,l=this;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==this.adminsChanged){e.next=2;break}return e.abrupt("return");case 2:return this.adminsChanged=!1,e.next=5,this.loadAdmins();case 5:if(t=e.sent){e.next=8;break}return e.abrupt("return");case 8:n=[],r=[],i=this.me,s=Object(en.a)(t),e.prev=12,s.s();case 14:if((c=s.n()).done){e.next=31;break}if(u=c.value,u.id!==i){e.next=20;break}return a=u,e.abrupt("continue",29);case 20:o=u.role,e.t0=o,e.next=-1===e.t0?24:1===e.t0?25:2===e.t0?27:29;break;case 24:return e.abrupt("break",29);case 25:return n.push(u),e.abrupt("break",29);case 27:return r.push(u),e.abrupt("break",29);case 29:e.next=14;break;case 31:e.next=36;break;case 33:e.prev=33,e.t1=e.catch(12),s.e(e.t1);case 36:return e.prev=36,s.f(),e.finish(36);case 39:Pn((function(){l.deep.meAdmin=a,l.deep.sysAdmins=n,l.deep.admins=r})),a&&(this.onAdmin=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.openMain();case 2:case"end":return e.stop()}}),e)}))));case 41:case"end":return e.stop()}}),e,this,[[12,33,36,39]])})));return function(){return e.apply(this,arguments)}}()},{key:"openMain",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:this.open(Er);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onAddAdmin",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n,r,a,i,s=this;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="Add "+(t===br.sys?"system admin":"admin"),e.next=3,this.fetch(this.app.cUser.select(n));case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:return a=r.id,i=r.assigned,e.next=9,this.fetch(this.setAdmin(a,t,i));case 9:Pn((function(){var e,n,r=Date.now()/1e3,c={id:a,user:a,role:t,operator:void 0,assigned:i,create:r,update:r},u=s.deep,o=u.sysAdmins,l=u.admins;1===t?(e=o,n=l):(e=l,n=o),e.unshift(c),s.removeAdmin(n,c),s.adminsChanged=!0}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeAdmin",value:function(e,t){var n=e.findIndex((function(e){return e.id===t.id}));n>=0&&e.splice(n,1)}}]),n}(Ln);function Rr(e){return Object(q.jsx)("small",{className:"text-muted",children:e})}function Lr(e){var t=e.split("-"),n=new Date(Number(t[0]),Number(t[1])-1,Number(t[2]));return Object(q.jsx)(q.Fragment,{children:n.toDateString()})}function Vr(e){var t=e.split(":");return Object(q.jsxs)(q.Fragment,{children:[t[0],":",t[1]]})}var Br=[10,3,3,3,3,3,5,5,5,5,5,5,5,5,10,10,10,10,15,15,15,30,30,60],Mr=function(){function e(t,n){var r=this;Object(Kt.a)(this,e),this.poke=void 0,this.refreshAction=void 0,this.timer=void 0,this.refresh=Object(Pt.a)(Rt.a.mark((function e(){var t;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=Date.now()/1e3)-r.refreshTime<30)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,r.refreshAction;case 5:Object(Qt.s)((function(){r.refreshTime=t}));case 6:case"end":return e.stop()}}),e)}))),this.refreshTime=Date.now()/1e3,this.tick=0,this.gapIndex=0,this.callTick=Object(Pt.a)(Rt.a.mark((function e(){var t,n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,++r.tick,!(r.tick<Br[r.gapIndex])){e.next=4;break}return e.abrupt("return");case 4:return r.tick=0,r.gapIndex<Br.length-1&&++r.gapIndex,e.next=8,r.poke;case 8:if(t=e.sent,void 0!==(n=t.ret[0])){e.next=12;break}return e.abrupt("return");case 12:if(n.poke){e.next=14;break}return e.abrupt("return");case 14:return r.gapIndex=1,e.next=17,r.refresh();case 17:e.next=21;break;case 19:e.prev=19,e.t0=e.catch(0);case 21:case"end":return e.stop()}}),e,null,[[0,19]])}))),this.poke=t,this.refreshAction=n}return Object(zt.a)(e,[{key:"start",value:function(){void 0!==this.refreshAction&&(this.stop(),this.timer=setInterval(this.callTick,1e3))}},{key:"stop",value:function(){void 0!==this.timer&&(clearInterval(this.timer),this.timer=void 0)}}]),e}(),Ur=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).shallow=En({user:null}),e.onSelected=function(t){e.controller.callReturn(Object(Ht.a)(e),t),e.controller.close()},e.onSearch=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){var r;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.searchUser(n);case 2:r=t.sent,Pn((function(){e.shallow.user=r}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(zt.a)(n,[{key:"header",value:function(){return this.controller.caption}},{key:"back",get:function(){return"close"}},{key:"content",value:function(){var e=this;return Object(q.jsxs)("div",{className:"p-3 d-flex align-items-center flex-column",children:[Object(q.jsx)("div",{className:"mx-auto mb-3",children:Object(q.jsx)($t.n,{className:"w-min-20c",onFocus:function(){return Pn((function(){return e.shallow.user=null}))},onSearch:this.onSearch,placeholder:"user account"})}),this.react((function(){var t,n=e.shallow.user;if(null===n)return null;if(void 0===n)t=Object(q.jsxs)("div",{children:[Object(q.jsx)($t.d,{name:"info-o",className:"me-3 text-info"})," No user"]});else{var r=n.name,a=n.nick,i=n.icon;t=Object(q.jsxs)(q.Fragment,{children:[Object(q.jsxs)("div",{className:"d-flex",children:[Object(q.jsx)($t.g,{src:i,className:"me-4 w-2-5c h-2-5c"}),Object(q.jsxs)("div",{children:[Object(q.jsxs)("div",{children:[Rr("Name:")," \xa0 ",r]}),Object(q.jsxs)("div",{children:[Rr("Nick:")," \xa0 ",a]})]})]}),Object(q.jsx)("div",{className:"text-center mt-5",children:Object(q.jsx)("button",{className:"btn btn-primary",onClick:function(){return e.onSelected(n)},children:e.header()})})]})}return Object(q.jsx)("div",{className:"border rounded-3 bg-white p-5 mx-auto w-min-20c",children:t})}))]})}}]),n}(An),Wr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).shallow=En({cache:new Map}),e.caption=void 0,e}return Object(zt.a)(n,[{key:"select",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.caption=t,e.next=3,this.call(Ur);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"searchUser",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.app.userApi.userFromName(t);case 2:return n=e.sent,this.setCache(n.id,n),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderUser",value:function(e,t){var n=this;return Fn((function(){if(!e)return null;var r=n.userFromCache(e);return r?t(r):Gn(e)}))}},{key:"userFromCache",value:function(e){var t=this.shallow.cache.get(e);return null===t?null:(void 0===t&&this.loadUser(e),t)}},{key:"loadUser",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.app.userApi.userFromId(t);case 3:n=e.sent,this.setCache(t,n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.setCache(t,null);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setCache",value:function(e,t){var n=this;Pn((function(){return n.shallow.cache.set(e,t)}))}}]),n}(Ln),$r=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;return Object(Kt.a)(this,n),(r=t.call(this,e)).uqs=void 0,r.uqs=e.uqs,r}return Object(zt.a)(n,[{key:"openMain",value:function(){alert("openMain not defined")}}]),n}(Ln),Kr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;return Object(Kt.a)(this,n),(r=t.call(this,e.app)).cActs=void 0,r.cActs=e,r}return Object(zt.a)(n)}($r),zr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onSubmit=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n,r){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.saveNote(e.props,r.data);case 2:e.controller.close();case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(zt.a)(n,[{key:"header",value:function(){var e=this.props,t=e.firstName,n=e.lastName,r=e.no;return Object(q.jsxs)(q.Fragment,{children:[t," ",n," \xa0 ",Object(q.jsx)("small",{className:"text-muted",children:r})]})}},{key:"content",value:function(){return Object(q.jsx)("div",{className:"p-3",children:Object(q.jsx)($t.e,{schema:[{name:"note",type:"string"},{name:"sensitive",type:"boolean"},{name:"submit",type:"submit"}],uiSchema:{items:{note:{widget:"textarea",placeholder:"input note here",label:"Note",rows:10},sensitive:{widget:"checkbox",label:"Sensitive",align:"start"},submit:{widget:"button",className:"btn btn-primary",label:"Submit"}}},onButtonClick:this.onSubmit})})}}]),n}(An),Hr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderLog=function(t,n){var r=t.id;return Object(q.jsxs)("div",{className:"d-block",children:[Object(q.jsx)("div",{className:"px-3 py-1 border-bottom small text-muted",children:Object(q.jsx)($t.b,{date:Object(S.b)(r)})}),Object(q.jsx)("div",{className:"px-3 py-2",children:e.renderLogContent(t)})]})},e}return Object(zt.a)(n,[{key:"header",value:function(){var e=this.props,t=e.firstName,n=e.lastName,r=e.no;return Object(q.jsxs)(q.Fragment,{children:[t," ",n," \xa0 ",Object(q.jsx)("small",{className:"text-muted",children:r})]})}},{key:"right",value:function(){var e=this;return Object(q.jsx)("button",{className:"btn btn-sm btn-success me-2",onClick:function(){return e.controller.showAddNote(e.props)},children:Object(q.jsx)($t.d,{name:"plus"})})}},{key:"content",value:function(){return Object(q.jsx)("div",{className:"",children:Object(q.jsx)($t.i,{items:this.controller.deepData.notes,item:{render:this.renderLog,className:"mt-1 mb-3",key:function(e){return e.id}}})})}},{key:"renderLogContent",value:function(e){var t=e.$type;switch(t){default:return Object(q.jsxs)(q.Fragment,{children:["unknown type ",t]});case"note":return this.renderNote(e);case"sessionperson":return this.renderSessionPerson(e)}}},{key:"renderNote",value:function(e){var t,n=e.note,r=e.staff;return 1===e.sensitive&&(t=Object(q.jsx)($t.d,{name:"lock",className:"text-danger me-3"}),!0===this.controller.app.isPersonMe(r))?Object(q.jsxs)("div",{className:"text-muted small",children:[t," #sensitive"]}):Object(q.jsx)(q.Fragment,{children:n.split("\n").map((function(e,n){return Object(q.jsxs)("div",{className:"my-1",children:[t," ",e]},n)}))})}},{key:"renderSessionPerson",value:function(e){var t=this.controller.app.cIds,n=t.cWorkshop,r=t.cStaff,a=n.cSession,i=e.session,s=e.person,c=e.workshop;return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)("div",{children:n.renderId(c)}),Object(q.jsx)("div",{children:a.renderId(i)}),Object(q.jsx)("div",{children:r.renderId(s)})]})}}]),n}(An),Xr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderItem=function(t,n){var r;e.controller.cClient.icon&&(r=Object(q.jsx)($t.d,{name:"user-o",className:"me-3 text-primary ",fixWidth:!0}));var a=Object(q.jsx)($t.d,{name:"angle-right"});return Object(q.jsx)($t.h,{className:"px-3 py-2 align-items-center",left:r,right:a,children:Object(q.jsx)("div",{children:e.controller.cClient.renderItemInList(t)})})},e.onSearch=Object(Pt.a)(Rt.a.mark((function t(){var n,r;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Wn(e.controller.cClient),t.next=3,n.select();case 3:if(r=t.sent){t.next=6;break}return t.abrupt("return");case 6:e.controller.showClient(r);case 7:case"end":return t.stop()}}),t)}))),e}return Object(zt.a)(n,[{key:"header",value:function(){return"Client notes"}},{key:"right",value:function(){return Object(q.jsx)("button",{className:"btn btn-sm btn-primary me-2",onClick:this.onSearch,children:Object(q.jsx)($t.d,{name:"search"})})}},{key:"content",value:function(){var e=this.controller.deepData.clients;return Object(q.jsx)("div",{className:"",children:Object(q.jsx)($t.i,{items:e,item:{render:this.renderItem,onClick:this.controller.showClient}})})}}]),n}(An),Gr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).deepData=Dn({notes:null,clients:null}),e.cClient=void 0,e.showClient=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){var r,a,i,s,c,u,o,l,h;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.uqs.BzWorkshop,t.next=3,r.IXValues({IX:r.IxPersonLog,ix:n.id,order:"desc"});case 3:a=t.sent,i=[],s=Object(en.a)(a);try{for(s.s();!(c=s.n()).done;)u=c.value,o=u.type,l=u.value,void 0!==(h=r.IDValue(o,l))&&(h.$type=o,i.push(h))}catch(d){s.e(d)}finally{s.f()}Pn((function(){e.deepData.notes=i})),e.open(Hr,n);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showAddNote=function(t){e.open(zr,t)},e.saveNote=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n,r){var a,i,s;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={id:void 0,staff:10,client:n.id,note:r.note,sensitive:!0===r.sensitive?1:0},i=e.uqs.BzWorkshop,t.next=4,i.SaveNote.submitReturns(a);case 4:s=t.sent,a.id=s.ret[0].id,a.$type="note",Pn((function(){var t=e.deepData,r=t.notes,i=t.clients;r.unshift(a);var s=i.findIndex((function(e){return e.id===n.id}));s>=0&&i.splice(s,1),i.unshift(n)}));case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(zt.a)(n,[{key:"openMain",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.app.cIds.cClient,this.cClient=t,e.next=4,this.loadClients();case 4:this.open(Xr);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadClients",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t,n,r=this;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.uqs.BzWorkshop,e.next=3,t.MyClients.query({});case 3:n=e.sent,Pn((function(){r.deepData.clients=n.ret}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Kr),Qr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return"Test"}},{key:"content",value:function(){var e=this;return Object(q.jsxs)("div",{className:"p-3",children:["Test",Object(q.jsxs)("div",{children:[Object(q.jsx)("button",{className:"btn btn-primary me-3",onClick:function(t){return e.waitingEvent(t,e.controller.onTestSave)},children:"save"}),Object(q.jsx)("button",{className:"btn btn-primary me-3",onClick:function(t){return e.waitingEvent(t,e.controller.onTestLoad)},children:"load"})]})]})}}]),n}(An),Jr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;Object(Kt.a)(this,n),(r=t.call(this,e)).mDraft=void 0,r.onTestSave=Object(Pt.a)(Rt.a.mark((function e(){var t,n,a,i;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.uqs.BzWorkshop,n=t.Person,e.next=4,r.mDraft.saveMain("aaa");case 4:return a=e.sent,e.next=7,r.mDraft.saveDetail(a,[{b:2},{b:3}],n);case 7:i=e.sent,alert(JSON.stringify([a,i]));case 9:case"end":return e.stop()}}),e)}))),r.onTestLoad=Object(Pt.a)(Rt.a.mark((function e(){var t;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.mDraft.load(1176521146368);case 2:t=e.sent,alert(JSON.stringify(t));case 4:case"end":return e.stop()}}),e)})));var a=r.uqs.BzWorkshop,i=a.Draft,s=a.IxDraft;return r.mDraft=new A.c(a,i,s),r}return Object(zt.a)(n,[{key:"openMain",value:function(){this.open(Qr)}}]),n}($r),Yr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return"Attendee"}},{key:"right",value:function(){var e,t=this,n="btn btn-sm me-2 ";return 0===this.props.deleted?(n+=" btn-light",e=Object(q.jsx)($t.d,{name:"trash"})):(n+=" btn-info",e=Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)($t.d,{name:"repeat"})," Restore"]})),Object(q.jsx)("button",{className:n,onClick:function(){return t.controller.changeSessionClient(t.props)},children:e})}},{key:"content",value:function(){return Object(q.jsx)("div",{className:"p-3",children:this.controller.cClient.renderId(this.props.xi)})}}]),n}(An),Zr=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderAttendee=function(t,n){var r,a=t.$create,i=t.$update,s="px-3 py-2 align-items-center";t.deleted>0&&(s+=" text-decoration-line-through text-muted"),a!==i&&(r=Object(q.jsxs)("span",{className:"ms-3",children:["change at: ",Object(q.jsx)($t.b,{date:new Date(1e3*i)})]}));var c=Object(q.jsxs)("div",{children:[Object(q.jsx)($t.b,{date:new Date(1e3*a)}),r]});return Object(q.jsx)($t.h,{className:s,right:c,children:Object(q.jsx)("div",{className:"d-flex align-items-center",children:e.controller.cClient.renderId(t.xi)})})},e.onAddAttendee=function(){e.controller.addAttendee()},e}return Object(zt.a)(n,[{key:"header",value:function(){return"Session"}},{key:"content",value:function(){var e=this.controller,t=e.cWorkshop,n=e.session,r=e.deep,a=t.icon,i=t.iconClass,s=n.date,c=n.time,u=n.span,o=n.substitue,l=n.done,h=n.workshop,d=Object(q.jsx)("button",{className:"btn btn-sm btn-outline-primary",onClick:this.onAddAttendee,children:Object(q.jsx)($t.d,{name:"plus"})});return Object(q.jsxs)("div",{children:[Object(q.jsxs)("div",{className:"fs-5 px-3 py-2 d-flex align-items-center",children:[Object(q.jsx)($t.d,{name:a,className:i+" me-3",size:"lg"}),t.renderId(h)]}),Object(q.jsxs)("div",{className:"px-3 py-2 d-block",children:[Object(q.jsxs)("div",{children:[Lr(s)," ",Vr(c)," ",u]}),Object(q.jsxs)("div",{children:[l>0&&Object(q.jsx)($t.d,{className:"text-danger",name:"check-circle-o"}),o>0&&Object(q.jsx)($t.d,{className:"text-primary",name:"star-o"})]})]}),Object(q.jsxs)("div",{className:"mt-3",children:[Object(q.jsx)($t.h,{className:"px-3 mb-2 align-items-end",right:d,children:"Attendees"}),Object(q.jsx)($t.i,{items:r.list,item:{render:this.renderAttendee,onClick:this.controller.showAttendee}})]})]})}}]),n}(An),ea=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e,r,a){var i;return Object(Kt.a)(this,n),(i=t.call(this,e)).cWorkshops=void 0,i.cWorkshop=void 0,i.cClient=void 0,i.session=void 0,i.deep=Dn({list:null}),i.addAttendee=Object(Pt.a)(Rt.a.mark((function e(){var t,n,r,a,s,c,u;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.uqs.BzWorkshop,n=new Wn(i.cClient),e.next=4,n.select();case 4:return r=e.sent,a=i.session.id,s=r.id,c=Math.floor(Date.now()/1e3),u={ix:a,xi:s,deleted:0,$create:c,$update:c},e.next=11,t.SaveSessionAttendee.submit({session:a,client:s,deleted:0});case 11:Pn((function(){var e=i.deep.list,t=e.findIndex((function(e){return e.xi===s}));t>=0&&e.splice(t,1),e.unshift(u)}));case 12:case"end":return e.stop()}}),e)}))),i.showAttendee=function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.open(Yr,t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.changeSessionClient=function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n,r,a,s;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.uqs.BzWorkshop,r=t.ix,a=t.xi,s=1-(s=t.deleted),e.next=5,n.SaveSessionAttendee.submit({session:r,client:a,deleted:s});case 5:i.deep.list.find((function(e){return e.xi===a})).deleted=s,i.close();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.cWorkshops=r,i.cWorkshop=r.cWorkshop,i.cClient=r.app.cIds.cClient,i.session=a,i}return Object(zt.a)(n,[{key:"openMain",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t,n,r=this;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.uqs.BzWorkshop,e.next=3,t.IX({IX:t.IxSessionClient,ix:this.session.id});case 3:n=e.sent,Pn((function(){r.deep.list=n})),this.open(Zr);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Kr),ta=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderWorkshopItem=function(t,n){var r=t.workshop,a=t.sessions,i=e.controller.cWorkshop,s=i.icon,c=i.iconClass;return Object(q.jsxs)("div",{className:"px-3 py-2 d-block mb-3",children:[Object(q.jsxs)("div",{onClick:function(){return e.onWorkshopClick(r)},className:"fs-5 my-2 d-flex align-items-center cursor-pointer",children:[Object(q.jsx)($t.d,{name:s,className:c+" me-3",size:"lg"}),i.renderId(r)]}),Object(q.jsx)($t.i,{className:"ms-4",items:a,item:{render:e.renderSessionItem,onClick:e.onSessionClick}})]})},e.renderSessionItem=function(e,t){var n=e.date,r=e.time,a=e.span,i=e.substitue,s=e.done;return Object(q.jsxs)("div",{className:"px-3 py-2 d-block",children:[Object(q.jsxs)("div",{children:[Lr(n)," ",Vr(r)," ",a]}),Object(q.jsxs)("div",{children:[s>0&&Object(q.jsx)($t.d,{className:"text-danger",name:"check-circle-o"}),i>0&&Object(q.jsx)($t.d,{className:"text-primary",name:"star-o"})]})]})},e.onWorkshopClick=function(e){alert(e)},e.onSessionClick=function(t){e.controller.openSession(t)},e}return Object(zt.a)(n,[{key:"header",value:function(){return"Workshops"}},{key:"content",value:function(){var e=this;return this.react((function(){var t=e.controller.shallow.workshopItems;return Object(q.jsx)("div",{children:Object(q.jsx)($t.i,{items:t,item:{render:e.renderWorkshopItem}})})}))}}]),n}(An),na=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;return Object(Kt.a)(this,n),(r=t.call(this,e)).cWorkshop=void 0,r.shallow=En({workshopItems:null}),r.cWorkshop=e.app.cIds.cWorkshop,r}return Object(zt.a)(n,[{key:"openMain",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadList();case 2:this.open(ta);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadList",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t,n,r,a,i,s,c,u,o=this;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.BzWorkshop.MySessions.query({});case 2:t=e.sent,n={},r=[],a=Object(en.a)(t.ret);try{for(a.s();!(i=a.n()).done;)s=i.value,c=s.workshop,(u=n[c])||(u={workshop:c,sessions:[]},n[c]=u,r.push(u)),u.sessions.push(s)}catch(l){a.e(l)}finally{a.f()}r.sort((function(e,t){var n=e.workshop,r=t.workshop;return n>r?-1:n===r?0:1})),Pn((function(){o.shallow.workshopItems=r}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"openSession",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:new ea(this.cActs,this,t).openMain();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Kr),ra=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return"Home"}},{key:"content",value:function(){var e=this,t=this.controller,n=[{icon:"user-o",caption:"Client notes",onClick:t.showClientNotes},{icon:"user-o",caption:"Workshops",onClick:t.showRegisterWorkshop},{icon:"caret-right",caption:"Test",onClick:t.showTest}];return Object(q.jsx)("div",{className:"",children:n.map((function(t,n){return e.renderAdminOrRole((function(){var e=t.onClick,r=t.caption,a=t.icon,i=Object(q.jsx)($t.d,{name:"angle-right"}),s=Object(q.jsx)($t.d,{name:a,className:"text-primary me-3",fixWidth:!0});return Object(q.jsx)($t.h,{className:"cursor-pointer bg-white border-bottom py-2 px-3 align-items-center",left:s,right:i,onClick:e,children:r},n)}))}))})}}]),n}(An),aa=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).load=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.showRegisterWorkshop=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:new na(Object(Ht.a)(e)).openMain();case 2:case"end":return t.stop()}}),t)}))),e.showClientNotes=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:new Gr(Object(Ht.a)(e)).openMain();case 2:case"end":return t.stop()}}),t)}))),e.showTest=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:new Jr(e.app).openMain();case 2:case"end":return t.stop()}}),t)}))),e}return Object(zt.a)(n,[{key:"main",value:function(){return this.render(ra)}}]),n}($r),ia=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;return Object(Kt.a)(this,n),(r=t.call(this,e.app)).cIds=void 0,r.uqs=void 0,r.cTagInput=void 0,r.cIds=e,r.uqs=e.uqs,r.cTagInput=new Cr(r.cIds.app.cTag,Object(Ht.a)(r),r.uqs.BzWorkshop.IxGlobalIdTag),r.initID(),r}return Object(zt.a)(n,[{key:"tagGroupName",get:function(){}},{key:"isVisible",value:function(){return this.app.meAdmin}},{key:"loadItemsFromIds",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.BzWorkshop.ID({IDX:this.ID,id:t});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"savePropValue",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t,n,r){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.BzWorkshop.ActIDProp(this.ID,t,n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"beforeEdit",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(on.a)(Object(ln.a)(n.prototype),"beforeEdit",this).call(this);case 2:if(void 0===(t=this.tagGroupName)){e.next=6;break}return e.next=6,this.cTagInput.beforeEdit(t,this.deepData.currentItem.id);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderTagInput",value:function(){return this.cTagInput.renderInput()}}]),n}(Jn);function sa(e,t){var n,r=e.no,a=e.name,i=e.firstName,s=e.lastName,c=e.middleName,u=e.user;return t&&u&&(n=t.renderUser(u,(function(e){var t=e.name;return Object(q.jsxs)("span",{className:"ms-4",children:["user:  ",t]})}))),Object(q.jsxs)(q.Fragment,{children:[Object(q.jsxs)("div",{className:"small text-muted me-3",children:[r," ",n]}),Object(q.jsx)("div",{children:null!==a&&void 0!==a?a:Object(q.jsxs)(q.Fragment,{children:[s," ",c," ",i]})})]})}var ca,ua=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"content",value:function(){return Object(q.jsxs)("div",{className:"py-3",children:[this.renderProps(),this.renderTagInput()]})}},{key:"renderBindUser",value:function(){var e=this;return this.renderAdmin((function(){var t=e.controller.deepData.currentItem.user?"angle-right":"pencil-square-o";return Object(q.jsx)("div",{className:"container",children:Object(q.jsxs)("div",{onClick:e.controller.onBindUser,className:"mb-3 row bg-white align-items-center cursor-pointer",children:[Object(q.jsx)("label",{className:"col-sm-2 col-form-label",children:"Bind user"}),Object(q.jsx)("div",{className:"col-sm-10",children:Object(q.jsx)($t.h,{right:Object(q.jsx)($t.d,{name:t,className:"text-primary"}),children:e.controller.renderCurrentUser((function(e){var t=e.name;return Object(q.jsx)(q.Fragment,{children:t})}))})})]})})}))}}]),n}(Hn),oa=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChange=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.confirm("Change user account bound is not recommented. Still want to do so?");case 2:if(t.t0=t.sent,!0!==t.t0){t.next=6;break}return t.next=6,e.controller.onChangeUser();case 6:case"end":return t.stop()}}),t)}))),e.onRemoveBound=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.onRemoveBound();case 2:case"end":return t.stop()}}),t)}))),e}return Object(zt.a)(n,[{key:"header",value:function(){return"User bound"}},{key:"content",value:function(){var e=Object(q.jsx)("button",{className:"btn btn-outline-secondary",onClick:this.onRemoveBound,children:"Remove bound"});return Object(q.jsxs)("div",{className:"m-5 rouned-3 border bg-white w-max-30c p-5 mx-auto",children:[Object(q.jsxs)("div",{className:"mb-5 text-center",children:["The person has bound to website user account:",Object(q.jsx)("br",{}),Object(q.jsx)("br",{}),this.controller.renderCurrentUser((function(e){var t=e.name;return Object(q.jsx)("b",{className:"text-primary ms-3",children:t})}))]}),Object(q.jsx)($t.h,{className:"",right:e,children:Object(q.jsx)("button",{className:"btn btn-primary",onClick:this.onChange,children:"Change user"})})]})}}]),n}(An),la=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onBindUser=Object(Pt.a)(Rt.a.mark((function t(){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.deepData.currentItem.user){t.next=3;break}return e.open(oa),t.abrupt("return");case 3:return t.next=5,e.onChangeUser();case 5:case"end":return t.stop()}}),t)}))),e.onChangeUser=Object(Pt.a)(Rt.a.mark((function t(){var n,r,a,i;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.app.cUser.select("Bind user");case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return");case 5:return r=e.deepData.currentItem,a=n.id,i=e.uqs.BzWorkshop,t.next=10,i.ActIX({IX:i.IxUserPerson,values:[{ix:a,xi:r.id}]});case 10:Pn((function(){r.user=a}));case 11:case"end":return t.stop()}}),t)}))),e.onRemoveBound=Object(Pt.a)(Rt.a.mark((function t(){var n,r;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.deepData.currentItem,r=e.uqs.BzWorkshop,t.next=4,r.ActIX({IX:r.IxUserPerson,values:[{ix:n.user,xi:-n.id}]});case 4:e.close(),Pn((function(){n.user=void 0}));case 6:case"end":return t.stop()}}),t)}))),e}return Object(zt.a)(n,[{key:"uq",get:function(){return this.uqs.BzWorkshop}},{key:"getID",value:function(){return this.uqs.BzWorkshop.Person}},{key:"caption",get:function(){return"Staff"}},{key:"schema",get:function(){return this.uqs.BzWorkshop.Person.ui.fieldArr}},{key:"uiSchema",get:function(){return{items:{no:{name:"no",type:"string",isKey:!0,widget:"text",label:"No",defaultValue:this.initNO},name:{name:"name",type:"string",isKey:!1,widget:"text",label:"Name"},firstName:{name:"firstName",type:"string",isKey:!1,widget:"text",label:"First Name"},lastName:{name:"lastName",type:"string",isKey:!1,widget:"text",label:"Last Name"},middleName:{name:"middleName",type:"string",isKey:!1,widget:"text",label:"Middle Name"},submit:{label:"Save "+this.caption,widget:"button",className:"btn btn-primary"}}}}},{key:"loadList",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t,n,r,a,i,s,c,u,o,l,h,d,f,v;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.uqs.BzWorkshop,e.next=3,t.GetPersonList.query({role:this.personRole});case 3:n=e.sent,r=n.ret,a=n.roles,s=Object(en.a)(r),e.prev=6,s.s();case 8:if((c=s.n()).done){e.next=35;break}u=c.value,o=u.id,i=u,l=Object(en.a)(a),e.prev=13,l.s();case 15:if((h=l.n()).done){e.next=25;break}if(d=h.value,f=d.person,v=d.role,f===o){e.next=20;break}return e.abrupt("continue",23);case 20:if(!0!==this.isInRole(v)){e.next=23;break}return i.role=v,e.abrupt("break",25);case 23:e.next=15;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(13),l.e(e.t0);case 30:return e.prev=30,l.f(),e.finish(30);case 33:e.next=8;break;case 35:e.next=40;break;case 37:e.prev=37,e.t1=e.catch(6),s.e(e.t1);case 40:return e.prev=40,s.f(),e.finish(40);case 43:return e.abrupt("return",r);case 44:case"end":return e.stop()}}),e,this,[[6,37,40,43],[13,27,30,33]])})));return function(){return e.apply(this,arguments)}}()},{key:"saveId",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n,r;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.uqs.BzWorkshop,e.next=3,n.ActIX({IX:n.IxPersonRole,ID:n.Person,values:[{ix:this.personRole,xi:t}]});case 3:return r=e.sent,e.abrupt("return",r[0]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.BzWorkshop.PersonSearch.query({role:this.personRole,key:t});case 2:return n=e.sent,e.abrupt("return",n.ret);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderItemInList",value:function(e){return sa(e,this.app.cUser)}},{key:"renderItemOnSelect",value:function(e){return function(e){var t=e.no,n=e.name,r=e.firstName,a=e.lastName,i=e.middleName,s=Object(q.jsx)("span",{className:"small text-muted",children:t});return Object(q.jsx)($t.h,{className:"w-100",right:s,children:null!==n&&void 0!==n?n:Object(q.jsxs)(q.Fragment,{children:[a," ",i," ",r]})})}(e)}},{key:"renderIdValue",value:function(e){return sa(e)}},{key:"VEdit",get:function(){return ua}},{key:"renderCurrentUser",value:function(e){var t=this;return Fn((function(){var n=t.deepData.currentItem;if(!n)return null;var r=n.user;return t.app.cUser.renderUser(r,e)}))}}]),n}(ia),ha=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"tagGroupName",get:function(){return"client-tags"}},{key:"personRole",get:function(){return N.client}},{key:"caption",get:function(){return"Client"}},{key:"icon",get:function(){return"user-o"}},{key:"iconClass",get:function(){return"text-info"}},{key:"isInRole",value:function(e){}},{key:"isVisible",value:function(){return this.app.isAdminOrRole(N.counselor)}}]),n}(la),da=n(28),fa=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"isInEnum",value:function(e){return void 0!==this.enumCaptions[e]}},{key:"renderInput",value:function(){return this.render(this.VInput)}}]),n}(Ln),va=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e,r,a){var i;return Object(Kt.a)(this,n),(i=t.call(this,e)).id=void 0,i.value=void 0,i.saveIxEnum=function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n,r,a,s;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.enums.map((function(e){return{ix:i.id,xi:e}})),r=Object(en.a)(n);try{for(r.s();!(a=r.n()).done;)(s=a.value).xi!==t&&(s.xi=-s.xi)}catch(c){r.e(c)}finally{r.f()}return e.next=5,i.uq.ActIX({IX:i.IX,values:n});case 5:i.OnEnumChanged&&i.OnEnumChanged(t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.id=r,i.value=a,i}return Object(zt.a)(n,[{key:"VInput",get:function(){return pa}}]),n}(fa),pa=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChange=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){var r;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.currentTarget,t.next=3,e.controller.saveIxEnum(Number(r.value));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(zt.a)(n,[{key:"render",value:function(){var e=this,t=this.controller,n=t.caption,r=t.enums,a=t.enumCaptions,i=t.value;return Object(q.jsx)("div",{className:"container",children:Object(q.jsxs)("div",{className:"mb-3 row bg-white align-items-center cursor-pointer",children:[Object(q.jsx)("label",{className:"col-sm-2 col-form-label",children:n}),Object(q.jsx)("div",{className:"col-sm-10",children:r.map((function(t){return Object(q.jsxs)("label",{className:"me-4 form-check-inline",children:[Object(q.jsx)("input",{type:"radio",name:"staff-role",onChange:e.onChange,defaultChecked:t===i,defaultValue:t})," ",a[t]]},t)}))})]})})}}]),n}(_n),ba=(ca={},Object(da.a)(ca,N.counselor,"Counselor"),Object(da.a)(ca,N.volunteer,"Volunteer"),ca);var ma,ja=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"content",value:function(){return Object(q.jsxs)("div",{className:"py-3",children:[this.renderBindUser(),this.renderRoles(),this.renderProps(),this.renderTagInput()]})}},{key:"renderRoles",value:function(){return this.controller.cRoleSingle.renderInput()}}]),n}(ua),ya=[N.counselor,N.volunteer],Oa=(ma={},Object(da.a)(ma,N.counselor,"Counselor"),Object(da.a)(ma,N.volunteer,"Volunteer"),ma),ka=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).cRoleSingle=void 0,e.onRoleChanged=function(){var t=Object(Pt.a)(Rt.a.mark((function t(n){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Pn((function(){e.deepData.currentItem.role=n}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(zt.a)(n,[{key:"tagGroupName",get:function(){return"staff-tags"}},{key:"personRole",get:function(){return N.staff}},{key:"caption",get:function(){return"Staff"}},{key:"icon",get:function(){return"user"}},{key:"isInRole",value:function(e){return void 0!==Oa[e]}},{key:"beforeEdit",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.cRoleSingle=new ga(this),e.next=3,Object(on.a)(Object(ln.a)(n.prototype),"beforeEdit",this).call(this);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"VEdit",get:function(){return ja}},{key:"renderItemInList",value:function(e){return function(e,t){var n,r,a=e.no,i=e.name,s=e.firstName,c=e.lastName,u=e.middleName,o=e.user,l=e.role;return t&&o&&(n=t.renderUser(o,(function(e){var t=e.name;return Object(q.jsxs)("span",{className:"ms-4",children:["user:  ",t]})}))),l&&(r=Object(q.jsxs)("span",{className:"ms-3",children:[Object(q.jsx)($t.d,{name:"dot"})," ",ba[l]]})),Object(q.jsxs)(q.Fragment,{children:[Object(q.jsxs)("div",{className:"small text-muted me-3",children:[a," ",n]}),Object(q.jsxs)("div",{children:[null!==i&&void 0!==i?i:Object(q.jsxs)(q.Fragment,{children:[c," ",u," ",s]}),r]})]})}(e,this.cIds.app.cUser)}}]),n}(la),ga=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;Object(Kt.a)(this,n);var a=e.deepData.currentItem;return(r=t.call(this,e.app,null===a||void 0===a?void 0:a.id,a.role)).cStaff=void 0,r.cStaff=e,r}return Object(zt.a)(n,[{key:"enums",get:function(){return ya}},{key:"enumCaptions",get:function(){return Oa}},{key:"caption",get:function(){return"Role"}},{key:"uq",get:function(){return this.cStaff.uqs.BzWorkshop}},{key:"IX",get:function(){return this.uq.IxPersonRole}},{key:"OnEnumChanged",get:function(){return this.cStaff.onRoleChanged}}]),n}(va);function xa(e){var t=e.no,n=e.name;return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)("div",{className:"small text-muted me-3",children:t}),Object(q.jsx)("div",{children:n})]})}var wa=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"content",value:function(){return Object(q.jsxs)("div",{className:"",children:[Object(q.jsx)("div",{className:"my-3 border rounded-3 pt-1",children:this.renderProps()}),this.renderStaffPick(),this.renderTagInput(),Object(q.jsx)("div",{className:"my-3 border rounded-3",children:this.controller.cSession.renderList()})]})}},{key:"renderStaffPick",value:function(){return null}}]),n}(Hn),Ia=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderItem=function(t,n){return Object(q.jsx)("div",{className:"px-3 py-2",children:e.controller.renderItemInList(t)})},e}return Object(zt.a)(n,[{key:"render",value:function(){var e=this;return this.react((function(){var t=Object(q.jsx)("span",{className:"text-success cursor-pointer",onClick:e.controller.onAdd,children:Object(q.jsx)($t.d,{name:"plus",fixWidth:!0})});return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)($t.h,{right:t,className:"px-3 py-1 small text-muted",children:"Sessions"}),Object(q.jsx)($t.i,{items:e.controller.deepData.list,className:"my-1",item:{render:e.renderItem,onClick:e.controller.onEditItem},none:Object(q.jsxs)("small",{className:" px-3 py-2 text-muted",children:["Click ",t," to add session"]})})]})}))}}]),n}(_n);function Ca(e){var t=e.date,n=e.vice,r=e.time,a=e.span;return Object(q.jsxs)("div",{children:[Object(q.jsxs)("div",{children:[Lr(t)," \xa0 \xa0 start at ",r," \xa0 \xa0 for ",a," minutes \xa0 \xa0"]}),Object(q.jsx)("div",{children:n})]})}var Na=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;Object(Kt.a)(this,n),(r=t.call(this,e.cIds)).cWorkshop=void 0,r.tick=void 0,r.cWorkshop=e,r.tick=Date.now();var a=r.uqs.BzWorkshop.Session.ui.fields;return a.date.required=!0,a.time.required=!0,a.span.required=!0,r}return Object(zt.a)(n,[{key:"uq",get:function(){return this.uqs.BzWorkshop}},{key:"getID",value:function(){return this.uqs.BzWorkshop.Session}},{key:"caption",get:function(){return"Session"}},{key:"schema",get:function(){return this.uqs.BzWorkshop.Session.ui.fieldArr}},{key:"uiSchema",get:function(){return{items:{date:{widget:"date",label:"Date"},vice:{widget:"text",label:"Discription"},time:{widget:"time",label:"Time"},span:{widget:"number",label:"Duration"},submit:{label:"Save Session",widget:"button",className:"btn btn-primary"}}}}},{key:"loadList",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t,n,r,a,i;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.cWorkshop.deepData,n=t.currentItem){e.next=5;break}return e.abrupt("return",void 0);case 5:return r=this.uqs.BzWorkshop,a=n.id,e.next=9,r.QueryID({IX:[r.IxWorkshopSession],IDX:[r.Session],ix:a});case 9:return i=e.sent,e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveId",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n,r,a,i,s,c=this;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.uqs.BzWorkshop,r=this.cWorkshop.deepData,a=r.currentItem,e.next=5,n.ActIX({IX:n.IxWorkshopSession,ID:n.Session,values:[{ix:a.id,xi:t}]});case 5:return i=e.sent,s=i[0],e.next=9,n.ActIX({IX:n.IxSessionStaff,values:[{ix:s,xi:a.staff}]});case 9:return Pn((function(){t.id=s,c.deepData.list.push(t)})),e.abrupt("return",s);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderItemInList",value:function(e){return Ca(e)}},{key:"renderList",value:function(){return this.render(Ia)}},{key:"renderIdValue",value:function(e){return Ca(e)}}]),n}(ia),_a=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e,r){var a;return Object(Kt.a)(this,n),(a=t.call(this,e.app)).cId=void 0,a.deepValue=Dn({id:null}),a.pick=Object(Pt.a)(Rt.a.mark((function e(){var t,n,r;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Wn(a.cId),e.next=3,t.select();case 3:return n=e.sent,r=n.id,Pn((function(){a.deepValue.id=r})),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)}))),a.cId=e,a.deepValue.id=r,a}return Object(zt.a)(n,[{key:"ref",value:function(){var e=this;return Fn((function(){var t=e.deepValue.id;return null===t?e.renderInit():void 0===t?e.renderNA():e.cId.renderId(t)}))}},{key:"renderInit",value:function(){return Rr("Pick ".concat(this.cId.caption))}},{key:"renderNA",value:function(){return Rr(" - ")}}]),n}(Ln),Aa=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"content",value:function(){return Object(q.jsx)("div",{className:"p-3",children:this.renderForm()})}}]),n}($n),Sa=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;return Object(Kt.a)(this,n),(r=t.call(this,e)).cSession=void 0,r.cSession=new Na(Object(Ht.a)(r)),r}return Object(zt.a)(n,[{key:"tagGroupName",get:function(){return"workshop-tags"}},{key:"uq",get:function(){return this.uqs.BzWorkshop}},{key:"getID",value:function(){return this.uqs.BzWorkshop.Workshop}},{key:"caption",get:function(){return"Workshop"}},{key:"icon",get:function(){return"book"}},{key:"iconClass",get:function(){return"text-warning"}},{key:"schema",get:function(){return this.uqs.BzWorkshop.Workshop.ui.fieldArr}},{key:"uiSchema",get:function(){var e;return{items:{no:{name:"no",type:"string",isKey:!0,widget:"text",label:"No",defaultValue:this.initNO,readOnly:!0},name:{name:"name",type:"string",isKey:!1,widget:"text",label:"Name"},vice:{name:"vice",isKey:!1,widget:"textarea",label:"Discription",placeholder:"Workshop discription",rows:6},staff:{name:"staff",widget:"pick",label:"Staff",pick:new _a(this.cIds.cStaff,null===(e=this.deepData.currentItem)||void 0===e?void 0:e.staff)},submit:{label:"Save Workshop",widget:"button",className:"btn btn-primary"}}}}},{key:"beforeEdit",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(on.a)(Object(ln.a)(n.prototype),"beforeEdit",this).call(this);case 2:return e.next=4,this.cTagInput.beforeEdit(this.tagGroupName,this.deepData.currentItem.id);case 4:return e.next=6,this.cSession.loadToList();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadList",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.BzWorkshop.QueryID({ID:this.ID,page:{start:0,size:10},order:"desc"});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveId",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.BzWorkshop.Acts({workshop:[t]});case 2:return n=e.sent,e.abrupt("return",n.workshop[0]);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderItemInList",value:function(e){return xa(e)}},{key:"VAdd",get:function(){return Aa}},{key:"VEdit",get:function(){return wa}},{key:"renderIdValue",value:function(e){return xa(e)}},{key:"savePropValue",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t,n,r){var a;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=this.uqs.BzWorkshop,e.t0=n,e.next="staff"===e.t0?7:4;break;case 4:return e.next=6,a.ActIDProp(this.ID,t,n,r);case 6:case 9:return e.abrupt("break",10);case 7:return e.next=9,a.SaveWorkshopStaff.submit({id:t,staff:r});case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(ia),qa=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return"Items"}},{key:"content",value:function(){var e=this.controller,t=e.cWorkshop,n=e.cStaff,r=e.cClient,a=e.app;return Object(q.jsx)("div",{children:[t,n,r,a.cTag].map((function(e,t){if(!1===e.isVisible())return null;var n=e.caption,r=e.icon,a=e.iconClass,i=Object(q.jsx)($t.d,{name:"angle-right"}),s=Object(q.jsx)($t.d,{name:r,className:(null!==a&&void 0!==a?a:"text-primary")+" me-4",fixWidth:!0,size:"lg"});return Object(q.jsx)($t.h,{className:"cursor-pointer bg-white border-bottom py-2 px-3 align-items-center",left:s,right:i,onClick:function(){return e.openMain()},children:n},t)}))})}}]),n}(An),Ta=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;return Object(Kt.a)(this,n),(r=t.call(this,e)).cWorkshop=void 0,r.cClient=void 0,r.cStaff=void 0,r.load=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),r.onWorkshop=function(){r.cWorkshop.openMain()},r.onClient=function(){r.cClient.openMain()},r.onStaff=function(){r.cStaff.openMain()},r.cWorkshop=new Sa(Object(Ht.a)(r)),r.cClient=new ha(Object(Ht.a)(r)),r.cStaff=new ka(Object(Ht.a)(r)),r}return Object(zt.a)(n,[{key:"main",value:function(){return this.render(qa)}}]),n}($r),Da=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return"about APP"}},{key:"content",value:function(){return Object(q.jsx)("div",{className:"py-5 px-3 my-3 w-max-30c mx-auto bg-white",children:Object(q.jsxs)("div",{className:"text-center mb-5 position-relative",children:[Object(q.jsxs)("small",{className:"text-muted position-absolute",style:{right:"0",top:"-2.8rem"},children:["version: ",Vt.version]}),Object(q.jsx)("b",{className:"text-danger h5 mb-0",children:"About"})]})})}}]),n}(An),Ea=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).meInfo=Object(tn.a)((function(){var t=S.m.user;if(!t)return null;var n=t.id,r=t.name,a=t.nick,i=t.icon;return Object(q.jsx)($t.h,{className:"py-2 cursor-pointer w-100",left:Object(q.jsx)($t.g,{className:"w-3c h-3c me-3",src:i||".user-o"}),right:Object(q.jsx)($t.d,{className:"align-self-end",name:"angle-right"}),onClick:e.controller.showEditMe,children:Object(q.jsxs)("div",{children:[Object(q.jsx)("div",{children:Pa(r,a)}),Object(q.jsxs)("div",{className:"small",children:[Object(q.jsx)("span",{className:"text-muted",children:"ID:"})," ",n>1e4?n:String(n+1e4).substr(1)]})]})})})),e.about=function(){e.controller.open(Da)},e}return Object(zt.a)(n,[{key:"render",value:function(){var e,t=S.m.user,n=["",{type:"component",component:Object(q.jsxs)($t.h,{className:"w-100 py-2",onClick:this.about,right:Object(q.jsx)($t.d,{className:"align-self-center",name:"angle-right"}),children:[Object(q.jsx)($t.d,{className:"text-info me-3",name:"smile-o",fixWidth:!0,size:"lg"}),Object(q.jsxs)("b",{className:"",children:[this.res("aboutTheApp")," ",Object(q.jsxs)("small",{children:[this.res("version")," ",Vt.version]})]})]})}];if(void 0===t)(e=n).push({type:"component",component:Object(q.jsxs)("button",{className:"btn btn-success w-100 my-2",onClick:function(){return S.m.logout()},children:[Object(q.jsx)($t.d,{name:"sign-out",size:"lg"})," ",this.res("pleaseLogin")]})});else{var r;e=["",{type:"component",component:Object(q.jsx)(this.meInfo,{})}];var a=this.controller.cAdmin.onAdmin;a&&(e.push(""),e.push({type:"component",component:Object(q.jsxs)($t.h,{className:"w-100 py-3",onClick:a,right:Object(q.jsx)($t.d,{className:"align-self-center",name:"angle-right"}),children:[Object(q.jsx)($t.d,{className:"text-primary me-3",name:"cogs",fixWidth:!0,size:"lg"}),Object(q.jsx)("b",{className:"text-danger",children:this.res("admin")})]})})),(r=e).push.apply(r,n.concat([]))}return Object(q.jsx)($t.m,{rows:Object(jn.a)(e),values:{}})}}]),n}(_n);function Pa(e,t){return t?Object(q.jsx)(q.Fragment,{children:Object(q.jsxs)("b",{children:[t," \xa0 ",Object(q.jsx)("small",{className:"muted",children:e})]})}):Object(q.jsx)("b",{children:e})}var Fa=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;Object(Kt.a)(this,n),(r=t.call(this,e)).schema=[{name:"nick",type:"string"},{name:"icon",type:"image"}],r.uiSchema={items:{nick:{widget:"text",label:"\u522b\u540d",placeholder:"\u597d\u7684\u522b\u540d\u66f4\u65b9\u4fbf\u8bb0\u5fc6"},icon:{widget:"image",label:"\u5934\u50cf"}}},r.data=void 0,r.onItemChanged=function(){var e=Object(Pt.a)(Rt.a.mark((function e(t,n,a){var i;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.name,e.next=3,S.m.net.userApi.userSetProp(i,n);case 3:r.data[i]=n,S.m.user.name=n,S.m.saveLocalUser();case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),r.onExit=function(){S.m.showLogout()},r.changePassword=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.m.changePassword();case 2:case"end":return e.stop()}}),e)}))),r.userQuit=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.m.userQuit();case 2:case"end":return e.stop()}}),e)}))),Object(Qt.p)(Object(Ht.a)(r),{data:Qt.q});var a=S.m.user,i=a.nick,s=a.icon;return r.data={nick:i,icon:s},r}return Object(zt.a)(n,[{key:"header",value:function(){return"\u4e2a\u4eba\u4fe1\u606f"}},{key:"content",value:function(){var e=this.schema,t=this.uiSchema,n=this.data,r=this.onItemChanged,a=["",{type:"component",component:Object(q.jsx)($t.f,{iconClass:"text-info me-2",icon:"key",text:this.res("changePassword")}),onClick:this.changePassword},"",{type:"component",component:Object(q.jsx)($t.f,{iconClass:"text-info me-2",icon:"key",text:this.res("quitUser")}),onClick:this.userQuit},"","",{type:"component",bk:"",component:Object(q.jsx)("div",{className:"w-100 text-center",children:Object(q.jsxs)("button",{className:"btn btn-danger w-100 w-max-20c",onClick:this.onExit,children:[Object(q.jsx)($t.d,{name:"sign-out",size:"lg"})," ",this.res("logout")]})})}];return Object(q.jsxs)("div",{children:[Object(q.jsx)($t.c,{schema:e,uiSchema:t,data:n,onItemChanged:r}),Object(q.jsx)($t.m,{rows:a,values:{}})]})}}]),n}(An),Ra=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"render",value:function(){return Object(q.jsxs)("div",{className:"mt-3",children:[Object(q.jsx)("div",{className:" px-3 py-2  small text-muted ",children:"counselor"}),Object(q.jsx)("div",{className:" px-3 py-2  bg-white  my-1 "})]})}}]),n}(_n),La=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;return Object(Kt.a)(this,n),(r=t.call(this,e)).uqs=void 0,r.uqs=e.uqs,r}return Object(zt.a)(n,[{key:"loadAdmins",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.BzWorkshop.AdminGetList();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setMeAdmin",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.BzWorkshop.AdminSetMe();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setAdmin",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t,n,r){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.BzWorkshop.AdminSet(t,n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"me",get:function(){var e;return null===(e=this.app.user)||void 0===e?void 0:e.id}},{key:"renderRoleSettings",value:function(){return this.render(Ra)}}]),n}(Fr),Va=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;return Object(Kt.a)(this,n),(r=t.call(this,e)).role=void 0,r.unitOwner=void 0,r.rootUnits=void 0,r.cAdmin=void 0,r.tab=function(){return r.render(Ea)},r.showEditMe=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.open(Fa);case 1:case"end":return e.stop()}}),e)}))),r.load=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.cAdmin.load();case 2:case"end":return e.stop()}}),e)}))),r.backend=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),r.myRolesChanged=function(e){},r.cAdmin=new La(r.app),r}return Object(zt.a)(n,[{key:"internalStart",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}($r),Ba=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;return Object(Kt.a)(this,n),(r=t.call(this,e)).uqs=void 0,r.uq=void 0,r.TagGroup=void 0,r.Tag=void 0,r.TagItem=void 0,r.IxTag=void 0,r.IxLocalIdTag=void 0,r.IxGlobalIdTag=void 0,r.groups=[{name:"workshop-tags",vice:"Workshop tags"},{name:"client-tags",vice:"Client tags"},{name:"staff-tags",vice:"Staff tags"}],r.uqs=e.uqs,r.uq=r.uqs.BzWorkshop,r.TagGroup=r.uq.TagGroup,r.Tag=r.uq.Tag,r.TagItem=r.uq.TagItem,r.IxTag=r.uq.IxTag,r.IxLocalIdTag=r.uq.IxLocalIdTag,r.IxGlobalIdTag=r.uq.IxGlobalIdTag,r}return Object(zt.a)(n,[{key:"caption",get:function(){return"Tags admin"}},{key:"icon",get:function(){return"tag"}},{key:"iconClass",get:function(){return"text-danger"}},{key:"isVisible",value:function(){return this.app.meAdmin}}]),n}(wr);function Ma(e,t){return function(n){return Object($t.o)(e,t,function(e){return!0===e?"text-primary":"text-muted"}(n))}}var Ua=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"tabsProps",get:function(){var e=this.controller.app,t=e.cHome,n=e.cActs,r=e.cIds,a=e.cMe,i=[{name:"home",caption:Ma(Object(an.a)("dev"),"wrench"),content:t.tab},{name:"acts",caption:Ma(Object(an.a)("home"),"home"),content:function(){return n.main()},load:n.load},{name:"ids",caption:Ma(Object(an.a)("ids"),"file-text-o"),content:function(){return r.main()},load:r.load}];return i.push({name:"me",caption:Ma(Object(an.a)("me"),"user-o"),content:a.tab,load:a.load}),{tabs:i}}}]),n}(An),Wa=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"openMain",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.open(Ua);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}($r),$a=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).pathParam=void 0,e}return Object(zt.a)(n)}($r),Ka=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return null}},{key:"content",value:function(){var e=[].concat(Object(jn.a)(this.controller.uqs.BzWorkshop.Person.ui.fieldArr),[{name:"submit",type:"submit"}]),t={items:{no:{name:"no",type:"string",isKey:!0,widget:"text",label:"No",defaultValue:this.props.no},name:{name:"name",type:"string",isKey:!1,widget:"text",label:"Name",defaultValue:this.props.name},firstName:{name:"firstName",type:"string",isKey:!1,widget:"text",label:"First Name",defaultValue:this.props.firstName},lastName:{name:"lastName",type:"string",isKey:!1,widget:"text",label:"Last Name",defaultValue:this.props.lastName},middleName:{name:"middleName",type:"string",isKey:!1,widget:"text",label:"Middle Name",defaultValue:this.props.middleName},submit:{label:"Submit",widget:"button",className:"btn btn-primary"}}};return Object(q.jsx)("div",{className:"p-3",children:Object(q.jsx)($t.e,{schema:e,uiSchema:t,fieldLabelSize:2})})}}]),n}(An),za=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return null}},{key:"content",value:function(){return Object(q.jsx)("div",{className:"p-3",children:"invalid"})}}]),n}(An),Ha=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){return Object(Kt.a)(this,n),t.apply(this,arguments)}return Object(zt.a)(n,[{key:"header",value:function(){return null}},{key:"content",value:function(){var e=this;return Object(q.jsxs)("div",{className:"p-3",children:[Object(q.jsx)("div",{className:"my-5 text-center text-success",children:"Welcome to the servey!"}),Object(q.jsx)("div",{className:"my-5 text-center",children:this.controller.pathParam}),Object(q.jsx)("div",{className:"my-5 text-center",children:Object(q.jsx)("button",{className:"btn btn-primary",onClick:function(t){return e.waitingEvent(t,e.controller.onStart)},children:"Next >"})})]})}}]),n}(An),Xa=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onStart=Object(Pt.a)(Rt.a.mark((function t(){var n,r,a;return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.uqs.BzWorkshop,r=Number.parseInt(e.pathParam),!0!==isNaN(r)){t.next=5;break}return e.open(za),t.abrupt("return");case 5:return t.next=7,n.ID({IDX:n.Person,id:r});case 7:if(0!==(a=t.sent).length){t.next=11;break}return e.open(za),t.abrupt("return");case 11:e.open(Ka,a[0]);case 12:case"end":return t.stop()}}),t)}))),e}return Object(zt.a)(n,[{key:"openMain",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.open(Ha);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}($a),Ga={"/client/survey/":Xa};var Qa=n.p+"static/media/logo.6ce24c58.svg",Ja=(n(73),function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).items=["\u5728\u670d\u52a1\u5668\u7aef\u521b\u5efa app","\u521b\u5efa uq \u7f16\u7a0b\u5355\u5143","uq \u5173\u8054 app","uq \u7ed1\u5b9a\u6570\u636e\u5e93\u670d\u52a1","\u7f16\u5199 uq \u4ee3\u7801","\u63d0\u4ea4 uq \u7f16\u8bd1\u751f\u6210\u6570\u636e\u5e93","\u5728 src/appConfig.ts \u8bbe\u7f6e uqs","\u5728 vs code \u8c03\u8bd5\u73af\u5883\u8fd0\u884cBuild UqApp\uff0c\u751f\u6210uq typescript interface","\u8c03\u7528 uq \u63a5\u53e3\uff0c\u8bfb\u5199\u6570\u636e"],e}return Object(zt.a)(n,[{key:"header",value:function(){return"\u9996\u9875"}},{key:"content",value:function(){return Object(q.jsxs)("div",{className:"App",children:[Object(q.jsxs)("header",{className:"App-header",children:[Object(q.jsx)("img",{src:Qa,className:"App-logo",alt:"logo"}),Object(q.jsxs)("p",{children:[Object(q.jsx)("span",{className:"text-success",children:"tonwa"})," + ",Object(q.jsx)("span",{className:"text-primary",children:"uq"})," = UI + DB"]}),Object(q.jsxs)("div",{className:"mb-3 h6 text-warning",children:["\u7f16\u7a0b",Object(q.jsx)($t.d,{name:"handshake-o",size:"lg",className:"text-danger mx-2"}),"\u5f00\u5fc3"]})]}),Object(q.jsx)("ul",{className:"text-left my-3 me-3",children:this.items.map((function(e,t){return Object(q.jsx)("li",{className:"my-2",children:e},t)}))})]})}}]),n}(An)),Ya=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(){var e;Object(Kt.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).tab=function(){return e.render(Ja)},e.load=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e}return Object(zt.a)(n,[{key:"internalStart",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}($r),Za=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){var r;Object(Kt.a)(this,n),(r=t.call(this)).autoRun=void 0,r.appNav=void 0,r.user=void 0,r.meAdmin=void 0,r.meRoles=void 0,r.uqs=void 0,r.cHome=void 0,r.cTag=void 0,r.cActs=void 0,r.cIds=void 0,r.cMe=void 0,r.cUser=void 0,r.userApi=void 0;var a=e.BzWorkshop.$poked.query(void 0,void 0,!1);return r.autoRun=new Mr(a,undefined),r.uqs=e,r.cHome=new Ya(Object(Ht.a)(r)),r.cTag=new Ba(Object(Ht.a)(r)),r.cActs=new aa(Object(Ht.a)(r)),r.cIds=new Ta(Object(Ht.a)(r)),r.cMe=new Va(Object(Ht.a)(r)),r.cUser=new Wr(Object(Ht.a)(r)),r}return Object(zt.a)(n,[{key:"nav",get:function(){return this.appNav}},{key:"openMain",value:function(){(this.autoRun.start(),!0!==function(e){var t=document.location.href.toLowerCase();for(var n in Ga){var r=t.indexOf(n.toLowerCase());if(r>=0){var a=Ga[n],i=t.substring(r+n.length),s=new a(e);return s.pathParam=i,s.openMain(),!0}}return!1}(this))&&(this.user?new Wa(this).openMain():this.nav.openLogin())}},{key:"isRole",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(void 0===t)return!1;for(var r=0,a=t;r<a.length;r++){var i=a[r];if(void 0!==this.meRoles[i])return!0}return!1}},{key:"isAdminOrRole",value:function(){return!0===this.meAdmin||this.isRole.apply(this,arguments)}},{key:"isPersonMe",value:function(e){for(var t in this.meRoles)if(e===this.meRoles[Number(t)])return!0;return!1}},{key:"loadBaseData",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){var t,n;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.uqs.BzWorkshop,e.next=3,Promise.all([this.cIds.load(),t.AdminIsMe(),t.IX({IX:t.IxUserPerson,IX1:t.IxPersonRole,ix:void 0})]);case 3:n=e.sent,this.meRoles=this.buildRoles(n[2]),this.meAdmin=n[1];case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buildRoles",value:function(e){var t,n=this.uqs.BzWorkshop,r={},a=Object(en.a)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value,s=i.type,c=i.value,u=n.IDValue(s,c);if("personrole"===s){var o=u,l=o.person;r[o.role]=l}}}catch(h){a.e(h)}finally{a.f()}return r}},{key:"renderAdmin",value:function(e){return!0===this.meAdmin?e:null}},{key:"renderRole",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!0===this.isRole.apply(this,n)?e:null}},{key:"renderAdminOrRole",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!0===this.isAdminOrRole.apply(this,n)?e:null}}]),n}(Vn),ei={$zh:{home:"\u9996\u9875",relation:"\u5173\u7cfb",discover:"\u53d1\u73b0",supervise:"\u56e2\u961f",ids:"\u57fa\u7840ID",test:"\u6d4b\u8bd5",debug:"Debug",me:"\u6211",changePassword:"\u4fee\u6539\u5bc6\u7801",aboutTheApp:"\u5173\u4e8e\u672cAPP",logout:"\u9000\u51fa\u767b\u5f55",pleaseLogin:"\u767b\u5f55",userQuit:"\u6ce8\u9500\u7528\u6237",content:"\u5185\u5bb9",backend:"\u540e\u53f0\u7ba1\u7406",list:"\u5217\u8868"},$en:{home:"Home",relation:"Relation",discover:"Discover",supervise:"Supervise",ids:"Items",test:"Test",debug:"Debug",me:"Me",changePassword:"Change password",aboutTheApp:"About the APP",logout:"Logout",pleaseLogin:"Login",userQuit:"User quit",content:"Content",backend:"Backend Management",list:"List"}},ti=function(e){Object(Xt.a)(n,e);var t=Object(Gt.a)(n);function n(e){return Object(Kt.a)(this,n),t.call(this,e,Vt)}return Object(zt.a)(n,[{key:"internalStart",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(t){var n,r,a;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setRes(ei),Et(this.uqs),n=this.getTonwa(),r=new ni(n),(a=new Za(this.uqs)).appNav=r,a.user=this.user,a.userApi=this.net.centerApi,e.next=10,a.loadBaseData();case 10:a.openMain();case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"initStart",value:function(){var e=Object(Pt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tonwa.appStart();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=function(){var t=Object(Pt.a)(Rt.a.mark((function t(r){return Rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,cn(n,e.tonwa,Vt,r);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),a=void 0;return!1===t&&(a=r),this.tonwa.nav.renderNavView(r,a)}}]),n}(sn),ni=function(){function e(t){Object(Kt.a)(this,e),this.nav=void 0,this.tonwa=void 0,this.nav=t.nav,this.tonwa=t}return Object(zt.a)(e,[{key:"open",value:function(e,t){this.nav.push(e,t)}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.nav.pop(e)}},{key:"openLogin",value:function(){this.tonwa.showLogin(void 0)}}]),e}();function ri(){return ri=Object(Pt.a)(Rt.a.mark((function e(){var t,n,r;return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new wn).setSettings(Vt),n=function(){var e=Object(Pt.a)(Rt.a.mark((function e(n){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cn(ti,t,Vt,n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r=n,void 0,t.appStart(n),Wt.a.render(Object(q.jsx)(Mt.a.StrictMode,{children:Object(q.jsx)($t.k,{ref:function(e){return t.set(e)},onLogined:n,notLogined:r,userPassword:undefined})}),document.getElementById("root"));case 7:case"end":return e.stop()}}),e)}))),ri.apply(this,arguments)}!function(){ri.apply(this,arguments)}()}],[[74,2,3]]]);
//# sourceMappingURL=main.8fdfdda9.chunk.js.map